
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The Neuroscience of AI</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=720ed60b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=60c0e2ec"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ch16_future_directions';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://neuroai-handbook.github.io/ch16_future_directions.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
  
    <p class="title logo__title">None</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    Chapter 16: Where Next for Neuro-AI?
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fch16_future_directions.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 16: Where Next for Neuro-AI?</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-16-where-next-for-neuro-ai">
<h1>Chapter 16: Where Next for Neuro-AI?<a class="headerlink" href="#chapter-16-where-next-for-neuro-ai" title="Link to this heading">#</a></h1>
<section id="chapter-goals">
<h2>16.0 Chapter Goals<a class="headerlink" href="#chapter-goals" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Explore frontier research directions at the intersection of neuroscience and AI</p></li>
<li><p>Understand neuromorphic computing approaches and their advantages</p></li>
<li><p>Consider ethical implications of brain-inspired AI systems</p></li>
<li><p>Envision future developments in the field of neuro-AI</p></li>
</ul>
</section>
<section id="neuromorphic-hardware">
<h2>16.1 Neuromorphic Hardware<a class="headerlink" href="#neuromorphic-hardware" title="Link to this heading">#</a></h2>
<p>Neuromorphic computing seeks to implement neural processing principles directly in hardware, offering potentially revolutionary advantages in energy efficiency and computational capability.</p>
<p><img alt="Neuromorphic Computing" src="_images/neuromorphic_computing.svg" /></p>
<section id="spiking-neural-networks">
<h3>16.1.1 Spiking Neural Networks<a class="headerlink" href="#spiking-neural-networks" title="Link to this heading">#</a></h3>
<p>Traditional artificial neural networks use continuous activation values, but biological neurons communicate through discrete all-or-nothing action potentials (spikes). Spiking Neural Networks (SNNs) mimic this biological principle:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SpikingNeuron</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">tau_m</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">tau_ref</span><span class="o">=</span><span class="mf">2.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simple Leaky Integrate-and-Fire neuron model</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - threshold: Membrane potential threshold for spike generation</span>
<span class="sd">        - tau_m: Membrane time constant (ms)</span>
<span class="sd">        - tau_ref: Refractory period (ms)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tau_m</span> <span class="o">=</span> <span class="n">tau_m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tau_ref</span> <span class="o">=</span> <span class="n">tau_ref</span>
        
        <span class="c1"># State variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">membrane_potential</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_spike_time</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Current time</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_current</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update neuron state and check for spike</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - input_current: Input current to the neuron</span>
<span class="sd">        - dt: Time step (ms)</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - 1 if neuron spikes, 0 otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">+=</span> <span class="n">dt</span>
        
        <span class="c1"># Check if in refractory period</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_spike_time</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau_ref</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        
        <span class="c1"># Update membrane potential (leaky integration)</span>
        <span class="n">d_v</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">membrane_potential</span> <span class="o">+</span> <span class="n">input_current</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau_m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">membrane_potential</span> <span class="o">+=</span> <span class="n">d_v</span> <span class="o">*</span> <span class="n">dt</span>
        
        <span class="c1"># Check for spike</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">membrane_potential</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">membrane_potential</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Reset</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_spike_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
            <span class="k">return</span> <span class="mi">1</span>
        
        <span class="k">return</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Unlike rate-based ANNs, SNNs encode information in the precise timing of spikes and can be more energy-efficient by only computing when spikes occur.</p>
</section>
<section id="resistive-computing-and-memristors">
<h3>16.1.2 Resistive Computing and Memristors<a class="headerlink" href="#resistive-computing-and-memristors" title="Link to this heading">#</a></h3>
<p>A key limitation in conventional computing is the energy cost of moving data between memory and processing units (the “von Neumann bottleneck”). In contrast, the brain co-locates memory and computation in synapses.</p>
<p>Memristors are resistive devices whose resistance changes based on the history of current flow through them. They can implement synaptic weights directly in hardware:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Memristor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r_on</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">r_off</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simple memristor model</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - r_on: Low resistance state (ohms)</span>
<span class="sd">        - r_off: High resistance state (ohms)</span>
<span class="sd">        - initial_state: Initial state variable (0-1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_on</span> <span class="o">=</span> <span class="n">r_on</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_off</span> <span class="o">=</span> <span class="n">r_off</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">initial_state</span>  <span class="c1"># Internal state variable (0-1)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">get_resistance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate current resistance based on internal state&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_on</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_off</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_on</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">voltage</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">learn_rate</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update memristor state based on applied voltage</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - voltage: Applied voltage</span>
<span class="sd">        - dt: Time step</span>
<span class="sd">        - learn_rate: Learning rate parameter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Simplified nonlinear update rule</span>
        <span class="k">if</span> <span class="n">voltage</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Increase resistance (depression)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">+</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">voltage</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Decrease resistance (potentiation)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">+</span> <span class="n">learn_rate</span> <span class="o">*</span> <span class="n">voltage</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
<p>Memristor crossbar arrays can implement matrix multiplication operations directly in hardware with orders of magnitude less energy than digital implementations.</p>
</section>
<section id="event-based-sensors">
<h3>16.1.3 Event-Based Sensors<a class="headerlink" href="#event-based-sensors" title="Link to this heading">#</a></h3>
<p>Event-based sensors like Dynamic Vision Sensors (DVS) mimic the retina by only transmitting information when pixels detect changes in brightness:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">simulate_dvs_output</span><span class="p">(</span><span class="n">video_frames</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate output of a Dynamic Vision Sensor from video frames</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    - video_frames: Sequence of image frames (T, H, W)</span>
<span class="sd">    - threshold: Change threshold for generating events</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    - events: List of (x, y, t, polarity) tuples</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">events</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">prev_frame</span> <span class="o">=</span> <span class="n">video_frames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">video_frames</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># Calculate log intensity change</span>
        <span class="n">log_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">frame</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">prev_frame</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
        
        <span class="c1"># Generate ON events (positive changes)</span>
        <span class="n">on_events</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">log_diff</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">on_events</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">on_events</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">events</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># x, y, time, polarity</span>
        
        <span class="c1"># Generate OFF events (negative changes)</span>
        <span class="n">off_events</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">log_diff</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">threshold</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">off_events</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">off_events</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">events</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># x, y, time, polarity</span>
        
        <span class="n">prev_frame</span> <span class="o">=</span> <span class="n">frame</span>
    
    <span class="k">return</span> <span class="n">events</span>
</pre></div>
</div>
<p>This event-based approach drastically reduces data transmission and power requirements, enabling high-speed vision processing with minimal energy.</p>
</section>
<section id="brain-inspired-chips">
<h3>16.1.4 Brain-Inspired Chips<a class="headerlink" href="#brain-inspired-chips" title="Link to this heading">#</a></h3>
<p>Several neuromorphic hardware platforms have demonstrated remarkable efficiency:</p>
<ol class="arabic simple">
<li><p><strong>IBM TrueNorth</strong>: 1 million digital neurons with 256 million synapses, consuming only ~70mW of power.</p></li>
<li><p><strong>Intel Loihi</strong>: Implements on-chip learning with ~130,000 neurons and 130 million synapses per chip.</p></li>
<li><p><strong>SpiNNaker</strong>: Massively parallel architecture designed specifically for neural simulations.</p></li>
</ol>
<p>These systems achieve energy efficiencies 100-1000× better than conventional architectures for certain tasks:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compare_energy_efficiency</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compare energy efficiency for image recognition task</span>
<span class="sd">    (based on published benchmarks)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">architectures</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;GPU (NVIDIA V100)&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;joules_per_inference&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="mf">0.76</span><span class="p">},</span>
        <span class="s2">&quot;CPU (Intel Xeon)&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;joules_per_inference&quot;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span> <span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="mf">0.76</span><span class="p">},</span>
        <span class="s2">&quot;FPGA&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;joules_per_inference&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">},</span>
        <span class="s2">&quot;Loihi&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;joules_per_inference&quot;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="mf">0.74</span><span class="p">},</span>
        <span class="s2">&quot;TrueNorth&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;joules_per_inference&quot;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="mf">0.70</span><span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1"># Calculate energy efficiency (accuracy per joule)</span>
    <span class="k">for</span> <span class="n">arch</span><span class="p">,</span> <span class="n">stats</span> <span class="ow">in</span> <span class="n">architectures</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">efficiency</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">stats</span><span class="p">[</span><span class="s2">&quot;joules_per_inference&quot;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">arch</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">efficiency</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> accuracy/joule&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="continual-learning">
<h2>16.2 Continual Learning<a class="headerlink" href="#continual-learning" title="Link to this heading">#</a></h2>
<p>One of the major challenges in current AI systems is the “catastrophic forgetting” problem: when trained on new tasks, neural networks often lose performance on previously learned tasks. The brain, in contrast, can learn continually throughout life.</p>
<p><img alt="Continual Learning" src="_images/continual_learning.svg" /></p>
<section id="catastrophic-forgetting-problem">
<h3>16.2.1 Catastrophic Forgetting Problem<a class="headerlink" href="#catastrophic-forgetting-problem" title="Link to this heading">#</a></h3>
<p>When an artificial neural network is trained sequentially on different tasks, learning new tasks can overwrite weights critical for previous tasks:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.optim</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">optim</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_catastrophic_forgetting</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Demonstrate catastrophic forgetting in a simple network</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Simplified experiment</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="c1"># Generate two synthetic tasks</span>
    <span class="n">task_A_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">task_A_targets</span> <span class="o">=</span> <span class="p">(</span><span class="n">task_A_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
    
    <span class="n">task_B_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">task_B_targets</span> <span class="o">=</span> <span class="p">(</span><span class="n">task_B_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
    
    <span class="c1"># Training loop</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCEWithLogitsLoss</span><span class="p">()</span>
    
    <span class="n">task_A_accuracy</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">task_B_accuracy</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># Initial training on task A</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">task_A_data</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">task_A_targets</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        
        <span class="c1"># Evaluate</span>
        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="n">pred_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">output</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
            <span class="n">acc_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">pred_A</span> <span class="o">==</span> <span class="n">task_A_targets</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">task_A_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">acc_A</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
            
            <span class="n">output_B</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">task_B_data</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">pred_B</span> <span class="o">=</span> <span class="p">(</span><span class="n">output_B</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
            <span class="n">acc_B</span> <span class="o">=</span> <span class="p">(</span><span class="n">pred_B</span> <span class="o">==</span> <span class="n">task_B_targets</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">task_B_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">acc_B</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    
    <span class="c1"># Switch to training on task B</span>
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">task_B_data</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">task_B_targets</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        
        <span class="c1"># Evaluate</span>
        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="n">pred_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">task_A_data</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
            <span class="n">acc_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">pred_A</span> <span class="o">==</span> <span class="n">task_A_targets</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">task_A_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">acc_A</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
            
            <span class="n">pred_B</span> <span class="o">=</span> <span class="p">(</span><span class="n">output</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
            <span class="n">acc_B</span> <span class="o">=</span> <span class="p">(</span><span class="n">pred_B</span> <span class="o">==</span> <span class="n">task_B_targets</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">task_B_accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">acc_B</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
    
    <span class="c1"># Plot results</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">task_A_accuracy</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Task A Accuracy&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">task_B_accuracy</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Task B Accuracy&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Switch to Task B&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Training Steps&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Accuracy&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Catastrophic Forgetting Demonstration&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">plt</span>
</pre></div>
</div>
</section>
<section id="biological-solutions-to-stability-plasticity">
<h3>16.2.2 Biological Solutions to Stability-Plasticity<a class="headerlink" href="#biological-solutions-to-stability-plasticity" title="Link to this heading">#</a></h3>
<p>The brain employs several mechanisms to balance stability (retaining old memories) and plasticity (forming new ones):</p>
<ol class="arabic simple">
<li><p><strong>Complementary Learning Systems Theory</strong>: The hippocampus rapidly learns new experiences, while the neocortex gradually integrates knowledge through replay and consolidation.</p></li>
<li><p><strong>Synaptic Consolidation</strong>: Synapses important for existing memories become less plastic and more stable over time.</p></li>
<li><p><strong>Neuromodulatory Systems</strong>: Dopamine, acetylcholine, and other neuromodulators regulate learning rates based on novelty and importance.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ComplementaryLearningSystems</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fast_learn_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">slow_learn_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">consolidation_strength</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hippocampus</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Fast-learning episodic memory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">neocortex</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Slow-learning semantic memory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fast_learn_rate</span> <span class="o">=</span> <span class="n">fast_learn_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slow_learn_rate</span> <span class="o">=</span> <span class="n">slow_learn_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consolidation_strength</span> <span class="o">=</span> <span class="n">consolidation_strength</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">learn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experience</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Learn a new experience&quot;&quot;&quot;</span>
        <span class="c1"># First, store in hippocampus (fast learning)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hippocampus</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">experience</span><span class="p">)</span>
        
        <span class="c1"># Then, slowly integrate into neocortex</span>
        <span class="k">if</span> <span class="n">experience</span><span class="p">[</span><span class="s2">&quot;concept&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neocortex</span><span class="p">:</span>
            <span class="c1"># Update existing knowledge</span>
            <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">neocortex</span><span class="p">[</span><span class="n">experience</span><span class="p">[</span><span class="s2">&quot;concept&quot;</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">neocortex</span><span class="p">[</span><span class="n">experience</span><span class="p">[</span><span class="s2">&quot;concept&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="n">current</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">slow_learn_rate</span><span class="p">)</span> <span class="o">+</span> 
                           <span class="n">experience</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">slow_learn_rate</span><span class="p">,</span>
                <span class="s2">&quot;importance&quot;</span><span class="p">:</span> <span class="n">current</span><span class="p">[</span><span class="s2">&quot;importance&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">consolidation_strength</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Create new knowledge</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">neocortex</span><span class="p">[</span><span class="n">experience</span><span class="p">[</span><span class="s2">&quot;concept&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;features&quot;</span><span class="p">:</span> <span class="n">experience</span><span class="p">[</span><span class="s2">&quot;features&quot;</span><span class="p">],</span>
                <span class="s2">&quot;importance&quot;</span><span class="p">:</span> <span class="mf">1.0</span>
            <span class="p">}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">consolidate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">replay_count</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Consolidate memories from hippocampus to neocortex&quot;&quot;&quot;</span>
        <span class="c1"># Simulate memory replay during sleep</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">replay_count</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hippocampus</span><span class="p">:</span>
                <span class="c1"># Replay random experiences from hippocampus</span>
                <span class="n">replay_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hippocampus</span><span class="p">))</span>
                <span class="n">replay_experience</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hippocampus</span><span class="p">[</span><span class="n">replay_idx</span><span class="p">]</span>
                
                <span class="c1"># Strengthen in neocortex</span>
                <span class="n">concept</span> <span class="o">=</span> <span class="n">replay_experience</span><span class="p">[</span><span class="s2">&quot;concept&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">concept</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">neocortex</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">neocortex</span><span class="p">[</span><span class="n">concept</span><span class="p">][</span><span class="s2">&quot;importance&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consolidation_strength</span>
</pre></div>
</div>
</section>
<section id="replay-and-consolidation-mechanisms">
<h3>16.2.3 Replay and Consolidation Mechanisms<a class="headerlink" href="#replay-and-consolidation-mechanisms" title="Link to this heading">#</a></h3>
<p>In both brains and artificial systems, replay of previous experiences helps consolidate memories:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ExperienceReplayBuffer</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Experience replay buffer for continual learning</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - capacity: Maximum number of experiences to store</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span> <span class="n">capacity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experience</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add an experience to the buffer&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">]</span> <span class="o">=</span> <span class="n">experience</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sample a batch of experiences randomly&quot;&quot;&quot;</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if buffer is empty&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
<section id="meta-learning-approaches">
<h3>16.2.4 Meta-Learning Approaches<a class="headerlink" href="#meta-learning-approaches" title="Link to this heading">#</a></h3>
<p>Meta-learning, or “learning to learn,” aims to develop algorithms that improve their learning ability over time:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MetaContinualLearner</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">meta_lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Meta-learning approach for continual learning</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - model: Base model to train</span>
<span class="sd">        - meta_lr: Meta-learning rate</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta_optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">meta_lr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_optimizers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_losses</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">learn_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Learn a specific task&quot;&quot;&quot;</span>
        <span class="c1"># Create optimizer for this task if it doesn&#39;t exist</span>
        <span class="k">if</span> <span class="n">task_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_optimizers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">task_optimizers</span><span class="p">[</span><span class="n">task_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">task_losses</span><span class="p">[</span><span class="n">task_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
        
        <span class="n">optimizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_optimizers</span><span class="p">[</span><span class="n">task_id</span><span class="p">]</span>
        <span class="n">criterion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_losses</span><span class="p">[</span><span class="n">task_id</span><span class="p">]</span>
        
        <span class="c1"># Save initial weights</span>
        <span class="n">initial_weights</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">param</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">()}</span>
        
        <span class="c1"># First, compute gradients on the current task</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        
        <span class="c1"># Meta-update: consider performance on all previous tasks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta_optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">meta_loss</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">for</span> <span class="n">prev_task_id</span><span class="p">,</span> <span class="n">prev_optimizer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_optimizers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">prev_task_id</span> <span class="o">!=</span> <span class="n">task_id</span><span class="p">:</span>
                <span class="c1"># Sample data from previous task (simplified)</span>
                <span class="n">prev_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_task_sample</span><span class="p">(</span><span class="n">prev_task_id</span><span class="p">)</span>
                <span class="n">prev_targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_task_targets</span><span class="p">(</span><span class="n">prev_task_id</span><span class="p">)</span>
                
                <span class="c1"># Evaluate on previous task</span>
                <span class="n">prev_outputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">prev_data</span><span class="p">)</span>
                <span class="n">prev_loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_losses</span><span class="p">[</span><span class="n">prev_task_id</span><span class="p">](</span><span class="n">prev_outputs</span><span class="p">,</span> <span class="n">prev_targets</span><span class="p">)</span>
                <span class="n">meta_loss</span> <span class="o">+=</span> <span class="n">prev_loss</span>
        
        <span class="c1"># Include current task loss</span>
        <span class="n">meta_loss</span> <span class="o">+=</span> <span class="n">loss</span>
        
        <span class="c1"># Update model using meta-loss</span>
        <span class="n">meta_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meta_optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">get_task_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a sample from a task (placeholder)&quot;&quot;&quot;</span>
        <span class="c1"># In a real implementation, this would retrieve stored examples</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">get_task_targets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get targets for a task sample (placeholder)&quot;&quot;&quot;</span>
        <span class="c1"># In a real implementation, this would retrieve stored targets</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="ai-for-neuroscience">
<h2>16.3 AI for Neuroscience<a class="headerlink" href="#ai-for-neuroscience" title="Link to this heading">#</a></h2>
<p>While neuroscience has heavily inspired AI, AI is now increasingly being used to advance neuroscience.</p>
<section id="neural-data-analysis-with-deep-learning">
<h3>16.3.1 Neural Data Analysis with Deep Learning<a class="headerlink" href="#neural-data-analysis-with-deep-learning" title="Link to this heading">#</a></h3>
<p>Deep learning is transforming how we analyze complex neural data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">analyze_neural_recordings</span><span class="p">(</span><span class="n">spike_data</span><span class="p">,</span> <span class="n">behavior_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Use deep learning to analyze neural recording data</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    - spike_data: Neural spike recordings [neurons, time]</span>
<span class="sd">    - behavior_data: Behavioral measurements [time, features]</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    - model: Trained neural decoder</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Prepare data</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">spike_data</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># [time, neurons]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">behavior_data</span>  <span class="c1"># [time, features]</span>
    
    <span class="c1"># Split into train/test</span>
    <span class="n">split_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.8</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="n">split_idx</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">split_idx</span><span class="p">:]</span>
    <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="n">split_idx</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">split_idx</span><span class="p">:]</span>
    
    <span class="c1"># Create and train a neural decoder</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">128</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="p">)</span>
    
    <span class="c1"># Train the model</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    
    <span class="c1"># Evaluate</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
        <span class="n">r2_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">y_test</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> 
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average R² score: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r2_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
<p>These techniques have enabled breakthroughs in understanding neural dynamics and brain-behavior relationships.</p>
</section>
<section id="brain-simulation-efforts">
<h3>16.3.2 Brain Simulation Efforts<a class="headerlink" href="#brain-simulation-efforts" title="Link to this heading">#</a></h3>
<p>Large-scale brain simulations aim to reproduce neural dynamics in silico:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BrainRegionSimulation</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_neurons</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">connectivity_density</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simplified brain region simulation</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - n_neurons: Number of neurons to simulate</span>
<span class="sd">        - connectivity_density: Fraction of possible connections to create</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_neurons</span> <span class="o">=</span> <span class="n">n_neurons</span>
        
        <span class="c1"># Initialize neurons (simplified LIF model)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_rest</span> <span class="o">=</span> <span class="o">-</span><span class="mf">70.0</span>  <span class="c1"># resting potential (mV)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_threshold</span> <span class="o">=</span> <span class="o">-</span><span class="mf">55.0</span>  <span class="c1"># spike threshold (mV)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_reset</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.0</span>  <span class="c1"># reset potential (mV)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tau</span> <span class="o">=</span> <span class="mf">20.0</span>  <span class="c1"># membrane time constant (ms)</span>
        
        <span class="c1"># State variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_neurons</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_rest</span>  <span class="c1"># membrane potentials</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_neurons</span><span class="p">)</span>  <span class="c1"># time until end of refractory period</span>
        
        <span class="c1"># Generate random connectivity matrix</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">connectivity_density</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n_neurons</span><span class="p">,</span> <span class="n">n_neurons</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="c1"># Scale weights and ensure no self-connections</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="n">n_neurons</span><span class="p">,</span> <span class="n">n_neurons</span><span class="p">))</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="c1"># 80% excitatory, 20% inhibitory</span>
        <span class="n">inh_neurons</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">n_neurons</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">n_neurons</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">inh_neurons</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">5</span>
        
        <span class="c1"># Record spikes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spike_times</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_neurons</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">external_input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulate one time step</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - external_input: External current to each neuron</span>
<span class="sd">        - dt: Time step (ms)</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - spikes: Boolean array indicating which neurons spiked</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_time</span> <span class="o">+=</span> <span class="n">dt</span>
        
        <span class="c1"># Default to no external input</span>
        <span class="k">if</span> <span class="n">external_input</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">external_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_neurons</span><span class="p">)</span>
        
        <span class="c1"># Update membrane potentials</span>
        <span class="n">non_refractory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time</span> <span class="o">&lt;=</span> <span class="mi">0</span>
        
        <span class="c1"># Decay potential toward rest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">non_refractory</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dt</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">non_refractory</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_rest</span><span class="p">)</span> <span class="o">+</span> 
                                        <span class="n">external_input</span><span class="p">[</span><span class="n">non_refractory</span><span class="p">])</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau</span>
        
        <span class="c1"># Check for spikes</span>
        <span class="n">spiked</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_threshold</span><span class="p">)</span>
        
        <span class="c1"># Record spikes</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">spiked</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spike_times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_time</span><span class="p">)</span>
        
        <span class="c1"># Reset membrane potential and set refractory period for spiked neurons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_reset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time</span><span class="p">[</span><span class="n">spiked</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># 2ms refractory period</span>
        
        <span class="c1"># Decrement refractory time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time</span> <span class="o">-=</span> <span class="n">dt</span>
        
        <span class="c1"># Add synaptic inputs from spiking neurons</span>
        <span class="n">synaptic_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">,</span> <span class="n">spiked</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">non_refractory</span><span class="p">]</span> <span class="o">+=</span> <span class="n">synaptic_input</span><span class="p">[</span><span class="n">non_refractory</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">spiked</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">input_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run simulation for specified duration</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - duration: Simulation duration (ms)</span>
<span class="sd">        - input_fn: Function that returns external input at each time step</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - spike_times: List of spike times for each neuron</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span> <span class="o">/</span> <span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># Assuming dt=0.1</span>
        
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="mf">0.1</span>
            
            <span class="c1"># Get external input if provided</span>
            <span class="n">external_input</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">input_fn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">external_input</span> <span class="o">=</span> <span class="n">input_fn</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">external_input</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">spike_times</span>
</pre></div>
</div>
<p>Projects like the Blue Brain Project aim to create increasingly detailed simulations that can generate testable hypotheses about brain function.</p>
</section>
<section id="connectome-reconstruction">
<h3>16.3.3 Connectome Reconstruction<a class="headerlink" href="#connectome-reconstruction" title="Link to this heading">#</a></h3>
<p>Mapping the brain’s wiring diagram (connectome) is being accelerated by AI:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">segment_neural_images</span><span class="p">(</span><span class="n">electron_microscopy_images</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Segment neurons in electron microscopy images using deep learning</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    - electron_microscopy_images: 3D stack of EM images</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    - segmentation: 3D segmentation map</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a 3D U-Net model for segmentation</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">UNet3D</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># 3 output channels: background, membrane, cell interior</span>
    
    <span class="c1"># Process image stack in 3D patches</span>
    <span class="n">patch_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
    <span class="n">segmentation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">electron_microscopy_images</span><span class="p">)</span>
    
    <span class="c1"># Simplified inference (in practice, would need proper patch handling)</span>
    <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">electron_microscopy_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">patch_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">electron_microscopy_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">patch_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">electron_microscopy_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">patch_size</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">):</span>
                <span class="c1"># Extract patch</span>
                <span class="n">z_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="n">patch_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">electron_microscopy_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">y_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">patch_size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">electron_microscopy_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">x_end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">patch_size</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">electron_microscopy_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                
                <span class="n">patch</span> <span class="o">=</span> <span class="n">electron_microscopy_images</span><span class="p">[</span><span class="n">z</span><span class="p">:</span><span class="n">z_end</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="n">y_end</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="n">x_end</span><span class="p">]</span>
                
                <span class="c1"># Zero-pad if necessary</span>
                <span class="k">if</span> <span class="n">patch</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">patch_size</span><span class="p">:</span>
                    <span class="n">padded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">patch_size</span><span class="p">)</span>
                    <span class="n">padded</span><span class="p">[:</span><span class="n">patch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:</span><span class="n">patch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">:</span><span class="n">patch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">patch</span>
                    <span class="n">patch</span> <span class="o">=</span> <span class="n">padded</span>
                
                <span class="c1"># Predict segmentation</span>
                <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
                    <span class="n">input_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">patch</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
                
                <span class="c1"># Update segmentation (handle overlap with averaging)</span>
                <span class="n">segmentation</span><span class="p">[</span><span class="n">z</span><span class="p">:</span><span class="n">z_end</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="n">y_end</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span><span class="n">x_end</span><span class="p">]</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[:</span><span class="n">z_end</span><span class="o">-</span><span class="n">z</span><span class="p">,</span> <span class="p">:</span><span class="n">y_end</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="p">:</span><span class="n">x_end</span><span class="o">-</span><span class="n">x</span><span class="p">]</span>
    
    <span class="c1"># Post-process to get instance segmentation (simplified)</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">skimage.measure</span><span class="w"> </span><span class="kn">import</span> <span class="n">label</span>
    <span class="n">instance_seg</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">segmentation</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Assuming channel 2 is cell interior</span>
    
    <span class="k">return</span> <span class="n">instance_seg</span>

<span class="c1"># Placeholder for 3D UNet</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UNet3D</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_channels</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># Simplified placeholder for the model architecture</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="n">in_channels</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># Simplified forward pass</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</section>
<section id="theory-development-through-modeling">
<h3>16.3.4 Theory Development through Modeling<a class="headerlink" href="#theory-development-through-modeling" title="Link to this heading">#</a></h3>
<p>Computational models help bridge the gap between neural mechanisms and cognitive function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BayesianInferenceBrain</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensory_noise</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prior_mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prior_var</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Model of Bayesian inference in the brain</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - sensory_noise: Standard deviation of sensory noise</span>
<span class="sd">        - prior_mean: Prior belief about the mean of the variable</span>
<span class="sd">        - prior_var: Prior belief about the variance of the variable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensory_noise</span> <span class="o">=</span> <span class="n">sensory_noise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prior_mean</span> <span class="o">=</span> <span class="n">prior_mean</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prior_var</span> <span class="o">=</span> <span class="n">prior_var</span>
        
        <span class="c1"># Current belief</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">belief_mean</span> <span class="o">=</span> <span class="n">prior_mean</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">belief_var</span> <span class="o">=</span> <span class="n">prior_var</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">update_belief</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observation</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update beliefs using Bayes&#39; rule</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - observation: New sensory observation</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - posterior_mean: Updated belief mean</span>
<span class="sd">        - posterior_var: Updated belief variance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Compute precision (inverse variance)</span>
        <span class="n">prior_precision</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">belief_var</span>
        <span class="n">obs_precision</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensory_noise</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        
        <span class="c1"># Bayesian update (for Gaussian variables)</span>
        <span class="n">posterior_precision</span> <span class="o">=</span> <span class="n">prior_precision</span> <span class="o">+</span> <span class="n">obs_precision</span>
        <span class="n">posterior_var</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">posterior_precision</span>
        
        <span class="n">posterior_mean</span> <span class="o">=</span> <span class="n">posterior_var</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">prior_precision</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">belief_mean</span> <span class="o">+</span> 
            <span class="n">obs_precision</span> <span class="o">*</span> <span class="n">observation</span>
        <span class="p">)</span>
        
        <span class="c1"># Update beliefs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">belief_mean</span> <span class="o">=</span> <span class="n">posterior_mean</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">belief_var</span> <span class="o">=</span> <span class="n">posterior_var</span>
        
        <span class="k">return</span> <span class="n">posterior_mean</span><span class="p">,</span> <span class="n">posterior_var</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">predict_observation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate predicted observations based on current belief</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - n_samples: Number of samples to generate</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - samples: Predicted observations</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Sample from current belief</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belief_mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belief_var</span><span class="p">),</span> <span class="n">n_samples</span><span class="p">)</span>
        
        <span class="c1"># Add sensory noise</span>
        <span class="n">samples</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensory_noise</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">samples</span>
</pre></div>
</div>
</section>
</section>
<section id="whole-brain-integration">
<h2>16.4 Whole-Brain Integration<a class="headerlink" href="#whole-brain-integration" title="Link to this heading">#</a></h2>
<p>Understanding how specialized neural systems interact to produce integrated cognition is a key challenge for both neuroscience and AI.</p>
<p><img alt="Whole Brain Integration" src="_images/whole_brain_integration.svg" /></p>
<section id="combining-specialized-neural-systems">
<h3>16.4.1 Combining Specialized Neural Systems<a class="headerlink" href="#combining-specialized-neural-systems" title="Link to this heading">#</a></h3>
<p>The brain integrates information across specialized areas, a challenge for current AI systems:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">IntegratedCognitiveArchitecture</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Architecture combining specialized neural systems</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Specialized modules</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visual_system</span> <span class="o">=</span> <span class="n">ConvolutionalNetwork</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">),</span> <span class="n">output_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">language_system</span> <span class="o">=</span> <span class="n">TransformerNetwork</span><span class="p">(</span><span class="n">vocab_size</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory_system</span> <span class="o">=</span> <span class="n">EpisodicMemoryStore</span><span class="p">(</span><span class="n">embedding_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">motor_system</span> <span class="o">=</span> <span class="n">MotorController</span><span class="p">(</span><span class="n">control_dims</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
        
        <span class="c1"># Integration module (global workspace)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workspace</span> <span class="o">=</span> <span class="n">GlobalWorkspace</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
        
        <span class="c1"># Attention control</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attention</span> <span class="o">=</span> <span class="n">AttentionController</span><span class="p">(</span><span class="n">n_sources</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visual_input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">language_input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">memory_query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">motor_command</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Process inputs through the integrated architecture</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - outputs: Dictionary of outputs from various systems</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">module_outputs</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="c1"># Process inputs through specialized systems</span>
        <span class="k">if</span> <span class="n">visual_input</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">module_outputs</span><span class="p">[</span><span class="s1">&#39;visual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visual_system</span><span class="p">(</span><span class="n">visual_input</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">language_input</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">module_outputs</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">language_system</span><span class="p">(</span><span class="n">language_input</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">memory_query</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">module_outputs</span><span class="p">[</span><span class="s1">&#39;memory&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_system</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">memory_query</span><span class="p">)</span>
        
        <span class="c1"># Determine attention allocation</span>
        <span class="n">attention_weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attention</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">module_outputs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        
        <span class="c1"># Integrate in global workspace</span>
        <span class="n">integrated_representation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workspace</span><span class="p">(</span><span class="n">module_outputs</span><span class="p">,</span> <span class="n">attention_weights</span><span class="p">)</span>
        
        <span class="c1"># Update memory with integrated representation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory_system</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">integrated_representation</span><span class="p">)</span>
        
        <span class="c1"># Generate motor commands if requested</span>
        <span class="n">motor_output</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">motor_command</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">motor_output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">motor_system</span><span class="p">(</span><span class="n">integrated_representation</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;integrated&#39;</span><span class="p">:</span> <span class="n">integrated_representation</span><span class="p">,</span>
            <span class="s1">&#39;motor&#39;</span><span class="p">:</span> <span class="n">motor_output</span><span class="p">,</span>
            <span class="s1">&#39;attention&#39;</span><span class="p">:</span> <span class="n">attention_weights</span>
        <span class="p">}</span>

<span class="c1"># Placeholder specialized module classes</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ConvolutionalNetwork</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">,</span> <span class="n">output_dim</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># Simplified visual processing network</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>  <span class="c1"># Placeholder</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TransformerNetwork</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># Simplified language model</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>  <span class="c1"># Placeholder</span>

<span class="k">class</span><span class="w"> </span><span class="nc">EpisodicMemoryStore</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">,</span> <span class="n">capacity</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span> <span class="n">capacity</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">store</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embedding</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">embedding</span><span class="p">)</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">retrieve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
        <span class="c1"># Simplified memory retrieval</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>  <span class="c1"># Placeholder</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MotorController</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_dims</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># Simplified motor controller</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># Placeholder</span>

<span class="k">class</span><span class="w"> </span><span class="nc">GlobalWorkspace</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># Simplified global workspace</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_outputs</span><span class="p">,</span> <span class="n">attention_weights</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>  <span class="c1"># Placeholder</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AttentionController</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_sources</span><span class="p">):</span>
        <span class="c1"># Simplified attention controller</span>
        <span class="k">pass</span>
        
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
        <span class="c1"># Return random attention weights</span>
        <span class="k">return</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">]</span>  <span class="c1"># Placeholder</span>
</pre></div>
</div>
</section>
<section id="global-workspace-theory">
<h3>16.4.2 Global Workspace Theory<a class="headerlink" href="#global-workspace-theory" title="Link to this heading">#</a></h3>
<p>Global Workspace Theory (GWT) proposes that specialized neural modules compete for access to a central “workspace” where information becomes consciously available:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">simulate_global_workspace</span><span class="p">(</span><span class="n">input_stimuli</span><span class="p">,</span> <span class="n">specialized_modules</span><span class="p">,</span> <span class="n">workspace_capacity</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate global workspace dynamics with competing modules</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    - input_stimuli: Dictionary of inputs to each module</span>
<span class="sd">    - specialized_modules: Dictionary of processing modules</span>
<span class="sd">    - workspace_capacity: Maximum number of modules that can access workspace</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    - consciousness: Contents of global workspace</span>
<span class="sd">    - access_history: Which modules accessed consciousness over time</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_timesteps</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">access_history</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">consciousness</span> <span class="o">=</span> <span class="kc">None</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_timesteps</span><span class="p">):</span>
        <span class="c1"># Process inputs in specialized modules</span>
        <span class="n">module_outputs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">module_activations</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">specialized_modules</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">input_stimuli</span><span class="p">:</span>
                <span class="c1"># Process input</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">input_stimuli</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
                <span class="n">module_outputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span>
                
                <span class="c1"># Calculate activation (salience or importance)</span>
                <span class="n">module_activations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">calculate_activation</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        
        <span class="c1"># Determine which modules access the workspace</span>
        <span class="c1"># Sort by activation and take top k (winner-take-all competition)</span>
        <span class="n">sorted_modules</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">module_activations</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">winners</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sorted_modules</span><span class="p">[:</span><span class="n">workspace_capacity</span><span class="p">]]</span>
        
        <span class="c1"># Update workspace contents (simplified)</span>
        <span class="n">consciousness</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">module_outputs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">winners</span><span class="p">}</span>
        
        <span class="c1"># Log which modules accessed consciousness</span>
        <span class="n">access_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">winners</span><span class="p">)</span>
        
        <span class="c1"># Update module states based on workspace contents</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">specialized_modules</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">module</span><span class="o">.</span><span class="n">update_state</span><span class="p">(</span><span class="n">consciousness</span><span class="p">)</span>
        
        <span class="c1"># Update inputs based on current state (e.g., attention shifts)</span>
        <span class="c1"># This would depend on the specific task being simulated</span>
    
    <span class="k">return</span> <span class="n">consciousness</span><span class="p">,</span> <span class="n">access_history</span>
</pre></div>
</div>
</section>
<section id="attention-and-conscious-processing">
<h3>16.4.3 Attention and Conscious Processing<a class="headerlink" href="#attention-and-conscious-processing" title="Link to this heading">#</a></h3>
<p>Attention mechanisms determine what information enters conscious awareness:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">AttentionalBottleneck</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_channels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Model of attentional bottleneck in consciousness</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - n_channels: Number of input channels</span>
<span class="sd">        - capacity: Number of channels that can be attended simultaneously</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span> <span class="o">=</span> <span class="n">n_channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span> <span class="n">capacity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">salience</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_channels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attended</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_channels</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_salience</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute salience of each input channel</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - inputs: List of inputs to each channel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># In a real model, salience would depend on input features</span>
        <span class="c1"># Here we use a simplified random approach</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">salience</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">inp</span><span class="p">)))</span> 
                                 <span class="k">for</span> <span class="n">inp</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">])</span>
        
        <span class="c1"># Add noise</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">salience</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">select_attended</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select which channels are attended based on salience</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Select top k channels by salience</span>
        <span class="n">top_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">salience</span><span class="p">)[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attended</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attended</span><span class="p">[</span><span class="n">top_indices</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Process inputs through the attentional bottleneck</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - inputs: List of inputs to each channel</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - conscious_contents: Contents that reach consciousness</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="si">}</span><span class="s2"> inputs, got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="c1"># Compute salience for each input channel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compute_salience</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        
        <span class="c1"># Select attended channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_attended</span><span class="p">()</span>
        
        <span class="c1"># Only attended channels reach consciousness</span>
        <span class="n">conscious_contents</span> <span class="o">=</span> <span class="p">[</span><span class="n">inp</span> <span class="k">if</span> <span class="n">att</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">inp</span><span class="p">,</span> <span class="n">att</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attended</span><span class="p">)]</span>
        
        <span class="k">return</span> <span class="n">conscious_contents</span>
</pre></div>
</div>
</section>
<section id="metacognition-and-introspection">
<h3>16.4.4 Metacognition and Introspection<a class="headerlink" href="#metacognition-and-introspection" title="Link to this heading">#</a></h3>
<p>Metacognition—thinking about thinking—is a distinctive feature of human cognition:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MetacognitiveModel</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_model</span><span class="p">,</span> <span class="n">confidence_threshold</span><span class="o">=</span><span class="mf">0.7</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Model with metacognitive capabilities</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - base_model: The underlying cognitive model</span>
<span class="sd">        - confidence_threshold: Threshold for confidence-based decisions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">base_model</span> <span class="o">=</span> <span class="n">base_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_threshold</span> <span class="o">=</span> <span class="n">confidence_threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_history</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">allow_defer</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make a prediction with metacognitive monitoring</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - input_data: Input for the base model</span>
<span class="sd">        - allow_defer: Whether to allow deferring the decision</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - prediction: Model&#39;s prediction</span>
<span class="sd">        - confidence: Confidence in the prediction</span>
<span class="sd">        - deferred: Whether the decision was deferred</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get base model prediction</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>
        
        <span class="c1"># Estimate confidence (in a real model, this would be based on model internals)</span>
        <span class="n">confidence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_confidence</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">prediction</span><span class="p">)</span>
        
        <span class="c1"># Decision to defer based on confidence</span>
        <span class="n">deferred</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">allow_defer</span> <span class="ow">and</span> <span class="n">confidence</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidence_threshold</span><span class="p">:</span>
            <span class="n">deferred</span> <span class="o">=</span> <span class="kc">True</span>
        
        <span class="c1"># Record for metacognitive learning</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">confidence</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">prediction</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">deferred</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_confidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">prediction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Estimate confidence in a prediction</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - input_data: Input data</span>
<span class="sd">        - prediction: Model&#39;s prediction</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - confidence: Estimated confidence (0-1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># In a real model, confidence would be computed from model internals</span>
        <span class="c1"># For simplicity, we use a placeholder</span>
        
        <span class="c1"># For example, in a classification model:</span>
        <span class="c1"># confidence = softmax_outputs[predicted_class]</span>
        
        <span class="n">confidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Placeholder</span>
        
        <span class="k">return</span> <span class="n">confidence</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">update_metacognition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ground_truth</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update metacognitive model based on actual performance</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - ground_truth: True answer for the last prediction</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">last_prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_model</span><span class="o">.</span><span class="n">last_prediction</span>
        <span class="n">last_confidence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidence_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="c1"># Check if prediction was correct</span>
        <span class="n">correct</span> <span class="o">=</span> <span class="p">(</span><span class="n">last_prediction</span> <span class="o">==</span> <span class="n">ground_truth</span><span class="p">)</span>
        
        <span class="c1"># Record performance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">correct</span><span class="p">)</span>
        
        <span class="c1"># Adjust confidence threshold based on performance</span>
        <span class="c1"># Increase threshold if overconfident in wrong answers</span>
        <span class="c1"># Decrease threshold if underconfident in right answers</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">correct</span> <span class="ow">and</span> <span class="n">last_confidence</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="c1"># Overconfident error</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">confidence_threshold</span> <span class="o">+=</span> <span class="mf">0.01</span>
        <span class="k">elif</span> <span class="n">correct</span> <span class="ow">and</span> <span class="n">last_confidence</span> <span class="o">&lt;</span> <span class="mf">0.6</span><span class="p">:</span>
            <span class="c1"># Underconfident correct answer</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">confidence_threshold</span> <span class="o">-=</span> <span class="mf">0.01</span>
        
        <span class="c1"># Keep threshold in reasonable range</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence_threshold</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidence_threshold</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="mf">0.95</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">calibration_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate calibration error of confidence estimates</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - error: Mean squared error between confidence and accuracy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        
        <span class="c1"># Convert boolean performance to 0/1</span>
        <span class="n">performance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">performance_history</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">confidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidence_history</span><span class="p">)</span>
        
        <span class="c1"># Calculate mean squared error</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">confidence</span> <span class="o">-</span> <span class="n">performance</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">error</span>
</pre></div>
</div>
</section>
</section>
<section id="ethical-considerations">
<h2>16.5 Ethical Considerations<a class="headerlink" href="#ethical-considerations" title="Link to this heading">#</a></h2>
<p>As brain-inspired AI systems advance, ethical considerations become increasingly important.</p>
<p><img alt="Neuroethics" src="_images/neuroethics.svg" /></p>
<section id="neural-privacy-and-brain-computer-interfaces">
<h3>16.5.1 Neural Privacy and Brain-Computer Interfaces<a class="headerlink" href="#neural-privacy-and-brain-computer-interfaces" title="Link to this heading">#</a></h3>
<p>Brain-computer interfaces (BCIs) raise important privacy considerations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">NeuralPrivacyFramework</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Framework for neural data privacy protection</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consent_levels</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;identifiable&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>     <span class="c1"># Share personally identifiable neural data</span>
            <span class="s2">&quot;pseudonymized&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>    <span class="c1"># Share with personally identifying info removed</span>
            <span class="s2">&quot;aggregate_only&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>    <span class="c1"># Share only data aggregated across individuals</span>
            <span class="s2">&quot;model_only&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>        <span class="c1"># Share only models trained on data, not data itself</span>
            <span class="s2">&quot;no_sharing&quot;</span><span class="p">:</span> <span class="kc">False</span>        <span class="c1"># No sharing of any kind</span>
        <span class="p">}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">data_types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;motor&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;sensitivity&quot;</span><span class="p">:</span> <span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="s2">&quot;sharing_allowed&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
            <span class="s2">&quot;emotion&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;sensitivity&quot;</span><span class="p">:</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;sharing_allowed&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
            <span class="s2">&quot;thoughts&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;sensitivity&quot;</span><span class="p">:</span> <span class="s2">&quot;very_high&quot;</span><span class="p">,</span> <span class="s2">&quot;sharing_allowed&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
            <span class="s2">&quot;personal_memories&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;sensitivity&quot;</span><span class="p">:</span> <span class="s2">&quot;very_high&quot;</span><span class="p">,</span> <span class="s2">&quot;sharing_allowed&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
        <span class="p">}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_purposes</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;medical_treatment&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;basic_research&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;commercial_development&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;advertising&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;law_enforcement&quot;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">check_access_permitted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_type</span><span class="p">,</span> <span class="n">purpose</span><span class="p">,</span> <span class="n">sharing_level</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if data access is permitted under the framework</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - data_type: Type of neural data</span>
<span class="sd">        - purpose: Purpose of data use</span>
<span class="sd">        - sharing_level: Level of data sharing</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - permitted: Whether access is permitted</span>
<span class="sd">        - reason: Reason for decision</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_types</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Unknown data type: </span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">&quot;</span>
        
        <span class="k">if</span> <span class="n">purpose</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_purposes</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Unknown purpose: </span><span class="si">{</span><span class="n">purpose</span><span class="si">}</span><span class="s2">&quot;</span>
        
        <span class="k">if</span> <span class="n">sharing_level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">consent_levels</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Unknown sharing level: </span><span class="si">{</span><span class="n">sharing_level</span><span class="si">}</span><span class="s2">&quot;</span>
        
        <span class="c1"># Check if data type can be shared at all</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_types</span><span class="p">[</span><span class="n">data_type</span><span class="p">][</span><span class="s2">&quot;sharing_allowed&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2"> data cannot be shared due to sensitivity&quot;</span>
        
        <span class="c1"># Check if purpose is authorized</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_purposes</span><span class="p">[</span><span class="n">purpose</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Purpose &#39;</span><span class="si">{</span><span class="n">purpose</span><span class="si">}</span><span class="s2">&#39; is not authorized&quot;</span>
        
        <span class="c1"># Check if sharing level is consented to</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">consent_levels</span><span class="p">[</span><span class="n">sharing_level</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No consent for sharing level: </span><span class="si">{</span><span class="n">sharing_level</span><span class="si">}</span><span class="s2">&quot;</span>
        
        <span class="c1"># Special cases</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;thoughts&quot;</span><span class="p">,</span> <span class="s2">&quot;personal_memories&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">sharing_level</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;identifiable&quot;</span><span class="p">,</span> <span class="s2">&quot;pseudonymized&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Higher-level anonymization required for </span><span class="si">{</span><span class="n">data_type</span><span class="si">}</span><span class="s2">&quot;</span>
        
        <span class="c1"># Access permitted</span>
        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;Access permitted under framework&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">differential_privacy_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">neural_data</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply differential privacy to neural data</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - neural_data: Raw neural data</span>
<span class="sd">        - epsilon: Privacy parameter (lower = more privacy)</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - private_data: Privacy-protected version of the data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Simplified implementation of differential privacy</span>
        <span class="c1"># Add calibrated noise to guarantee differential privacy</span>
        <span class="n">sensitivity</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Maximum change one person can have on output</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">sensitivity</span> <span class="o">/</span> <span class="n">epsilon</span>
        
        <span class="c1"># Add Laplace noise to each value</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">neural_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">private_data</span> <span class="o">=</span> <span class="n">neural_data</span> <span class="o">+</span> <span class="n">noise</span>
        
        <span class="k">return</span> <span class="n">private_data</span>
</pre></div>
</div>
</section>
<section id="implications-of-brain-like-ai">
<h3>16.5.2 Implications of Brain-like AI<a class="headerlink" href="#implications-of-brain-like-ai" title="Link to this heading">#</a></h3>
<p>As AI systems become more brain-like, ethical questions about consciousness and rights may arise:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">analyze_ai_consciousness_criteria</span><span class="p">(</span><span class="n">system_properties</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analyze an AI system against criteria for consciousness</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    - system_properties: Dictionary of properties and their values</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    - evaluation: Assessment against consciousness criteria</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Proposed criteria for consciousness (philosophical framework)</span>
    <span class="n">criteria</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;integration&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Information integration across subsystems&quot;</span><span class="p">,</span>
            <span class="s2">&quot;measurement&quot;</span><span class="p">:</span> <span class="s2">&quot;φ (phi) from Integrated Information Theory&quot;</span><span class="p">,</span>
            <span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mf">0.2</span>
        <span class="p">},</span>
        <span class="s2">&quot;reportability&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Ability to report on internal states&quot;</span><span class="p">,</span>
            <span class="s2">&quot;measurement&quot;</span><span class="p">:</span> <span class="s2">&quot;Accuracy of self-monitoring&quot;</span><span class="p">,</span>
            <span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mf">0.15</span>
        <span class="p">},</span>
        <span class="s2">&quot;self_model&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Representation of self as distinct from environment&quot;</span><span class="p">,</span>
            <span class="s2">&quot;measurement&quot;</span><span class="p">:</span> <span class="s2">&quot;Internal model calibration score&quot;</span><span class="p">,</span>
            <span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">,</span>
            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mf">0.2</span>
        <span class="p">},</span>
        <span class="s2">&quot;intentionality&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;States are about something (have content)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;measurement&quot;</span><span class="p">:</span> <span class="s2">&quot;Semantic coherence of internal states&quot;</span><span class="p">,</span>
            <span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mf">0.15</span>
        <span class="p">},</span>
        <span class="s2">&quot;adaptation&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Flexible response to novel situations&quot;</span><span class="p">,</span>
            <span class="s2">&quot;measurement&quot;</span><span class="p">:</span> <span class="s2">&quot;Performance on out-of-distribution tasks&quot;</span><span class="p">,</span>
            <span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mf">0.1</span>
        <span class="p">},</span>
        <span class="s2">&quot;temporality&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Temporal integration of experience&quot;</span><span class="p">,</span>
            <span class="s2">&quot;measurement&quot;</span><span class="p">:</span> <span class="s2">&quot;Memory coherence score&quot;</span><span class="p">,</span>
            <span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mf">0.1</span>
        <span class="p">},</span>
        <span class="s2">&quot;qualia&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Subjective experience (hardest to measure)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;measurement&quot;</span><span class="p">:</span> <span class="s2">&quot;Behavioral indicators of experience&quot;</span><span class="p">,</span>
            <span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
            <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mf">0.1</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1"># Evaluate system against criteria</span>
    <span class="n">evaluation</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">total_score</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">max_score</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">details</span> <span class="ow">in</span> <span class="n">criteria</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">criterion</span> <span class="ow">in</span> <span class="n">system_properties</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">system_properties</span><span class="p">[</span><span class="n">criterion</span><span class="p">]</span>
            <span class="c1"># Calculate score (0-1)</span>
            <span class="n">meets_threshold</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="n">details</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">]</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">details</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
            
            <span class="n">evaluation</span><span class="p">[</span><span class="n">criterion</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span>
                <span class="s2">&quot;meets_threshold&quot;</span><span class="p">:</span> <span class="n">meets_threshold</span><span class="p">,</span>
                <span class="s2">&quot;weighted_score&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">,</span>
                <span class="s2">&quot;details&quot;</span><span class="p">:</span> <span class="n">details</span>
            <span class="p">}</span>
            
            <span class="n">total_score</span> <span class="o">+=</span> <span class="n">score</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">evaluation</span><span class="p">[</span><span class="n">criterion</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;meets_threshold&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;weighted_score&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s2">&quot;details&quot;</span><span class="p">:</span> <span class="n">details</span>
            <span class="p">}</span>
        
        <span class="n">max_score</span> <span class="o">+=</span> <span class="n">details</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
    
    <span class="c1"># Overall assessment</span>
    <span class="n">evaluation</span><span class="p">[</span><span class="s2">&quot;overall&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;total_score&quot;</span><span class="p">:</span> <span class="n">total_score</span><span class="p">,</span>
        <span class="s2">&quot;max_possible&quot;</span><span class="p">:</span> <span class="n">max_score</span><span class="p">,</span>
        <span class="s2">&quot;percentage&quot;</span><span class="p">:</span> <span class="n">total_score</span> <span class="o">/</span> <span class="n">max_score</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="s2">&quot;This framework does not claim to definitively determine consciousness, &quot;</span>
                  <span class="s2">&quot;but provides a structured approach to evaluating systems against proposed criteria.&quot;</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">evaluation</span>
</pre></div>
</div>
</section>
<section id="neuroethics-frameworks">
<h3>16.5.3 Neuroethics Frameworks<a class="headerlink" href="#neuroethics-frameworks" title="Link to this heading">#</a></h3>
<p>The field of neuroethics provides guidance for responsible development of neurotechnology:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ResponsibleInnovationGuidelines</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Guidelines for responsible innovation in neuro-AI</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">principles</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;transparency&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Clear documentation of capabilities and limitations&quot;</span><span class="p">,</span>
                <span class="s2">&quot;requirements&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;Publication of technical specifications&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Accessible explanation of function&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Disclosure of training data sources&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Clear indication of AI-generated content&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="s2">&quot;accountability&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Clear lines of responsibility for system outcomes&quot;</span><span class="p">,</span>
                <span class="s2">&quot;requirements&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;Defined responsibility for errors&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Auditing mechanisms&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Recourse for affected individuals&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Regular impact assessments&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="s2">&quot;inclusivity&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Development with diverse stakeholder input&quot;</span><span class="p">,</span>
                <span class="s2">&quot;requirements&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;Engagement with potentially affected communities&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Diverse development team&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Consideration of varied cultural perspectives&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Testing across diverse populations&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="s2">&quot;non_maleficence&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Prevention of harm from system operation&quot;</span><span class="p">,</span>
                <span class="s2">&quot;requirements&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;Safety testing protocols&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Risk assessment framework&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Ongoing monitoring&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Kill switch mechanisms&quot;</span>
                <span class="p">]</span>
            <span class="p">},</span>
            <span class="s2">&quot;autonomy&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Respect for human decision-making authority&quot;</span><span class="p">,</span>
                <span class="s2">&quot;requirements&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;Informed consent processes&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Opt-out mechanisms&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Control over personal data&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Avoidance of manipulative design&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_technology</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tech_description</span><span class="p">,</span> <span class="n">principles_assessment</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluate a technology against responsible innovation principles</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - tech_description: Description of the technology</span>
<span class="sd">        - principles_assessment: Dictionary with ratings for each principle</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - evaluation: Detailed evaluation against principles</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">evaluation</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;technology&quot;</span><span class="p">:</span> <span class="n">tech_description</span><span class="p">,</span>
            <span class="s2">&quot;principles&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;overall_adherence&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;recommendations&quot;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>
        
        <span class="n">total_score</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">principle</span><span class="p">,</span> <span class="n">details</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">principles</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">principle</span> <span class="ow">in</span> <span class="n">principles_assessment</span><span class="p">:</span>
                <span class="n">score</span> <span class="o">=</span> <span class="n">principles_assessment</span><span class="p">[</span><span class="n">principle</span><span class="p">]</span>
                <span class="n">total_score</span> <span class="o">+=</span> <span class="n">score</span>
                
                <span class="n">evaluation</span><span class="p">[</span><span class="s2">&quot;principles&quot;</span><span class="p">][</span><span class="n">principle</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="n">score</span><span class="p">,</span>
                    <span class="s2">&quot;details&quot;</span><span class="p">:</span> <span class="n">details</span><span class="p">,</span>
                    <span class="s2">&quot;strengths&quot;</span><span class="p">:</span> <span class="n">principles_assessment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">principle</span><span class="si">}</span><span class="s2">_strengths&quot;</span><span class="p">,</span> <span class="p">[]),</span>
                    <span class="s2">&quot;weaknesses&quot;</span><span class="p">:</span> <span class="n">principles_assessment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">principle</span><span class="si">}</span><span class="s2">_weaknesses&quot;</span><span class="p">,</span> <span class="p">[])</span>
                <span class="p">}</span>
                
                <span class="c1"># Generate recommendations for low scores</span>
                <span class="k">if</span> <span class="n">score</span> <span class="o">&lt;</span> <span class="mf">0.7</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">req</span> <span class="ow">in</span> <span class="n">details</span><span class="p">[</span><span class="s2">&quot;requirements&quot;</span><span class="p">]:</span>
                        <span class="n">evaluation</span><span class="p">[</span><span class="s2">&quot;recommendations&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Improve </span><span class="si">{</span><span class="n">principle</span><span class="si">}</span><span class="s2"> by addressing: </span><span class="si">{</span><span class="n">req</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">evaluation</span><span class="p">[</span><span class="s2">&quot;principles&quot;</span><span class="p">][</span><span class="n">principle</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                    <span class="s2">&quot;details&quot;</span><span class="p">:</span> <span class="n">details</span><span class="p">,</span>
                    <span class="s2">&quot;note&quot;</span><span class="p">:</span> <span class="s2">&quot;Not assessed&quot;</span>
                <span class="p">}</span>
        
        <span class="c1"># Calculate overall adherence</span>
        <span class="n">evaluation</span><span class="p">[</span><span class="s2">&quot;overall_adherence&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_score</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">principles</span><span class="p">)</span>
        
        <span class="c1"># Overall assessment</span>
        <span class="k">if</span> <span class="n">evaluation</span><span class="p">[</span><span class="s2">&quot;overall_adherence&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="n">evaluation</span><span class="p">[</span><span class="s2">&quot;summary&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;High adherence to responsible innovation principles&quot;</span>
        <span class="k">elif</span> <span class="n">evaluation</span><span class="p">[</span><span class="s2">&quot;overall_adherence&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.6</span><span class="p">:</span>
            <span class="n">evaluation</span><span class="p">[</span><span class="s2">&quot;summary&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Moderate adherence with specific areas needing improvement&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">evaluation</span><span class="p">[</span><span class="s2">&quot;summary&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Low adherence - significant revisions recommended&quot;</span>
        
        <span class="k">return</span> <span class="n">evaluation</span>
</pre></div>
</div>
</section>
<section id="responsible-innovation">
<h3>16.5.4 Responsible Innovation<a class="headerlink" href="#responsible-innovation" title="Link to this heading">#</a></h3>
<p>Responsible innovation involves anticipating impacts and engaging diverse stakeholders:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ethical_impact_assessment</span><span class="p">(</span><span class="n">technology_description</span><span class="p">,</span> <span class="n">stakeholders</span><span class="p">,</span> <span class="n">societal_domains</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Conduct an ethical impact assessment for a neuro-AI technology</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    - technology_description: Description of the technology</span>
<span class="sd">    - stakeholders: List of stakeholder groups</span>
<span class="sd">    - societal_domains: Domains to assess impact on</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    - assessment: Impact assessment results</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">assessment</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;technology&quot;</span><span class="p">:</span> <span class="n">technology_description</span><span class="p">,</span>
        <span class="s2">&quot;stakeholder_impacts&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;domain_impacts&quot;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s2">&quot;risk_factors&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;benefit_factors&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;uncertainty_factors&quot;</span><span class="p">:</span> <span class="p">[]</span>
    <span class="p">}</span>
    
    <span class="c1"># Assess impact on each stakeholder group</span>
    <span class="k">for</span> <span class="n">stakeholder</span> <span class="ow">in</span> <span class="n">stakeholders</span><span class="p">:</span>
        <span class="c1"># In a real assessment, this would involve engagement with stakeholders</span>
        <span class="c1"># For this example, we&#39;ll simulate with placeholder values</span>
        <span class="n">impact</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;direct_benefits&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;direct_risks&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;indirect_effects&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;power_dynamics&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
        <span class="p">}</span>
        <span class="n">assessment</span><span class="p">[</span><span class="s2">&quot;stakeholder_impacts&quot;</span><span class="p">][</span><span class="n">stakeholder</span><span class="p">]</span> <span class="o">=</span> <span class="n">impact</span>
    
    <span class="c1"># Assess impact on each societal domain</span>
    <span class="k">for</span> <span class="n">domain</span> <span class="ow">in</span> <span class="n">societal_domains</span><span class="p">:</span>
        <span class="c1"># In a real assessment, this would involve domain expert input</span>
        <span class="c1"># For this example, we&#39;ll simulate with placeholder values</span>
        <span class="n">impact</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;short_term_effects&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;long_term_effects&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;structural_changes&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
        <span class="p">}</span>
        <span class="n">assessment</span><span class="p">[</span><span class="s2">&quot;domain_impacts&quot;</span><span class="p">][</span><span class="n">domain</span><span class="p">]</span> <span class="o">=</span> <span class="n">impact</span>
    
    <span class="c1"># Identify key risk and benefit factors</span>
    <span class="c1"># In a real assessment, this would be based on stakeholder and expert input</span>
    <span class="n">assessment</span><span class="p">[</span><span class="s2">&quot;risk_factors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Privacy implications of neural data collection&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Potential for creating new social inequalities&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Risk of misuse for manipulation or control&quot;</span>
    <span class="p">]</span>
    
    <span class="n">assessment</span><span class="p">[</span><span class="s2">&quot;benefit_factors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Potential for new treatments for neurological conditions&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Improved human-computer interaction&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Enhanced understanding of neural processes&quot;</span>
    <span class="p">]</span>
    
    <span class="n">assessment</span><span class="p">[</span><span class="s2">&quot;uncertainty_factors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Long-term effects on neural plasticity&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Potential for emergent behaviors in advanced systems&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Future regulatory frameworks&quot;</span>
    <span class="p">]</span>
    
    <span class="c1"># Generate recommendations</span>
    <span class="n">assessment</span><span class="p">[</span><span class="s2">&quot;recommendations&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;Implement stringent data privacy protections&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Establish inclusive governance mechanisms&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ensure accessible distribution of benefits&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Develop monitoring frameworks for long-term effects&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Create clear boundaries for acceptable use cases&quot;</span>
    <span class="p">]</span>
    
    <span class="k">return</span> <span class="n">assessment</span>
</pre></div>
</div>
</section>
</section>
<section id="code-lab-simple-spiking-neural-network">
<h2>16.6 Code Lab: Simple Spiking Neural Network<a class="headerlink" href="#code-lab-simple-spiking-neural-network" title="Link to this heading">#</a></h2>
<p>Let’s implement a simple spiking neural network that demonstrates the key principles of neuromorphic computing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="kn">import</span> <span class="n">FuncAnimation</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SpikingNeuralNetwork</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_input</span><span class="p">,</span> <span class="n">n_hidden</span><span class="p">,</span> <span class="n">n_output</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simple Spiking Neural Network with LIF neurons</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - n_input: Number of input neurons</span>
<span class="sd">        - n_hidden: Number of hidden neurons</span>
<span class="sd">        - n_output: Number of output neurons</span>
<span class="sd">        - dt: Simulation time step (ms)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_input</span> <span class="o">=</span> <span class="n">n_input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden</span> <span class="o">=</span> <span class="n">n_hidden</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_output</span> <span class="o">=</span> <span class="n">n_output</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
        
        <span class="c1"># Initialize random weights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w_input_hidden</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="n">n_hidden</span><span class="p">,</span> <span class="n">n_input</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w_hidden_output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="n">n_output</span><span class="p">,</span> <span class="n">n_hidden</span><span class="p">))</span>
        
        <span class="c1"># Neuron parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_rest</span> <span class="o">=</span> <span class="o">-</span><span class="mf">70.0</span>  <span class="c1"># resting potential (mV)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_reset</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.0</span>  <span class="c1"># reset potential (mV)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_threshold</span> <span class="o">=</span> <span class="o">-</span><span class="mf">55.0</span>  <span class="c1"># threshold potential (mV)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tau_m</span> <span class="o">=</span> <span class="mf">10.0</span>  <span class="c1"># membrane time constant (ms)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refractory_period</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># refractory period (ms)</span>
        
        <span class="c1"># State variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_hidden</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_hidden</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_rest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_output</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_rest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time_hidden</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_hidden</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time_output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_output</span><span class="p">)</span>
        
        <span class="c1"># Recording</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spike_history_hidden</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spike_history_output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_history_hidden</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_history_output</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Current time</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">reset_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset network state&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_hidden</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_rest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_output</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_rest</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time_hidden</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time_output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_output</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spike_history_hidden</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spike_history_output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_history_hidden</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_history_output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_spikes</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run one simulation step</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - input_spikes: Binary array of input spikes (0 or 1)</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - output_spikes: Binary array of output spikes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        
        <span class="c1"># Update hidden layer</span>
        <span class="c1"># Calculate input current from input layer spikes</span>
        <span class="n">input_current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_input_hidden</span><span class="p">,</span> <span class="n">input_spikes</span><span class="p">)</span>
        
        <span class="c1"># Check which neurons are not in refractory period</span>
        <span class="n">active_hidden</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time_hidden</span> <span class="o">&lt;=</span> <span class="mi">0</span>
        
        <span class="c1"># Update membrane potentials for active neurons</span>
        <span class="n">dv_hidden</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v_hidden</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_rest</span> <span class="o">+</span> <span class="n">input_current</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau_m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_hidden</span><span class="p">[</span><span class="n">active_hidden</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dv_hidden</span><span class="p">[</span><span class="n">active_hidden</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        
        <span class="c1"># Check for spikes in hidden layer</span>
        <span class="n">hidden_spikes</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_hidden</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_threshold</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        
        <span class="c1"># Reset membrane potential and set refractory period for spiked neurons</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">hidden_spikes</span><span class="p">):</span>
            <span class="n">spike_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">hidden_spikes</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_hidden</span><span class="p">[</span><span class="n">spike_indices</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_reset</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time_hidden</span><span class="p">[</span><span class="n">spike_indices</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refractory_period</span>
        
        <span class="c1"># Decrement refractory time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time_hidden</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time_hidden</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time_hidden</span><span class="p">)</span>
        
        <span class="c1"># Update output layer (similar process)</span>
        <span class="n">output_current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_hidden_output</span><span class="p">,</span> <span class="n">hidden_spikes</span><span class="p">)</span>
        <span class="n">active_output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time_output</span> <span class="o">&lt;=</span> <span class="mi">0</span>
        
        <span class="n">dv_output</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v_output</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_rest</span> <span class="o">+</span> <span class="n">output_current</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">tau_m</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_output</span><span class="p">[</span><span class="n">active_output</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dv_output</span><span class="p">[</span><span class="n">active_output</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        
        <span class="n">output_spikes</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_output</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_threshold</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">output_spikes</span><span class="p">):</span>
            <span class="n">spike_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">output_spikes</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_output</span><span class="p">[</span><span class="n">spike_indices</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_reset</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time_output</span><span class="p">[</span><span class="n">spike_indices</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refractory_period</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time_output</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time_output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">refractory_time_output</span><span class="p">)</span>
        
        <span class="c1"># Record history</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spike_history_hidden</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hidden_spikes</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spike_history_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output_spikes</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_history_hidden</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_hidden</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_history_output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_output</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
        <span class="k">return</span> <span class="n">output_spikes</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">run_simulation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_pattern</span><span class="p">,</span> <span class="n">simulation_time</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run simulation for specified time with given input pattern</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - input_pattern: Function that returns input spikes at each time step</span>
<span class="sd">        - simulation_time: Total simulation time (ms)</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - output_history: History of output spikes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">simulation_time</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
        
        <span class="n">output_history</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">step</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
            <span class="n">input_spikes</span> <span class="o">=</span> <span class="n">input_pattern</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">output_spikes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">input_spikes</span><span class="p">)</span>
            <span class="n">output_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output_spikes</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">output_history</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">)):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot spike raster and membrane potentials&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">spike_history_hidden</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No simulation data to plot&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="c1"># Convert spike history to arrays</span>
        <span class="n">spikes_hidden</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spike_history_hidden</span><span class="p">)</span>
        <span class="n">spikes_output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spike_history_output</span><span class="p">)</span>
        
        <span class="c1"># Time array</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spikes_hidden</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
        
        <span class="c1"># Plot hidden layer spikes</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden</span><span class="p">):</span>
            <span class="n">spike_times</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">spikes_hidden</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">spike_times</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">spike_times</span><span class="p">)</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Hidden Neuron&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Hidden Layer Spike Raster&#39;</span><span class="p">)</span>
        
        <span class="c1"># Plot output layer spikes</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_output</span><span class="p">):</span>
            <span class="n">spike_times</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="n">spikes_output</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">spike_times</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">spike_times</span><span class="p">)</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Output Neuron&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Output Layer Spike Raster&#39;</span><span class="p">)</span>
        
        <span class="c1"># Plot membrane potentials</span>
        <span class="n">v_hidden</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_history_hidden</span><span class="p">)</span>
        <span class="n">v_output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_history_output</span><span class="p">)</span>
        
        <span class="c1"># Plot a few hidden neurons</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden</span><span class="p">)):</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">v_hidden</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Neuron </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_threshold</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Threshold&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Membrane Potential (mV)&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Hidden Layer Membrane Potentials&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        
        <span class="c1"># Plot all output neurons</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_output</span><span class="p">):</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">v_output</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Neuron </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_threshold</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Threshold&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (ms)&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Membrane Potential (mV)&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Output Layer Membrane Potentials&#39;</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">fig</span>

<span class="c1"># Demo: pattern recognition with spiking neural network</span>
<span class="k">def</span><span class="w"> </span><span class="nf">run_snn_demo</span><span class="p">():</span>
    <span class="c1"># Create a simple SNN with 5 input, 10 hidden, and 2 output neurons</span>
    <span class="n">snn</span> <span class="o">=</span> <span class="n">SpikingNeuralNetwork</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># Define input patterns (simplified)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pattern_1</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="c1"># Pattern 1: neurons 0, 1, 2 active</span>
        <span class="n">period</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># ms</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="k">if</span> <span class="n">t</span> <span class="o">%</span> <span class="n">period</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span> <span class="ow">and</span> <span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">6</span> <span class="ow">and</span> <span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">12</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">pattern_2</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="c1"># Pattern 2: neurons 2, 3, 4 active</span>
        <span class="n">period</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># ms</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">7</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span> <span class="ow">and</span> <span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="mi">1</span> <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">8</span> <span class="ow">and</span> <span class="p">(</span><span class="n">t</span> <span class="o">%</span> <span class="n">period</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">15</span> <span class="k">else</span> <span class="mi">0</span><span class="p">])</span>
    
    <span class="c1"># Run simulations with different input patterns</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running simulation for pattern 1...&quot;</span><span class="p">)</span>
    <span class="n">snn</span><span class="o">.</span><span class="n">run_simulation</span><span class="p">(</span><span class="n">pattern_1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">fig1</span> <span class="o">=</span> <span class="n">snn</span><span class="o">.</span><span class="n">plot_activity</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fig1</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Pattern 1 Response&quot;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running simulation for pattern 2...&quot;</span><span class="p">)</span>
    <span class="n">snn</span><span class="o">.</span><span class="n">run_simulation</span><span class="p">(</span><span class="n">pattern_2</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">fig2</span> <span class="o">=</span> <span class="n">snn</span><span class="o">.</span><span class="n">plot_activity</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">fig2</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Pattern 2 Response&quot;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="s2">&quot;SNN demo completed&quot;</span>
</pre></div>
</div>
</section>
<section id="take-aways">
<h2>16.7 Take-aways<a class="headerlink" href="#take-aways" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Neuroscience and AI will continue to inform each other</strong> in a virtuous cycle, with brain principles inspiring new AI architectures and AI helping to unravel neural mechanisms.</p></li>
<li><p><strong>Brain-inspired computing may lead to more efficient AI</strong> through approaches like neuromorphic hardware, which can achieve orders of magnitude improvements in energy efficiency.</p></li>
<li><p><strong>Continual learning remains a key challenge</strong> where biological solutions like memory consolidation, synaptic stabilization, and neuromodulation offer valuable inspiration.</p></li>
<li><p><strong>Whole-brain integration</strong> approaches that combine specialized systems may be crucial for achieving more general artificial intelligence with human-like flexibility.</p></li>
<li><p><strong>Ethical considerations should guide development</strong> of neuro-AI technologies, with frameworks for neural privacy, responsible innovation, and potential consciousness in advanced systems.</p></li>
</ul>
</section>
<section id="further-reading-media">
<h2>16.8 Further Reading &amp; Media<a class="headerlink" href="#further-reading-media" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Davies, M., et al. (2018). <a class="reference external" href="https://ieeexplore.ieee.org/document/8259423">Loihi: A Neuromorphic Manycore Processor with On-Chip Learning</a>. IEEE Micro, 38(1), 82-99. This paper describes Intel’s neuromorphic chip architecture and its advantages for brain-inspired computing.</p></li>
<li><p>Kirkpatrick, J., et al. (2017). <a class="reference external" href="https://www.pnas.org/content/114/13/3521">Overcoming catastrophic forgetting in neural networks</a>. Proceedings of the National Academy of Sciences, 114(13), 3521-3526. Introduces Elastic Weight Consolidation, a technique inspired by synaptic consolidation.</p></li>
<li><p>Richards, B.A., et al. (2019). <a class="reference external" href="https://www.nature.com/articles/s41593-019-0520-2">A deep learning framework for neuroscience</a>. Nature Neuroscience, 22(11), 1761-1770. Explores how deep learning can advance neuroscientific understanding.</p></li>
<li><p>Dehaene, S., Lau, H., &amp; Kouider, S. (2017). <a class="reference external" href="https://science.sciencemag.org/content/358/6362/486">What is consciousness, and could machines have it?</a>. Science, 358(6362), 486-492. Discusses theories of consciousness and their implications for AI.</p></li>
<li><p>Ienca, M., &amp; Andorno, R. (2017). <a class="reference external" href="https://lsspjournal.biomedcentral.com/articles/10.1186/s40504-017-0050-1">Towards new human rights in the age of neuroscience and neurotechnology</a>. Life Sciences, Society and Policy, 13(1), 5. Proposes a framework for “neurorights” in the context of advancing neurotechnology.</p></li>
<li><p>Hassabis, D., Kumaran, D., Summerfield, C., &amp; Botvinick, M. (2017). <a class="reference external" href="https://www.cell.com/neuron/fulltext/S0896-6273(17)30509-3">Neuroscience-Inspired Artificial Intelligence</a>. Neuron, 95(2), 245-258. A comprehensive overview of the interdisciplinary connections between neuroscience and AI.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "executablebooks/jupyter-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Richard Young
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>