
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 17: Brain-Computer Interfaces and Human-AI Interaction &#8212; The Neuroscience of AI</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'part6/ch17_bci_human_ai_interfaces';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://neuroai-handbook.github.io/part6/ch17_bci_human_ai_interfaces.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 18: Neuromorphic Computing" href="ch18_neuromorphic_computing.html" />
    <link rel="prev" title="Chapter 16: Where Next for Neuro-AI?" href="../part5/ch16_future_directions.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nai.png" class="logo__image only-light" alt="The Neuroscience of AI - Home"/>
    <script>document.write(`<img src="../_static/nai.png" class="logo__image only-dark" alt="The Neuroscience of AI - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    The Neuroscience of AI
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Cover</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cover.html">Cover</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Front Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../frontmatter/copyright.html">Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frontmatter/acknowledgments.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frontmatter/about.html">About This Book</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part I · Brains &amp; Inspiration</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part1/ch01_intro.html">Chapter 1: Introduction to Neuroscience ↔ AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part1/ch02_neuro_foundations.html">Chapter 2: Neuroscience Foundations for AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part1/ch03_spatial_navigation.html">Chapter 3: Spatial Navigation – Place &amp; Grid Cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part1/ch04_perception_pipeline.html">Chapter 4: Perception Pipeline – Visual Cortex → CNNs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part II · Brains Meet Math &amp; Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part2/ch05_brain_networks.html">Chapter 5: Default-Mode vs Executive Control Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/ch06_neurostimulation.html">Chapter 6: Neurostimulation &amp; Plasticity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/ch07_information_theory.html">Chapter 7: Information Theory Essentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/ch08_data_science_pipeline.html">Chapter 8: Data-Science Pipeline in Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part III · Learning Machines</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part3/ch09_ml_foundations.html">Chapter 9: Classical Machine-Learning Foundations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part3/ch10_deep_learning.html">Chapter 10: Deep Learning: Training &amp; Optimisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part3/ch11_sequence_models.html">Chapter 11: Sequence Models: RNN → Attention → Transformer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part IV · Frontier Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part4/ch12_large_language_models.html">Chapter 12: Large Language Models &amp; Fine-Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part4/ch13_multimodal_models.html">Chapter 13: Multimodal &amp; Diffusion Models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part V · Ethics &amp; Futures</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part5/ch15_ethical_ai.html">Chapter 15: Ethical AI - Considerations for NeuroAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part5/ch16_future_directions.html">Chapter 16: Where Next for Neuro-AI?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part VI · Advanced Applications</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 17: Brain-Computer Interfaces and Human-AI Interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch18_neuromorphic_computing.html">Chapter 18: Neuromorphic Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch19_cognitive_neuro_dl.html">Chapter 19: Cognitive Neuroscience and Deep Learning</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="ch20_case_studies.html">Case Studies in NeuroAI</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="ch20_interactive.html">Interactive NeuroAI Case Studies</a></li>
<li class="toctree-l2"><a class="reference internal" href="jupyter_ai_demo.html">AI-Assisted Learning with Jupyter AI</a></li>
<li class="toctree-l2"><a class="reference internal" href="rise_slides_demo.html">Creating Presentations with RISE</a></li>


</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="ch21_ai_for_neuro_discovery.html">Chapter 21: AI for Neuroscience Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch22_embodied_ai_robotics.html">Chapter 22: Embodied AI and Robotics</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch23_lifelong_learning.html">Chapter 23: Lifelong Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch24_quantum_computing_neuroai.html">Chapter 24: Quantum Computing and NeuroAI</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendices/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/math_python_refresher.html">Appendix A: Math &amp; Python Mini-Refresher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/dataset_catalogue.html">Appendix B: Dataset Catalogue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/colab_setup.html">Appendix C: Google Colab Setup for NeuroAI</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/edit/master/docs/part6/ch17_bci_human_ai_interfaces.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fpart6/ch17_bci_human_ai_interfaces.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/part6/ch17_bci_human_ai_interfaces.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 17: Brain-Computer Interfaces and Human-AI Interaction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-goals">Chapter Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-connecting-brains-and-machines">17.1 Introduction: Connecting Brains and Machines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#neurophysiological-bases-for-bcis">17.2 Neurophysiological Bases for BCIs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relevant-brain-systems-for-interface">17.2.1 Relevant Brain Systems for Interface</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-signal-types">17.2.2 Neural Signal Types</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bci-technologies-and-approaches">17.3 BCI Technologies and Approaches</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#invasive-bcis">17.3.1 Invasive BCIs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-invasive-bcis">17.3.2 Non-invasive BCIs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-decoding-approaches">17.3.3 Neural Decoding Approaches</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ai-enhanced-bcis">17.4 AI-Enhanced BCIs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#machine-learning-for-neural-decoding">17.4.1 Machine Learning for Neural Decoding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptive-and-learning-systems">17.4.2 Adaptive and Learning Systems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-feedback-and-closed-loop-systems">17.4.3 Neural Feedback and Closed-Loop Systems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#human-ai-interaction-via-neural-interfaces">17.5 Human-AI Interaction via Neural Interfaces</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bci-as-a-communication-channel">17.5.1 BCI as a Communication Channel</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-interfaces-for-ai-agents">17.5.2 Neural Interfaces for AI Agents</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-applications-and-case-studies">17.6 Practical Applications and Case Studies</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clinical-applications">17.6.1 Clinical Applications</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-paralysis-treatment-with-bcis">17.6.1.1 Advanced Paralysis Treatment with BCIs</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#communication-systems-for-locked-in-syndrome">17.6.1.2 Communication Systems for Locked-in Syndrome</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurorehabilitation-for-stroke-recovery">17.6.1.3 Neurorehabilitation for Stroke Recovery</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#treatment-resistant-depression-therapy">17.6.1.4 Treatment-Resistant Depression Therapy</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-medical-applications">17.6.2 Non-medical Applications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#emerging-use-cases">17.6.3 Emerging Use Cases</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ethical-and-societal-considerations">17.7 Ethical and Societal Considerations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#privacy-and-security">17.7.1 Privacy and Security</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agency-and-identity">17.7.2 Agency and Identity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-and-equity">17.7.3 Access and Equity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#future-directions-in-bci-and-human-ai-interaction">17.8 Future Directions in BCI and Human-AI Interaction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#technological-horizons">17.8.1 Technological Horizons</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-with-emerging-ai">17.8.2 Integration with Emerging AI</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#expanded-applications">17.8.3 Expanded Applications</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-exercise-building-a-simple-eeg-classifier">17.9 Practical Exercise: Building a Simple EEG Classifier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-take-aways">17.10 Chapter Take-aways</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">17.11 Further Reading</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-17-brain-computer-interfaces-and-human-ai-interaction">
<h1>Chapter 17: Brain-Computer Interfaces and Human-AI Interaction<a class="headerlink" href="#chapter-17-brain-computer-interfaces-and-human-ai-interaction" title="Link to this heading">#</a></h1>
<div style="page-break-before:always;"></div>
<section id="chapter-goals">
<h2>Chapter Goals<a class="headerlink" href="#chapter-goals" title="Link to this heading">#</a></h2>
<p>After completing this chapter, you will be able to:</p>
<ul class="simple">
<li><p>Understand the fundamental principles of brain-computer interfaces and their role in human-AI interaction</p></li>
<li><p>Explain the neurophysiological basis for various BCI approaches</p></li>
<li><p>Compare invasive, semi-invasive, and non-invasive BCI methodologies</p></li>
<li><p>Implement basic algorithms for neural signal processing and decoding</p></li>
<li><p>Describe how AI enhances BCI performance and capabilities</p></li>
<li><p>Design interactive systems that integrate BCIs with AI assistants</p></li>
<li><p>Evaluate ethical considerations and future directions in BCI development</p></li>
</ul>
</section>
<section id="introduction-connecting-brains-and-machines">
<h2>17.1 Introduction: Connecting Brains and Machines<a class="headerlink" href="#introduction-connecting-brains-and-machines" title="Link to this heading">#</a></h2>
<p>Brain-Computer Interfaces represent one of the most direct applications of neuroscience to technology, creating communication pathways between neural activity and external devices. These systems measure brain activity, interpret neural signals, and translate them into commands that can control computers, prosthetics, or other devices.</p>
<p>In recent years, BCIs have evolved from relatively simple systems to sophisticated neural interfaces enhanced by artificial intelligence. This evolution has transformed BCIs from specialized medical tools to potentially mainstream technologies that could fundamentally alter human-computer interaction.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Conceptual overview of a BCI system</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BrainComputerInterface</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">acquisition_method</span><span class="o">=</span><span class="s2">&quot;EEG&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a BCI system with the specified neural acquisition method</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        acquisition_method : str</span>
<span class="sd">            Method used to record brain activity</span>
<span class="sd">            Options: &quot;EEG&quot;, &quot;ECoG&quot;, &quot;LFP&quot;, &quot;fNIRS&quot;, &quot;MEG&quot;, &quot;Spikes&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acquisition_method</span> <span class="o">=</span> <span class="n">acquisition_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing_pipeline</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_extraction</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_device</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feedback_mechanism</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">add_preprocessing_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a preprocessing step to the pipeline&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing_pipeline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">set_feature_extractor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extractor</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the feature extraction method&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_extraction</span> <span class="o">=</span> <span class="n">extractor</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">set_decoder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">decoder</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the decoding algorithm&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span> <span class="o">=</span> <span class="n">decoder</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">set_output_device</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the output device controlled by the BCI&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_device</span> <span class="o">=</span> <span class="n">device</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">set_feedback_mechanism</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feedback</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the feedback mechanism for the user&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feedback_mechanism</span> <span class="o">=</span> <span class="n">feedback</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">process_neural_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">neural_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process incoming neural data through the BCI pipeline&quot;&quot;&quot;</span>
        <span class="c1"># Preprocessing</span>
        <span class="n">processed_data</span> <span class="o">=</span> <span class="n">neural_data</span>
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocessing_pipeline</span><span class="p">:</span>
            <span class="n">processed_data</span> <span class="o">=</span> <span class="n">step</span><span class="p">(</span><span class="n">processed_data</span><span class="p">)</span>
            
        <span class="c1"># Feature extraction</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_extraction</span><span class="p">(</span><span class="n">processed_data</span><span class="p">)</span>
        
        <span class="c1"># Decoding</span>
        <span class="n">commands</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        
        <span class="c1"># Send to output device</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_device</span><span class="p">(</span><span class="n">commands</span><span class="p">)</span>
        
        <span class="c1"># Provide feedback to user</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feedback_mechanism</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">output</span>
</pre></div>
</div>
<div style="page-break-before:always;"></div>
</section>
<section id="neurophysiological-bases-for-bcis">
<h2>17.2 Neurophysiological Bases for BCIs<a class="headerlink" href="#neurophysiological-bases-for-bcis" title="Link to this heading">#</a></h2>
<section id="relevant-brain-systems-for-interface">
<h3>17.2.1 Relevant Brain Systems for Interface<a class="headerlink" href="#relevant-brain-systems-for-interface" title="Link to this heading">#</a></h3>
<p>Brain-computer interfaces target various neural systems, depending on the intended application:</p>
<ul class="simple">
<li><p><strong>Motor systems</strong>: The primary and supplementary motor cortices generate signals related to movement planning and execution.</p></li>
<li><p><strong>Sensory systems</strong>: Visual, auditory, and somatosensory cortices process incoming sensory information.</p></li>
<li><p><strong>Linguistic systems</strong>: Broca’s and Wernicke’s areas in the left hemisphere (for most people) process language.</p></li>
<li><p><strong>Attention networks</strong>: Fronto-parietal networks modulate attentional resources.</p></li>
<li><p><strong>Emotional processing</strong>: The limbic system, including the amygdala and anterior cingulate cortex, processes emotional content.</p></li>
</ul>
</section>
<section id="neural-signal-types">
<h3>17.2.2 Neural Signal Types<a class="headerlink" href="#neural-signal-types" title="Link to this heading">#</a></h3>
<p>BCIs decode different types of neural signals:</p>
<ul class="simple">
<li><p><strong>Action potentials (spikes)</strong>: Individual neuronal firing patterns</p></li>
<li><p><strong>Local Field Potentials (LFPs)</strong>: Aggregate electrical activity from local neural populations</p></li>
<li><p><strong>Electrocorticography (ECoG)</strong>: Electrical activity recorded from the cortical surface</p></li>
<li><p><strong>Electroencephalography (EEG)</strong>: Electrical activity recorded from the scalp</p></li>
<li><p><strong>Functional Near-Infrared Spectroscopy (fNIRS)</strong>: Hemodynamic responses</p></li>
<li><p><strong>Magnetoencephalography (MEG)</strong>: Magnetic fields generated by neural activity</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>

<span class="k">def</span><span class="w"> </span><span class="nf">simulate_neural_signals</span><span class="p">(</span><span class="n">signal_type</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate different types of neural signals</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    signal_type : str</span>
<span class="sd">        Type of neural signal to simulate</span>
<span class="sd">        Options: &quot;Spikes&quot;, &quot;LFP&quot;, &quot;ECoG&quot;, &quot;EEG&quot;, &quot;fNIRS&quot;</span>
<span class="sd">    duration : float</span>
<span class="sd">        Duration of the signal in seconds</span>
<span class="sd">    sampling_rate : int</span>
<span class="sd">        Sampling rate in Hz</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    times : numpy.ndarray</span>
<span class="sd">        Time points</span>
<span class="sd">    signal_data : numpy.ndarray</span>
<span class="sd">        Simulated neural signal</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">sampling_rate</span><span class="p">)</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
    <span class="n">signal_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">signal_type</span> <span class="o">==</span> <span class="s2">&quot;Spikes&quot;</span><span class="p">:</span>
        <span class="c1"># Simulate Poisson spike train</span>
        <span class="n">firing_rate</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Hz</span>
        <span class="n">spike_prob</span> <span class="o">=</span> <span class="n">firing_rate</span> <span class="o">/</span> <span class="n">sampling_rate</span>
        <span class="n">spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">spike_prob</span>
        <span class="n">signal_data</span> <span class="o">=</span> <span class="n">spikes</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        
    <span class="k">elif</span> <span class="n">signal_type</span> <span class="o">==</span> <span class="s2">&quot;LFP&quot;</span><span class="p">:</span>
        <span class="c1"># Simulate LFP with theta and gamma components</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">times</span><span class="p">)</span>  <span class="c1"># 6 Hz theta</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">40</span> <span class="o">*</span> <span class="n">times</span><span class="p">)</span>  <span class="c1"># 40 Hz gamma</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
        <span class="n">signal_data</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">+</span> <span class="n">noise</span>
        
    <span class="k">elif</span> <span class="n">signal_type</span> <span class="o">==</span> <span class="s2">&quot;ECoG&quot;</span><span class="p">:</span>
        <span class="c1"># Simulate ECoG with multiple frequency components</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">times</span><span class="p">)</span>  <span class="c1"># 10 Hz alpha</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">times</span><span class="p">)</span>  <span class="c1"># 20 Hz beta</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">times</span><span class="p">)</span>  <span class="c1"># 50 Hz gamma</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
        <span class="n">signal_data</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">+</span> <span class="n">noise</span>
        
    <span class="k">elif</span> <span class="n">signal_type</span> <span class="o">==</span> <span class="s2">&quot;EEG&quot;</span><span class="p">:</span>
        <span class="c1"># Simulate EEG with alpha oscillations</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">times</span><span class="p">)</span>  <span class="c1"># 10 Hz alpha</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
        <span class="n">signal_data</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">noise</span>
        
    <span class="k">elif</span> <span class="n">signal_type</span> <span class="o">==</span> <span class="s2">&quot;fNIRS&quot;</span><span class="p">:</span>
        <span class="c1"># Simulate hemodynamic response</span>
        <span class="c1"># Create a canonical hemodynamic response function (HRF)</span>
        <span class="n">hrf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
        <span class="n">stim_onset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">sampling_rate</span><span class="p">)</span>  <span class="c1"># Stimulus at 100ms</span>
        <span class="n">hrf_model</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">times</span><span class="p">[:</span><span class="mi">500</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">times</span><span class="p">[:</span><span class="mi">500</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">hrf</span><span class="p">[</span><span class="n">stim_onset</span><span class="p">:</span><span class="n">stim_onset</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">hrf_model</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">hrf_model</span>
        <span class="n">signal_data</span> <span class="o">=</span> <span class="n">hrf</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">times</span><span class="p">,</span> <span class="n">signal_data</span>

<span class="c1"># Example usage</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_neural_signals</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot examples of different neural signal types&quot;&quot;&quot;</span>
    <span class="n">signal_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Spikes&quot;</span><span class="p">,</span> <span class="s2">&quot;LFP&quot;</span><span class="p">,</span> <span class="s2">&quot;ECoG&quot;</span><span class="p">,</span> <span class="s2">&quot;EEG&quot;</span><span class="p">,</span> <span class="s2">&quot;fNIRS&quot;</span><span class="p">]</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">signal_types</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sig_type</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">signal_types</span><span class="p">):</span>
        <span class="n">times</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">simulate_neural_signals</span><span class="p">(</span><span class="n">sig_type</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sig_type</span><span class="si">}</span><span class="s2"> Signal&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="bci-technologies-and-approaches">
<h2>17.3 BCI Technologies and Approaches<a class="headerlink" href="#bci-technologies-and-approaches" title="Link to this heading">#</a></h2>
<section id="invasive-bcis">
<h3>17.3.1 Invasive BCIs<a class="headerlink" href="#invasive-bcis" title="Link to this heading">#</a></h3>
<p>Invasive BCIs involve surgical implantation of recording devices directly into or onto the brain tissue. These systems provide high temporal and spatial resolution but carry surgical risks.</p>
<p>Key invasive BCI approaches include:</p>
<ul class="simple">
<li><p><strong>Microelectrode Arrays</strong>: Arrays of tiny electrodes that record from individual neurons</p></li>
<li><p><strong>ECoG Grids</strong>: Flexible electrode arrays placed on the cortical surface</p></li>
<li><p><strong>Stentrodes</strong>: Electrodes delivered via blood vessels</p></li>
</ul>
<p><strong>Clinical Applications</strong>:</p>
<ul class="simple">
<li><p>Motor restoration for paralysis</p></li>
<li><p>Communication for locked-in syndrome</p></li>
<li><p>Sensory restoration (e.g., visual or auditory prostheses)</p></li>
</ul>
</section>
<section id="non-invasive-bcis">
<h3>17.3.2 Non-invasive BCIs<a class="headerlink" href="#non-invasive-bcis" title="Link to this heading">#</a></h3>
<p>Non-invasive BCIs record brain activity without requiring surgery. While safer, they typically have lower spatial resolution and signal-to-noise ratio.</p>
<p>Key non-invasive BCI approaches include:</p>
<ul class="simple">
<li><p><strong>EEG-based BCIs</strong>: Record electrical activity from the scalp</p></li>
<li><p><strong>fNIRS BCIs</strong>: Measure blood oxygenation changes</p></li>
<li><p><strong>MEG-based BCIs</strong>: Detect magnetic fields generated by neural activity</p></li>
</ul>
<p><strong>Applications</strong>:</p>
<ul class="simple">
<li><p>Assistive technology for disabilities</p></li>
<li><p>Neurorehabilitation</p></li>
<li><p>Cognitive enhancement</p></li>
<li><p>Gaming and entertainment</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.discriminant_analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearDiscriminantAnalysis</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="k">class</span><span class="w"> </span><span class="nc">EEG_BCI</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A basic EEG-based Brain-Computer Interface using motor imagery</span>
<span class="sd">    </span>
<span class="sd">    This class implements a simple BCI that can classify imagined movements</span>
<span class="sd">    from EEG signals using common spatial patterns (CSP) and LDA</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_channels</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">250</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the EEG-BCI system</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        n_channels : int</span>
<span class="sd">            Number of EEG channels</span>
<span class="sd">        sampling_rate : int</span>
<span class="sd">            Sampling rate in Hz</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span> <span class="o">=</span> <span class="n">n_channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">sampling_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="n">LinearDiscriminantAnalysis</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">csp_filters</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_components</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Number of CSP components to use</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_bandpass_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">low_freq</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">high_freq</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply a bandpass filter to the EEG data</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        data : numpy.ndarray</span>
<span class="sd">            EEG data of shape (n_trials, n_channels, n_samples)</span>
<span class="sd">        low_freq : float</span>
<span class="sd">            Lower cutoff frequency</span>
<span class="sd">        high_freq : float</span>
<span class="sd">            Upper cutoff frequency</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        filtered_data : numpy.ndarray</span>
<span class="sd">            Filtered EEG data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">butter</span><span class="p">,</span> <span class="n">filtfilt</span>
        
        <span class="n">nyquist</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span>
        <span class="n">low</span> <span class="o">=</span> <span class="n">low_freq</span> <span class="o">/</span> <span class="n">nyquist</span>
        <span class="n">high</span> <span class="o">=</span> <span class="n">high_freq</span> <span class="o">/</span> <span class="n">nyquist</span>
        
        <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">butter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">],</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;band&#39;</span><span class="p">)</span>
        
        <span class="n">n_trials</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_channels</span><span class="p">):</span>
                <span class="n">filtered_data</span><span class="p">[</span><span class="n">trial</span><span class="p">,</span> <span class="n">channel</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">trial</span><span class="p">,</span> <span class="n">channel</span><span class="p">])</span>
                
        <span class="k">return</span> <span class="n">filtered_data</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_compute_csp_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute Common Spatial Pattern filters</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        X_train : numpy.ndarray</span>
<span class="sd">            Training data of shape (n_trials, n_channels, n_samples)</span>
<span class="sd">        y_train : numpy.ndarray</span>
<span class="sd">            Training labels</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        W : numpy.ndarray</span>
<span class="sd">            CSP projection matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_trials</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span>
        
        <span class="c1"># Class covariance matrices</span>
        <span class="n">cov_matrices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">))</span>
        
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>  <span class="c1"># Assuming binary classification</span>
            <span class="n">class_trials</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="n">y_train</span> <span class="o">==</span> <span class="n">c</span><span class="p">]</span>
            
            <span class="c1"># Compute trial covariance matrices</span>
            <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="n">class_trials</span><span class="p">:</span>
                <span class="c1"># Normalize by trace to account for scale differences</span>
                <span class="n">trial_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span>
                <span class="n">trial_cov</span> <span class="o">=</span> <span class="n">trial_cov</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">trial_cov</span><span class="p">)</span>
                <span class="n">cov_matrices</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="n">trial_cov</span>
                
            <span class="n">cov_matrices</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">class_trials</span><span class="p">)</span>
            
        <span class="c1"># Solve the generalized eigenvalue problem</span>
        <span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">cov_matrices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">@</span> <span class="n">cov_matrices</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="c1"># Sort by eigenvalues in descending order</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">evals</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">evals</span> <span class="o">=</span> <span class="n">evals</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">evecs</span> <span class="o">=</span> <span class="n">evecs</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span>
        
        <span class="c1"># Select projection matrix W</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">csp_filters</span> <span class="o">=</span> <span class="n">evecs</span>
        
        <span class="k">return</span> <span class="n">evecs</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_csp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply CSP transformation to the data</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        data : numpy.ndarray</span>
<span class="sd">            EEG data of shape (n_trials, n_channels, n_samples)</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        features : numpy.ndarray</span>
<span class="sd">            CSP features</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_trials</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_trials</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_components</span><span class="p">))</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
            <span class="c1"># Project data onto CSP filters</span>
            <span class="n">projected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">csp_filters</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            
            <span class="c1"># Compute log-variance of selected components</span>
            <span class="n">selected_components</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span>
                <span class="n">projected</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_components</span><span class="p">],</span> 
                <span class="n">projected</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">n_components</span><span class="p">:]</span>
            <span class="p">])</span>
            
            <span class="n">variances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">selected_components</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">variances</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">features</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Train the BCI system</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        X_train : numpy.ndarray</span>
<span class="sd">            Training data of shape (n_trials, n_channels, n_samples)</span>
<span class="sd">        y_train : numpy.ndarray</span>
<span class="sd">            Training labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Apply bandpass filter</span>
        <span class="n">X_filtered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_bandpass_filter</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        
        <span class="c1"># Compute CSP filters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_compute_csp_filters</span><span class="p">(</span><span class="n">X_filtered</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        
        <span class="c1"># Extract features</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_csp</span><span class="p">(</span><span class="n">X_filtered</span><span class="p">)</span>
        
        <span class="c1"># Scale features</span>
        <span class="n">scaled_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        
        <span class="c1"># Train classifier</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_features</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_test</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict classes for new data</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        X_test : numpy.ndarray</span>
<span class="sd">            Test data of shape (n_trials, n_channels, n_samples)</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        y_pred : numpy.ndarray</span>
<span class="sd">            Predicted labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Apply bandpass filter</span>
        <span class="n">X_filtered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_bandpass_filter</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        
        <span class="c1"># Extract features</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_csp</span><span class="p">(</span><span class="n">X_filtered</span><span class="p">)</span>
        
        <span class="c1"># Scale features</span>
        <span class="n">scaled_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        
        <span class="c1"># Predict</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">scaled_features</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="neural-decoding-approaches">
<h3>17.3.3 Neural Decoding Approaches<a class="headerlink" href="#neural-decoding-approaches" title="Link to this heading">#</a></h3>
<p>Neural decoding is the process of translating brain activity patterns into meaningful control signals. Modern BCIs employ diverse decoding approaches:</p>
<ul class="simple">
<li><p><strong>Classification-based</strong>: Identify discrete mental states or commands</p></li>
<li><p><strong>Regression-based</strong>: Estimate continuous parameters (e.g., limb position)</p></li>
<li><p><strong>Deep learning</strong>: Extract hierarchical features from neural data</p></li>
<li><p><strong>Dynamical systems</strong>: Model temporal evolution of neural states</p></li>
</ul>
</section>
</section>
<section id="ai-enhanced-bcis">
<h2>17.4 AI-Enhanced BCIs<a class="headerlink" href="#ai-enhanced-bcis" title="Link to this heading">#</a></h2>
<section id="machine-learning-for-neural-decoding">
<h3>17.4.1 Machine Learning for Neural Decoding<a class="headerlink" href="#machine-learning-for-neural-decoding" title="Link to this heading">#</a></h3>
<p>AI methods have dramatically improved BCI performance by enhancing neural decoding:</p>
<ul class="simple">
<li><p><strong>Adaptive decoders</strong>: ML systems that learn from user behavior</p></li>
<li><p><strong>Transfer learning</strong>: Leverage knowledge across sessions and users</p></li>
<li><p><strong>Self-supervised learning</strong>: Utilize unlabeled neural data</p></li>
<li><p><strong>Reinforcement learning</strong>: Optimize decoding through trial and error</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Conv2D</span><span class="p">,</span> <span class="n">MaxPooling2D</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">LSTM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.optimizers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Adam</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DeepBCI</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deep learning-based BCI decoder for EEG signals</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_channels</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">time_steps</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">model_type</span><span class="o">=</span><span class="s1">&#39;CNN&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the deep BCI decoder</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        n_channels : int</span>
<span class="sd">            Number of EEG channels</span>
<span class="sd">        time_steps : int</span>
<span class="sd">            Number of time steps in each trial</span>
<span class="sd">        n_classes : int</span>
<span class="sd">            Number of output classes</span>
<span class="sd">        model_type : str</span>
<span class="sd">            Type of deep learning model to use (&#39;CNN&#39;, &#39;LSTM&#39;, or &#39;Hybrid&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span> <span class="o">=</span> <span class="n">n_channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_steps</span> <span class="o">=</span> <span class="n">time_steps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="n">n_classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_type</span> <span class="o">=</span> <span class="n">model_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_model</span><span class="p">()</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">_build_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build the deep learning model</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        model : tf.keras.Model</span>
<span class="sd">            The compiled deep learning model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;CNN&#39;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
                <span class="c1"># Reshape input to add channel dimension: (channels, time_steps) -&gt; (channels, time_steps, 1)</span>
                <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
                                        <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_steps</span><span class="p">)),</span>
                
                <span class="c1"># First convolutional block</span>
                <span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
                <span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
                <span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
                <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
                
                <span class="c1"># Second convolutional block</span>
                <span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
                <span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
                <span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
                <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
                
                <span class="c1"># Flatten and dense layers</span>
                <span class="n">Flatten</span><span class="p">(),</span>
                <span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
                <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
                <span class="n">Dense</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)</span>
            <span class="p">])</span>
            
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;LSTM&#39;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
                <span class="c1"># Reshape input: (channels, time_steps) -&gt; (time_steps, channels)</span>
                <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Permute</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_steps</span><span class="p">)),</span>
                
                <span class="c1"># LSTM layers</span>
                <span class="n">LSTM</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
                <span class="n">LSTM</span><span class="p">(</span><span class="mi">64</span><span class="p">),</span>
                <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.25</span><span class="p">),</span>
                
                <span class="c1"># Output layer</span>
                <span class="n">Dense</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)</span>
            <span class="p">])</span>
            
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_type</span> <span class="o">==</span> <span class="s1">&#39;Hybrid&#39;</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
                <span class="c1"># Reshape input to add channel dimension: (channels, time_steps) -&gt; (channels, time_steps, 1)</span>
                <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Reshape</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> 
                                        <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_steps</span><span class="p">)),</span>
                
                <span class="c1"># Convolutional layers</span>
                <span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
                <span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
                <span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">),</span>
                <span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
                
                <span class="c1"># Reshape for LSTM: (channels/4, time_steps/4, 64) -&gt; (channels/4, time_steps/4 * 64)</span>
                <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">int_shape</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> 
                                        <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">int_shape</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))[</span><span class="mi">3</span><span class="p">])),</span>
                
                <span class="c1"># LSTM layer</span>
                <span class="n">LSTM</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span>
                <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
                
                <span class="c1"># Output layer</span>
                <span class="n">Dense</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)</span>
            <span class="p">])</span>
        
        <span class="c1"># Compile the model</span>
        <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
            <span class="n">optimizer</span><span class="o">=</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span>
            <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span>
            <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="k">return</span> <span class="n">model</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">validation_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Train the deep BCI model</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        X_train : numpy.ndarray</span>
<span class="sd">            Training data of shape (n_trials, n_channels, time_steps)</span>
<span class="sd">        y_train : numpy.ndarray</span>
<span class="sd">            Training labels (one-hot encoded)</span>
<span class="sd">        batch_size : int</span>
<span class="sd">            Batch size for training</span>
<span class="sd">        epochs : int</span>
<span class="sd">            Number of training epochs</span>
<span class="sd">        validation_data : tuple</span>
<span class="sd">            (X_val, y_val) for validation</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        history : tf.keras.callbacks.History</span>
<span class="sd">            Training history</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
            <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
            <span class="n">validation_data</span><span class="o">=</span><span class="n">validation_data</span><span class="p">,</span>
            <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span>
                <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict classes for new data</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        X : numpy.ndarray</span>
<span class="sd">            EEG data of shape (n_trials, n_channels, time_steps)</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        y_pred : numpy.ndarray</span>
<span class="sd">            Predicted class probabilities</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">predict_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict class labels for new data</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        X : numpy.ndarray</span>
<span class="sd">            EEG data of shape (n_trials, n_channels, time_steps)</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        y_pred : numpy.ndarray</span>
<span class="sd">            Predicted class labels</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">probs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">probs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="adaptive-and-learning-systems">
<h3>17.4.2 Adaptive and Learning Systems<a class="headerlink" href="#adaptive-and-learning-systems" title="Link to this heading">#</a></h3>
<p>Modern BCIs employ co-adaptation, where both the user and the system learn to optimize performance:</p>
<ul class="simple">
<li><p><strong>Error-related potentials</strong>: Leverage error signals for adaptive decoding</p></li>
<li><p><strong>Online learning</strong>: Continuous adaptation during use</p></li>
<li><p><strong>Active inference</strong>: BCIs that model user intentions</p></li>
<li><p><strong>Hybrid BCI-AI systems</strong>: Combine neural signals with contextual AI</p></li>
</ul>
</section>
<section id="neural-feedback-and-closed-loop-systems">
<h3>17.4.3 Neural Feedback and Closed-Loop Systems<a class="headerlink" href="#neural-feedback-and-closed-loop-systems" title="Link to this heading">#</a></h3>
<p>Closed-loop BCIs provide real-time feedback to users, enabling neural adaptation:</p>
<ul class="simple">
<li><p><strong>Neurofeedback</strong>: Visual, auditory, or haptic feedback of neural states</p></li>
<li><p><strong>Stimulation-based BCIs</strong>: Systems that both record and stimulate</p></li>
<li><p><strong>Shared control</strong>: Collaborative control between user and AI</p></li>
<li><p><strong>Sensory augmentation</strong>: Providing novel sensory inputs</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ClosedLoopBCI</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Closed-loop BCI system with neurofeedback</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_channels</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">buffer_duration</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the closed-loop BCI</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        n_channels : int</span>
<span class="sd">            Number of EEG channels</span>
<span class="sd">        sampling_rate : int</span>
<span class="sd">            Sampling rate in Hz</span>
<span class="sd">        buffer_duration : float</span>
<span class="sd">            Duration of the signal buffer in seconds</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span> <span class="o">=</span> <span class="n">n_channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">sampling_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">buffer_duration</span> <span class="o">*</span> <span class="n">sampling_rate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signal_buffer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_channels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span><span class="p">))</span>
        
        <span class="c1"># Signal processing parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">band_filters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;theta&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
            <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
            <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
            <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="c1"># Feedback parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_band</span> <span class="o">=</span> <span class="s1">&#39;alpha&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_channels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>  <span class="c1"># e.g., O1 and O2 for alpha training</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseline_power</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feedback_scale</span> <span class="o">=</span> <span class="mf">1.0</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">update_buffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the signal buffer with new data</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        new_data : numpy.ndarray</span>
<span class="sd">            New EEG data of shape (n_channels, n_samples)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_samples</span> <span class="o">=</span> <span class="n">new_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">n_samples</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span><span class="p">:</span>
            <span class="c1"># If new data exceeds buffer size, just take the most recent samples</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signal_buffer</span> <span class="o">=</span> <span class="n">new_data</span><span class="p">[:,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Shift buffer and add new data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signal_buffer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">signal_buffer</span><span class="p">[:,</span> <span class="n">n_samples</span><span class="p">:],</span>
                <span class="n">new_data</span>
            <span class="p">])</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">apply_bandpass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">band</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply bandpass filter to the signal buffer</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        band : str</span>
<span class="sd">            Frequency band (&#39;theta&#39;, &#39;alpha&#39;, &#39;beta&#39;, or &#39;gamma&#39;)</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        filtered : numpy.ndarray</span>
<span class="sd">            Filtered signal</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">low_freq</span><span class="p">,</span> <span class="n">high_freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">band_filters</span><span class="p">[</span><span class="n">band</span><span class="p">]</span>
        
        <span class="c1"># Design filter</span>
        <span class="n">nyquist</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span>
        <span class="n">low</span> <span class="o">=</span> <span class="n">low_freq</span> <span class="o">/</span> <span class="n">nyquist</span>
        <span class="n">high</span> <span class="o">=</span> <span class="n">high_freq</span> <span class="o">/</span> <span class="n">nyquist</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">],</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;band&#39;</span><span class="p">)</span>
        
        <span class="c1"># Apply filter to each channel</span>
        <span class="n">filtered</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">signal_buffer</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">):</span>
            <span class="n">filtered</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal_buffer</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            
        <span class="k">return</span> <span class="n">filtered</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_band_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">band</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute power in a specific frequency band</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        band : str</span>
<span class="sd">            Frequency band (&#39;theta&#39;, &#39;alpha&#39;, &#39;beta&#39;, or &#39;gamma&#39;)</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        powers : numpy.ndarray</span>
<span class="sd">            Band power for each channel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filtered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_bandpass</span><span class="p">(</span><span class="n">band</span><span class="p">)</span>
        
        <span class="c1"># Compute power (variance of filtered signal)</span>
        <span class="n">powers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">filtered</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">powers</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">calibrate_baseline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">60.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calibrate baseline band power over a period</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        duration : float</span>
<span class="sd">            Duration of calibration in seconds</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting baseline calibration for </span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s2"> seconds...&quot;</span><span class="p">)</span>
        <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span><span class="p">)</span>
        
        <span class="n">baseline_powers</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">):</span>
            <span class="c1"># This would normally get data from the EEG device</span>
            <span class="c1"># Here we&#39;ll simulate it</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_buffer</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
            
            <span class="n">powers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_band_power</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_band</span><span class="p">)</span>
            <span class="n">baseline_powers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">powers</span><span class="p">)</span>
            
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">baseline_power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">baseline_powers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Baseline calibration complete!&quot;</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_feedback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute feedback based on current brain activity</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        feedback : float</span>
<span class="sd">            Feedback value (positive values indicate above baseline)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get current band power</span>
        <span class="n">current_power</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_band_power</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_band</span><span class="p">)</span>
        
        <span class="c1"># Compute relative change from baseline for target channels</span>
        <span class="n">target_channels_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_channels</span><span class="p">)</span>
        <span class="n">relative_power</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_power</span><span class="p">[</span><span class="n">target_channels_idx</span><span class="p">]</span> <span class="o">/</span> 
                          <span class="bp">self</span><span class="o">.</span><span class="n">baseline_power</span><span class="p">[</span><span class="n">target_channels_idx</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
        
        <span class="c1"># Average across target channels</span>
        <span class="n">feedback</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">relative_power</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">feedback_scale</span>
        
        <span class="k">return</span> <span class="n">feedback</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">run_neurofeedback_session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">feedback_func</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run a neurofeedback session</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        duration : float</span>
<span class="sd">            Duration of the session in seconds</span>
<span class="sd">        feedback_func : callable</span>
<span class="sd">            Function to call with feedback value to provide feedback</span>
<span class="sd">            If None, will print feedback value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_power</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Baseline not calibrated. Running calibration...&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calibrate_baseline</span><span class="p">()</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting neurofeedback session for </span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s2"> seconds...&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Target band: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_band</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="n">session_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">feedback_values</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">session_start</span> <span class="o">&lt;</span> <span class="n">duration</span><span class="p">:</span>
            <span class="c1"># This would normally get data from the EEG device</span>
            <span class="c1"># Here we&#39;ll simulate it with random data</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_buffer</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
            
            <span class="c1"># Compute feedback</span>
            <span class="n">feedback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_feedback</span><span class="p">()</span>
            <span class="n">feedback_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feedback</span><span class="p">)</span>
            
            <span class="c1"># Provide feedback</span>
            <span class="k">if</span> <span class="n">feedback_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">feedback_func</span><span class="p">(</span><span class="n">feedback</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Simple text-based feedback</span>
                <span class="n">bar_length</span> <span class="o">=</span> <span class="mi">30</span>
                <span class="n">bar_position</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">feedback</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">bar_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">bar</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="n">bar_position</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">bar_length</span> <span class="o">-</span> <span class="n">bar_position</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">Feedback: [</span><span class="si">{</span><span class="n">bar</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">feedback</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Neurofeedback session complete!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">feedback_values</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="human-ai-interaction-via-neural-interfaces">
<h2>17.5 Human-AI Interaction via Neural Interfaces<a class="headerlink" href="#human-ai-interaction-via-neural-interfaces" title="Link to this heading">#</a></h2>
<section id="bci-as-a-communication-channel">
<h3>17.5.1 BCI as a Communication Channel<a class="headerlink" href="#bci-as-a-communication-channel" title="Link to this heading">#</a></h3>
<p>BCIs offer unique interaction modalities between humans and AI systems:</p>
<ul class="simple">
<li><p><strong>Direct intention transfer</strong>: Communicate intentions without physical action</p></li>
<li><p><strong>Mental command interfaces</strong>: Control AI assistants through thought</p></li>
<li><p><strong>Emotional and cognitive state monitoring</strong>: AI adaptation to user state</p></li>
<li><p><strong>Shared representations</strong>: Neural-symbolic interfaces between humans and AI</p></li>
</ul>
</section>
<section id="neural-interfaces-for-ai-agents">
<h3>17.5.2 Neural Interfaces for AI Agents<a class="headerlink" href="#neural-interfaces-for-ai-agents" title="Link to this heading">#</a></h3>
<p>Neural interfaces enable novel forms of human-AI collaboration:</p>
<ul class="simple">
<li><p><strong>BCI-integrated virtual assistants</strong>: AI agents controlled via neural signals</p></li>
<li><p><strong>Embodied AI with neural interfaces</strong>: Controlling robots through thought</p></li>
<li><p><strong>Collaborative problem-solving</strong>: AI systems that augment human cognition</p></li>
<li><p><strong>Neural interfaces for skill acquisition</strong>: AI-guided learning via BCI feedback</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>

<span class="k">class</span><span class="w"> </span><span class="nc">CommandType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">NAVIGATE</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">SELECT</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">CONFIRM</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">CANCEL</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">HELP</span> <span class="o">=</span> <span class="mi">4</span>

<span class="k">class</span><span class="w"> </span><span class="nc">NeuroAIAssistant</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An AI assistant that interfaces with users through a BCI</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bci</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the NeuroAI Assistant</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        bci : BrainComputerInterface</span>
<span class="sd">            The BCI system to use for neural input</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bci</span> <span class="o">=</span> <span class="n">bci</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">available_commands</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">CommandType</span><span class="o">.</span><span class="n">NAVIGATE</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;up&quot;</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">,</span> <span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">],</span>
            <span class="n">CommandType</span><span class="o">.</span><span class="n">SELECT</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;option1&quot;</span><span class="p">,</span> <span class="s2">&quot;option2&quot;</span><span class="p">,</span> <span class="s2">&quot;option3&quot;</span><span class="p">],</span>
            <span class="n">CommandType</span><span class="o">.</span><span class="n">CONFIRM</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;yes&quot;</span><span class="p">],</span>
            <span class="n">CommandType</span><span class="o">.</span><span class="n">CANCEL</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;no&quot;</span><span class="p">],</span>
            <span class="n">CommandType</span><span class="o">.</span><span class="n">HELP</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;help&quot;</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_state</span> <span class="o">=</span> <span class="s2">&quot;main_menu&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_transitions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;main_menu&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;option1&quot;</span><span class="p">:</span> <span class="s2">&quot;feature1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;option2&quot;</span><span class="p">:</span> <span class="s2">&quot;feature2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;option3&quot;</span><span class="p">:</span> <span class="s2">&quot;feature3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;help&quot;</span><span class="p">:</span> <span class="s2">&quot;help_menu&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;feature1&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;yes&quot;</span><span class="p">:</span> <span class="s2">&quot;feature1_action&quot;</span><span class="p">,</span>
                <span class="s2">&quot;no&quot;</span><span class="p">:</span> <span class="s2">&quot;main_menu&quot;</span>
            <span class="p">},</span>
            <span class="c1"># ... more state transitions</span>
        <span class="p">}</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">decode_neural_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">neural_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Decode neural signals into commands</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        neural_data : numpy.ndarray</span>
<span class="sd">            Neural data from the BCI</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        command_type : CommandType</span>
<span class="sd">            Type of command</span>
<span class="sd">        command : str</span>
<span class="sd">            Specific command</span>
<span class="sd">        confidence : float</span>
<span class="sd">            Confidence in the decoded command (0-1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bci</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Simulate decoding if no BCI is connected</span>
            <span class="n">command_type</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">CommandType</span><span class="p">))</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">available_commands</span><span class="p">[</span><span class="n">command_type</span><span class="p">])</span>
            <span class="n">confidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Use the BCI to decode the command</span>
            <span class="n">decoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bci</span><span class="o">.</span><span class="n">process_neural_data</span><span class="p">(</span><span class="n">neural_data</span><span class="p">)</span>
            <span class="n">command_type</span> <span class="o">=</span> <span class="n">decoded</span><span class="p">[</span><span class="s2">&quot;command_type&quot;</span><span class="p">]</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">decoded</span><span class="p">[</span><span class="s2">&quot;command&quot;</span><span class="p">]</span>
            <span class="n">confidence</span> <span class="o">=</span> <span class="n">decoded</span><span class="p">[</span><span class="s2">&quot;confidence&quot;</span><span class="p">]</span>
            
        <span class="k">return</span> <span class="n">command_type</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">confidence</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">execute_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command_type</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">confidence</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Execute a decoded command</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        command_type : CommandType</span>
<span class="sd">            Type of command</span>
<span class="sd">        command : str</span>
<span class="sd">            Specific command</span>
<span class="sd">        confidence : float</span>
<span class="sd">            Confidence in the decoded command</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        response : str</span>
<span class="sd">            Response to the command</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Log the command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span>
            <span class="s2">&quot;command_type&quot;</span><span class="p">:</span> <span class="n">command_type</span><span class="p">,</span>
            <span class="s2">&quot;command&quot;</span><span class="p">:</span> <span class="n">command</span><span class="p">,</span>
            <span class="s2">&quot;confidence&quot;</span><span class="p">:</span> <span class="n">confidence</span><span class="p">,</span>
            <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_state</span>
        <span class="p">})</span>
        
        <span class="c1"># Execute command based on current state</span>
        <span class="k">if</span> <span class="n">confidence</span> <span class="o">&lt;</span> <span class="mf">0.7</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Low confidence (</span><span class="si">{</span><span class="n">confidence</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">). Please try again.&quot;</span>
        
        <span class="k">if</span> <span class="n">command_type</span> <span class="o">==</span> <span class="n">CommandType</span><span class="o">.</span><span class="n">HELP</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_provide_help</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">command</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_transitions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_state</span><span class="p">,</span> <span class="p">{}):</span>
            <span class="n">next_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_transitions</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current_state</span><span class="p">][</span><span class="n">command</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_state</span> <span class="o">=</span> <span class="n">next_state</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Executing </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2">. Moved to </span><span class="si">{</span><span class="n">next_state</span><span class="si">}</span><span class="s2">.&quot;</span>
        
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Command </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2"> not available in current state </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_state</span><span class="si">}</span><span class="s2">.&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_provide_help</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Provide help based on current state&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_state</span> <span class="o">==</span> <span class="s2">&quot;main_menu&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;You are in the main menu. Available options: option1, option2, option3&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_state</span> <span class="o">==</span> <span class="s2">&quot;feature1&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;You are in feature1. Confirm with &#39;yes&#39; or go back with &#39;no&#39;&quot;</span>
        <span class="c1"># ... help for other states</span>
        
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;You are in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_state</span><span class="si">}</span><span class="s2">. Please try a navigation command.&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">run_interactive_session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run an interactive session with the user</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        duration : float</span>
<span class="sd">            Duration of the session in seconds</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting NeuroAI Assistant session for </span><span class="si">{</span><span class="n">duration</span><span class="si">}</span><span class="s2"> seconds...&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current state: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="n">session_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        
        <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">session_start</span> <span class="o">&lt;</span> <span class="n">duration</span><span class="p">:</span>
            <span class="c1"># This would normally get data from the BCI</span>
            <span class="c1"># Here we&#39;ll simulate it</span>
            <span class="n">neural_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># Example dimensions</span>
            
            <span class="c1"># Decode neural command</span>
            <span class="n">command_type</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">confidence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode_neural_command</span><span class="p">(</span><span class="n">neural_data</span><span class="p">)</span>
            
            <span class="c1"># If confidence is high enough, execute the command</span>
            <span class="k">if</span> <span class="n">confidence</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">(</span><span class="n">command_type</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">confidence</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Decoded: </span><span class="si">{</span><span class="n">command_type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">command</span><span class="si">}</span><span class="s2"> (conf: </span><span class="si">{</span><span class="n">confidence</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Response: </span><span class="si">{</span><span class="n">response</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current state: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">current_state</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Wait between command attempts</span>
            
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">NeuroAI Assistant session complete!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">command_history</span>
</pre></div>
</div>
</section>
</section>
<section id="practical-applications-and-case-studies">
<h2>17.6 Practical Applications and Case Studies<a class="headerlink" href="#practical-applications-and-case-studies" title="Link to this heading">#</a></h2>
<section id="clinical-applications">
<h3>17.6.1 Clinical Applications<a class="headerlink" href="#clinical-applications" title="Link to this heading">#</a></h3>
<p>BCIs are transforming clinical care for various conditions:</p>
<ul class="simple">
<li><p><strong>Motor restoration</strong>: BCIs that restore movement for paralysis</p></li>
<li><p><strong>Communication devices</strong>: BCIs for locked-in syndrome and ALS</p></li>
<li><p><strong>Cognitive rehabilitation</strong>: BCIs for stroke and traumatic brain injury</p></li>
<li><p><strong>Mental health interventions</strong>: BCIs for depression and anxiety disorders</p></li>
</ul>
<section id="advanced-paralysis-treatment-with-bcis">
<h4>17.6.1.1 Advanced Paralysis Treatment with BCIs<a class="headerlink" href="#advanced-paralysis-treatment-with-bcis" title="Link to this heading">#</a></h4>
<p>BCIs show particular promise for treating paralysis by bypassing damaged neural pathways, creating new connections between the brain and limbs or assistive devices:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MotorDecoderBCI</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Motor decoder for restoring movement in paralysis patients</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_channels</span><span class="o">=</span><span class="mi">96</span><span class="p">,</span> <span class="n">n_dof</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">adaptation_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize motor decoder BCI system</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        n_channels : int</span>
<span class="sd">            Number of neural recording channels</span>
<span class="sd">        n_dof : int</span>
<span class="sd">            Degrees of freedom for control (e.g., 7 for full arm movement)</span>
<span class="sd">        adaptation_rate : float</span>
<span class="sd">            Rate of decoder adaptation to user intent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span> <span class="o">=</span> <span class="n">n_channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_dof</span> <span class="o">=</span> <span class="n">n_dof</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adaptation_rate</span> <span class="o">=</span> <span class="n">adaptation_rate</span>
        
        <span class="c1"># Initialize Kalman filter parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_dof</span><span class="p">)</span>  <span class="c1"># State transition model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_dof</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span>  <span class="c1"># Process noise covariance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_channels</span><span class="p">,</span> <span class="n">n_dof</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span>  <span class="c1"># Observation model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_channels</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>  <span class="c1"># Observation noise covariance</span>
        
        <span class="c1"># Current state estimate and covariance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_dof</span><span class="p">)</span>  <span class="c1"># Current state estimate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_dof</span><span class="p">)</span>  <span class="c1"># State estimate covariance</span>
        
        <span class="c1"># Adaptation parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adaptation_buffer</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span> <span class="o">=</span> <span class="mi">100</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">decode_movement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">neural_activity</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Decode movement intentions from neural activity</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        neural_activity : numpy.ndarray</span>
<span class="sd">            Neural activity array [n_channels]</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        movement : numpy.ndarray</span>
<span class="sd">            Decoded movement commands [n_dof]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Prediction step</span>
        <span class="n">x_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="n">P_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">W</span>
        
        <span class="c1"># Update step</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">P_pred</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> 
                  <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="n">P_pred</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x_pred</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">(</span><span class="n">neural_activity</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="n">x_pred</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P_pred</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">),</span> <span class="n">P_pred</span><span class="p">)</span>
        
        <span class="c1"># Apply constraints (e.g., joint limits, velocity limits)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">update_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">neural_activity</span><span class="p">,</span> <span class="n">intended_movement</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update decoder model based on intended movement</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        neural_activity : numpy.ndarray</span>
<span class="sd">            Neural activity array [n_channels]</span>
<span class="sd">        intended_movement : numpy.ndarray</span>
<span class="sd">            Intended movement vector [n_dof]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Add to adaptation buffer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adaptation_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">neural_activity</span><span class="p">,</span> <span class="n">intended_movement</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adaptation_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer_size</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">adaptation_buffer</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="c1"># If enough data, update observation model</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adaptation_buffer</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
            <span class="c1"># Extract data from buffer</span>
            <span class="n">neural_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptation_buffer</span><span class="p">])</span>
            <span class="n">movement_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptation_buffer</span><span class="p">])</span>
            
            <span class="c1"># Update observation model (H) using regression</span>
            <span class="n">H_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_dof</span><span class="p">):</span>
                <span class="c1"># Ridge regression for each DoF</span>
                <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Ridge</span>
                <span class="n">model</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
                <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">neural_data</span><span class="p">,</span> <span class="n">movement_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
                <span class="n">H_new</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span>
            
            <span class="c1"># Blend new and old models</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptation_rate</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptation_rate</span> <span class="o">*</span> <span class="n">H_new</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">simulate_control</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recording_time</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">target_positions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulate BCI control of prosthetic device</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        recording_time : float</span>
<span class="sd">            Simulation time in seconds</span>
<span class="sd">        sampling_rate : int</span>
<span class="sd">            Neural data sampling rate in Hz</span>
<span class="sd">        target_positions : list of numpy.ndarray</span>
<span class="sd">            List of target positions to reach</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        performance_metrics : dict</span>
<span class="sd">            Dictionary of performance metrics</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">recording_time</span> <span class="o">*</span> <span class="n">sampling_rate</span><span class="p">)</span>
        
        <span class="c1"># Default targets if not provided</span>
        <span class="k">if</span> <span class="n">target_positions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">target_positions</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>  <span class="c1"># Example target position</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="p">]</span>
        
        <span class="c1"># Initialize trajectory tracking</span>
        <span class="n">trajectory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_samples</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_dof</span><span class="p">))</span>
        <span class="n">current_target_idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">current_target</span> <span class="o">=</span> <span class="n">target_positions</span><span class="p">[</span><span class="n">current_target_idx</span><span class="p">]</span>
        <span class="n">target_reached_times</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Run simulation</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">):</span>
            <span class="c1"># Current time in seconds</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">i</span> <span class="o">/</span> <span class="n">sampling_rate</span>
            
            <span class="c1"># Generate simulated neural activity based on intention to reach target</span>
            <span class="c1"># In a real system, this would be recorded neural data</span>
            <span class="n">direction_to_target</span> <span class="o">=</span> <span class="n">current_target</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
            <span class="n">distance_to_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">direction_to_target</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>  <span class="c1"># Position components</span>
            
            <span class="c1"># Check if target reached</span>
            <span class="k">if</span> <span class="n">distance_to_target</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
                <span class="n">target_reached_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="n">current_target_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_target_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_positions</span><span class="p">)</span>
                <span class="n">current_target</span> <span class="o">=</span> <span class="n">target_positions</span><span class="p">[</span><span class="n">current_target_idx</span><span class="p">]</span>
                <span class="n">direction_to_target</span> <span class="o">=</span> <span class="n">current_target</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
            
            <span class="c1"># Simulate neural activity encoding movement direction</span>
            <span class="n">neural_activity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="n">direction_to_target</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.3</span>
            
            <span class="c1"># Decode movement command</span>
            <span class="n">decoded_movement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">decode_movement</span><span class="p">(</span><span class="n">neural_activity</span><span class="p">)</span>
            
            <span class="c1"># Update model (closed-loop learning)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Update every 10 samples</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_model</span><span class="p">(</span><span class="n">neural_activity</span><span class="p">,</span> <span class="n">direction_to_target</span><span class="p">)</span>
            
            <span class="c1"># Store trajectory</span>
            <span class="n">trajectory</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        
        <span class="c1"># Calculate performance metrics</span>
        <span class="n">avg_time_to_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">target_reached_times</span><span class="p">))</span> <span class="k">if</span> <span class="n">target_reached_times</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
        <span class="n">n_targets_reached</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_reached_times</span><span class="p">)</span>
        
        <span class="n">performance_metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;avg_time_to_target&#39;</span><span class="p">:</span> <span class="n">avg_time_to_target</span><span class="p">,</span>
            <span class="s1">&#39;n_targets_reached&#39;</span><span class="p">:</span> <span class="n">n_targets_reached</span><span class="p">,</span>
            <span class="s1">&#39;trajectory&#39;</span><span class="p">:</span> <span class="n">trajectory</span><span class="p">,</span>
            <span class="s1">&#39;target_reached_times&#39;</span><span class="p">:</span> <span class="n">target_reached_times</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">performance_metrics</span>
</pre></div>
</div>
<p>Clinical impact of motor BCIs:</p>
<ol class="arabic simple">
<li><p><strong>Spinal Cord Injury Treatment</strong>:
BCIs enable patients with spinal cord injuries to control robotic limbs, exoskeletons, or even their own limbs through electrical stimulation systems. Recent clinical trials have demonstrated the restoration of functional arm and hand movement in tetraplegic patients using cortical implants connected to muscle stimulation systems.</p></li>
<li><p><strong>Stroke Rehabilitation</strong>:
BCI-assisted rehabilitation accelerates motor recovery by strengthening neural pathways. By combining mental motor imagery with physical feedback, BCIs create a closed-loop system that enhances neuroplasticity and promotes motor relearning in stroke-affected limbs.</p></li>
<li><p><strong>Progressive Neuromuscular Disease Management</strong>:
For patients with progressive conditions like ALS, BCIs provide increasingly critical support as the disease advances. Early intervention with non-invasive BCIs for communication can transition to more advanced systems for controlling wheelchairs, home environments, and eventually full robotic assistance.</p></li>
<li><p><strong>Neuroprosthetic Integration</strong>:
Advanced sensorimotor BCIs provide both motor control and sensory feedback, creating a bidirectional interface with prosthetic limbs. The addition of sensory feedback through direct neural stimulation dramatically improves prosthetic control precision and enhances embodiment of the artificial limb.</p></li>
</ol>
</section>
<section id="communication-systems-for-locked-in-syndrome">
<h4>17.6.1.2 Communication Systems for Locked-in Syndrome<a class="headerlink" href="#communication-systems-for-locked-in-syndrome" title="Link to this heading">#</a></h4>
<p>For patients with locked-in syndrome who retain cognitive function but lack motor control, BCIs provide critical communication capabilities:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BCICommunicator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    BCI-based communication system for patients with severe motor impairments</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface_type</span><span class="o">=</span><span class="s2">&quot;P300&quot;</span><span class="p">,</span> <span class="n">vocabulary_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">adaptive</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize BCI communication system</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        interface_type : str</span>
<span class="sd">            Type of BCI paradigm (&#39;P300&#39;, &#39;SSVEP&#39;, &#39;Motor_Imagery&#39;)</span>
<span class="sd">        vocabulary_size : int</span>
<span class="sd">            Number of words/phrases in the system vocabulary</span>
<span class="sd">        adaptive : bool</span>
<span class="sd">            Whether to use adaptive algorithms that learn user patterns</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interface_type</span> <span class="o">=</span> <span class="n">interface_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span> <span class="o">=</span> <span class="n">adaptive</span>
        
        <span class="c1"># Initialize vocabulary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_vocabulary</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_core_vocabulary</span><span class="p">(</span><span class="n">vocabulary_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_vocabulary</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Personalized vocabulary with usage stats</span>
        
        <span class="c1"># Interface-specific parameters</span>
        <span class="k">if</span> <span class="n">interface_type</span> <span class="o">==</span> <span class="s2">&quot;P300&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flash_duration</span> <span class="o">=</span> <span class="mf">0.125</span>  <span class="c1"># seconds</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">isi</span> <span class="o">=</span> <span class="mf">0.125</span>  <span class="c1"># Inter-stimulus interval</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequence_length</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Number of flashes per item</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_p300_classifier</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">interface_type</span> <span class="o">==</span> <span class="s2">&quot;SSVEP&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># Hz</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_ssvep_classifier</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">interface_type</span> <span class="o">==</span> <span class="s2">&quot;Motor_Imagery&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mental_actions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="s2">&quot;up&quot;</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">,</span> <span class="s2">&quot;select&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_mi_classifier</span><span class="p">()</span>
        
        <span class="c1"># Communication metrics</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">communication_rate</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Characters per minute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_accuracy</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Accuracy of selections</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_history</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Adaptive parameters</span>
        <span class="k">if</span> <span class="n">adaptive</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">adaptation_rate</span> <span class="o">=</span> <span class="mf">0.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_history</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_core_vocabulary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate core vocabulary of common words/phrases&quot;&quot;&quot;</span>
        <span class="c1"># In a real system, this would be a proper core vocabulary</span>
        <span class="c1"># Here we&#39;ll just use placeholder entries</span>
        <span class="n">vocabulary</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;basic_needs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;water&quot;</span><span class="p">,</span> <span class="s2">&quot;food&quot;</span><span class="p">,</span> <span class="s2">&quot;bathroom&quot;</span><span class="p">,</span> <span class="s2">&quot;pain&quot;</span><span class="p">,</span> <span class="s2">&quot;position&quot;</span><span class="p">,</span> <span class="s2">&quot;cold&quot;</span><span class="p">,</span> <span class="s2">&quot;hot&quot;</span><span class="p">],</span>
            <span class="s1">&#39;people&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;doctor&quot;</span><span class="p">,</span> <span class="s2">&quot;nurse&quot;</span><span class="p">,</span> <span class="s2">&quot;family&quot;</span><span class="p">,</span> <span class="s2">&quot;spouse&quot;</span><span class="p">,</span> <span class="s2">&quot;children&quot;</span><span class="p">],</span>
            <span class="s1">&#39;responses&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span> <span class="s2">&quot;maybe&quot;</span><span class="p">,</span> <span class="s2">&quot;later&quot;</span><span class="p">,</span> <span class="s2">&quot;thank you&quot;</span><span class="p">,</span> <span class="s2">&quot;help&quot;</span><span class="p">],</span>
            <span class="s1">&#39;medical&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;medication&quot;</span><span class="p">,</span> <span class="s2">&quot;uncomfortable&quot;</span><span class="p">,</span> <span class="s2">&quot;breathing&quot;</span><span class="p">,</span> <span class="s2">&quot;suction&quot;</span><span class="p">],</span>
            <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;morning&quot;</span><span class="p">,</span> <span class="s2">&quot;afternoon&quot;</span><span class="p">,</span> <span class="s2">&quot;evening&quot;</span><span class="p">,</span> <span class="s2">&quot;night&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">],</span>
            <span class="s1">&#39;alphabet&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span><span class="p">),</span>
            <span class="s1">&#39;numbers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">vocabulary</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_p300_classifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a P300 classifier&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.discriminant_analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearDiscriminantAnalysis</span>
        <span class="k">return</span> <span class="n">LinearDiscriminantAnalysis</span><span class="p">()</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_ssvep_classifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize an SSVEP classifier&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVC</span>
        <span class="k">return</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_initialize_mi_classifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a motor imagery classifier&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestClassifier</span>
        <span class="k">return</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">simulate_p300_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_item</span><span class="p">,</span> <span class="n">n_items</span><span class="o">=</span><span class="mi">36</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulate P300 speller selection process</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        target_item : int</span>
<span class="sd">            Index of the target item</span>
<span class="sd">        n_items : int</span>
<span class="sd">            Total number of items in the display</span>
<span class="sd">        noise_level : float</span>
<span class="sd">            Level of noise in the EEG signal</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        selected_item : int</span>
<span class="sd">            Index of the selected item</span>
<span class="sd">        confidence : float</span>
<span class="sd">            Confidence in the selection</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Simulate a sequence of flashes</span>
        <span class="n">n_sequences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequence_length</span>
        <span class="n">flash_order</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">item_flashes</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_items</span><span class="p">)}</span>
        
        <span class="n">p300_responses</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sequences</span><span class="p">):</span>
            <span class="c1"># Generate random flash order (row/column for P300 speller)</span>
            <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_items</span><span class="p">))</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
            <span class="n">flash_order</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                <span class="n">item_flashes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                
                <span class="c1"># Simulate EEG response</span>
                <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="n">target_item</span><span class="p">:</span>
                    <span class="c1"># Target flash produces P300 (with noise)</span>
                    <span class="n">p300_response</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span> <span class="o">*</span> <span class="n">noise_level</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Non-target flash</span>
                    <span class="n">p300_response</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span> <span class="o">*</span> <span class="n">noise_level</span>
                
                <span class="n">p300_responses</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">item</span><span class="p">,</span> <span class="n">p300_response</span><span class="p">))</span>
        
        <span class="c1"># Aggregate P300 responses by item</span>
        <span class="n">item_scores</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_items</span><span class="p">)}</span>
        <span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">p300_responses</span><span class="p">:</span>
            <span class="n">item_scores</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">+=</span> <span class="n">response</span>
        
        <span class="c1"># Normalize by number of flashes per item</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">item_scores</span><span class="p">:</span>
            <span class="n">item_scores</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">/=</span> <span class="n">item_flashes</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
        
        <span class="c1"># Select item with highest score</span>
        <span class="n">selected_item</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">item_scores</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">item_scores</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
        <span class="n">max_score</span> <span class="o">=</span> <span class="n">item_scores</span><span class="p">[</span><span class="n">selected_item</span><span class="p">]</span>
        
        <span class="c1"># Calculate a confidence metric</span>
        <span class="n">sorted_scores</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">item_scores</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">confidence</span> <span class="o">=</span> <span class="p">(</span><span class="n">sorted_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">sorted_scores</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">sorted_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">selected_item</span><span class="p">,</span> <span class="n">confidence</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">update_classifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eeg_data</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update classifier with new labeled data</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        eeg_data : numpy.ndarray</span>
<span class="sd">            EEG data from recent selections</span>
<span class="sd">        target : int or str</span>
<span class="sd">            Target class/item</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># In a real system, this would update the classifier with new data</span>
        <span class="c1"># For simulation, we&#39;ll just assume the classifier improves over time</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">noise_reduction</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_reduction</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">predict_next_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_context</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict next likely items based on user history</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        current_context : str</span>
<span class="sd">            Current text or context</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        predictions : list</span>
<span class="sd">            List of likely next selections</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># This would use language modeling in a real system</span>
        <span class="c1"># For now, return some default predictions</span>
        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;thank&quot;</span><span class="p">,</span> <span class="s2">&quot;you&quot;</span><span class="p">,</span> <span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;no&quot;</span><span class="p">]</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">simulate_communication_session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_phrase</span><span class="p">,</span> <span class="n">session_duration</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulate a communication session</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        target_phrase : str</span>
<span class="sd">            Phrase the user wants to communicate</span>
<span class="sd">        session_duration : int</span>
<span class="sd">            Session duration in seconds</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        metrics : dict</span>
<span class="sd">            Performance metrics for the session</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">target_phrase</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">output_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">selection_times</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">accuracies</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="n">time_elapsed</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">word_idx</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Simulate selection process</span>
        <span class="k">while</span> <span class="n">time_elapsed</span> <span class="o">&lt;</span> <span class="n">session_duration</span> <span class="ow">and</span> <span class="n">word_idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">):</span>
            <span class="n">target_word</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="n">word_idx</span><span class="p">]</span>
            
            <span class="c1"># Find word in vocabulary or spell it</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">target_word</span> <span class="ow">in</span> <span class="n">category</span> <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_vocabulary</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="c1"># Word is in vocabulary, select it directly</span>
                <span class="n">selection_time</span> <span class="o">=</span> <span class="mf">5.0</span>  <span class="c1"># Average time to select a word</span>
                <span class="n">selection_accuracy</span> <span class="o">=</span> <span class="mf">0.9</span>  <span class="c1"># High accuracy for direct selection</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Need to spell the word letter by letter</span>
                <span class="n">selection_time</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_word</span><span class="p">)</span> <span class="o">*</span> <span class="mf">8.0</span>  <span class="c1"># Time to spell</span>
                <span class="n">selection_accuracy</span> <span class="o">=</span> <span class="mf">0.85</span> <span class="o">**</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_word</span><span class="p">)</span>  <span class="c1"># Compound accuracy</span>
            
            <span class="c1"># Account for adaptive improvements</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span><span class="p">:</span>
                <span class="c1"># Improve speed and accuracy over time</span>
                <span class="n">experience_factor</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span> <span class="o">/</span> <span class="mf">50.0</span><span class="p">)</span>
                <span class="n">selection_time</span> <span class="o">*=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">experience_factor</span><span class="p">)</span>
                <span class="n">selection_accuracy</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">selection_accuracy</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">experience_factor</span><span class="p">)</span>
            
            <span class="c1"># Update metrics</span>
            <span class="n">time_elapsed</span> <span class="o">+=</span> <span class="n">selection_time</span>
            <span class="k">if</span> <span class="n">time_elapsed</span> <span class="o">&lt;=</span> <span class="n">session_duration</span><span class="p">:</span>
                <span class="n">output_text</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">target_word</span> <span class="k">if</span> <span class="n">output_text</span> <span class="k">else</span> <span class="n">target_word</span>
                <span class="n">selections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target_word</span><span class="p">)</span>
                <span class="n">selection_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selection_time</span><span class="p">)</span>
                <span class="n">accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selection_accuracy</span><span class="p">)</span>
                <span class="n">word_idx</span> <span class="o">+=</span> <span class="mi">1</span>
                
                <span class="c1"># Simulate adaptive updates</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">user_vocabulary</span><span class="p">[</span><span class="n">target_word</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_vocabulary</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">target_word</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        
        <span class="c1"># Calculate metrics</span>
        <span class="n">total_characters</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">selections</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">selection_times</span><span class="p">:</span>
            <span class="n">chars_per_minute</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_characters</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">selection_times</span><span class="p">))</span> <span class="o">*</span> <span class="mi">60</span>
            <span class="n">avg_accuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chars_per_minute</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">avg_accuracy</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;output_text&#39;</span><span class="p">:</span> <span class="n">output_text</span><span class="p">,</span>
            <span class="s1">&#39;target_phrase&#39;</span><span class="p">:</span> <span class="n">target_phrase</span><span class="p">,</span>
            <span class="s1">&#39;completion_ratio&#39;</span><span class="p">:</span> <span class="n">word_idx</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">),</span>
            <span class="s1">&#39;chars_per_minute&#39;</span><span class="p">:</span> <span class="n">chars_per_minute</span><span class="p">,</span>
            <span class="s1">&#39;average_accuracy&#39;</span><span class="p">:</span> <span class="n">avg_accuracy</span><span class="p">,</span>
            <span class="s1">&#39;total_time&#39;</span><span class="p">:</span> <span class="n">time_elapsed</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">metrics</span>
</pre></div>
</div>
<p>Clinical impact of communication BCIs:</p>
<ol class="arabic simple">
<li><p><strong>Complete Locked-In Syndrome (CLIS) Communication</strong>:
For patients with CLIS who cannot communicate through any voluntary movement, BCIs offer the only pathway for communication. Recent advances have enabled reliable yes/no communication even in CLIS patients using fNIRS and EEG-based BCIs.</p></li>
<li><p><strong>ALS Progression Support</strong>:
BCI systems can adapt to the progression of ALS, starting with eye-tracking when oculomotor control is preserved and transitioning to neural interfaces as the disease advances. This provides continuity of communication ability throughout disease progression.</p></li>
<li><p><strong>Acute Care Communication</strong>:
For temporarily intubated or ventilated patients who cannot speak, rapid-deployment BCIs provide critical communication capabilities in intensive care settings, reducing patient distress and improving clinical decision-making.</p></li>
<li><p><strong>Quality of Life Enhancement</strong>:
Beyond basic needs, modern BCI communication systems support rich expression including emotion communication, environmental control, and social media access, significantly enhancing quality of life for locked-in patients.</p></li>
</ol>
</section>
<section id="neurorehabilitation-for-stroke-recovery">
<h4>17.6.1.3 Neurorehabilitation for Stroke Recovery<a class="headerlink" href="#neurorehabilitation-for-stroke-recovery" title="Link to this heading">#</a></h4>
<p>BCIs are proving valuable for stroke rehabilitation by engaging neural plasticity mechanisms:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">NeurorehabilitionBCI</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    BCI system for stroke rehabilitation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_function</span><span class="o">=</span><span class="s2">&quot;upper_limb&quot;</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="s2">&quot;MI_FES&quot;</span><span class="p">,</span> <span class="n">sessions_planned</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize neurorehabilitation BCI</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        target_function : str</span>
<span class="sd">            Target function to rehabilitate (&#39;upper_limb&#39;, &#39;lower_limb&#39;, &#39;speech&#39;)</span>
<span class="sd">        protocol : str</span>
<span class="sd">            Rehabilitation protocol (&#39;MI_FES&#39;, &#39;EEG_Robot&#39;, &#39;Closed_Loop&#39;)</span>
<span class="sd">        sessions_planned : int</span>
<span class="sd">            Number of planned rehabilitation sessions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_function</span> <span class="o">=</span> <span class="n">target_function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span> <span class="o">=</span> <span class="n">protocol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sessions_planned</span> <span class="o">=</span> <span class="n">sessions_planned</span>
        
        <span class="c1"># Patient state tracking</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseline_assessment</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_session</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="c1"># Adaptive difficulty parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">success_threshold</span> <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1"># Success rate threshold for increasing difficulty</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">difficulty</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Current difficulty level (1-10)</span>
        
        <span class="c1"># Rehabilitation protocol parameters</span>
        <span class="k">if</span> <span class="n">protocol</span> <span class="o">==</span> <span class="s2">&quot;MI_FES&quot;</span><span class="p">:</span>
            <span class="c1"># Motor Imagery with Functional Electrical Stimulation</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mi_detection_threshold</span> <span class="o">=</span> <span class="mf">0.6</span>  <span class="c1"># Threshold for detecting motor imagery</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stimulation_intensity</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># mA</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stimulation_duration</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># seconds</span>
        <span class="k">elif</span> <span class="n">protocol</span> <span class="o">==</span> <span class="s2">&quot;EEG_Robot&quot;</span><span class="p">:</span>
            <span class="c1"># EEG-controlled robotic assistance</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assistance_level</span> <span class="o">=</span> <span class="mf">0.8</span>  <span class="c1"># 80% assistance</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">movement_velocity</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># normalized</span>
        <span class="k">elif</span> <span class="n">protocol</span> <span class="o">==</span> <span class="s2">&quot;Closed_Loop&quot;</span><span class="p">:</span>
            <span class="c1"># Closed-loop BCI with multimodal feedback</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">feedback_modalities</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;visual&quot;</span><span class="p">,</span> <span class="s2">&quot;tactile&quot;</span><span class="p">,</span> <span class="s2">&quot;auditory&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">adaptation_rate</span> <span class="o">=</span> <span class="mf">0.1</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">assess_patient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clinical_scores</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Record baseline assessment and track progress</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        clinical_scores : dict</span>
<span class="sd">            Dictionary of clinical assessment scores</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        summary : dict</span>
<span class="sd">            Summary of patient status</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_assessment</span><span class="p">:</span>
            <span class="c1"># First assessment becomes baseline</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">baseline_assessment</span> <span class="o">=</span> <span class="n">clinical_scores</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        
        <span class="c1"># Calculate improvement from baseline</span>
        <span class="n">improvement</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">measure</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">clinical_scores</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">measure</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_assessment</span><span class="p">:</span>
                <span class="n">baseline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_assessment</span><span class="p">[</span><span class="n">measure</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                    <span class="n">improvement</span><span class="p">[</span><span class="n">measure</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">score</span> <span class="o">-</span> <span class="n">baseline</span><span class="p">)</span> <span class="o">/</span> <span class="n">baseline</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        
        <span class="n">summary</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;current_scores&#39;</span><span class="p">:</span> <span class="n">clinical_scores</span><span class="p">,</span>
            <span class="s1">&#39;baseline&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_assessment</span><span class="p">,</span>
            <span class="s1">&#39;improvement_percentage&#39;</span><span class="p">:</span> <span class="n">improvement</span><span class="p">,</span>
            <span class="s1">&#39;sessions_completed&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_session</span><span class="p">,</span>
            <span class="s1">&#39;difficulty_level&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">difficulty</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">summary</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">detect_motor_imagery</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eeg_data</span><span class="p">,</span> <span class="n">target_movement</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect motor imagery from EEG data</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        eeg_data : numpy.ndarray</span>
<span class="sd">            EEG data array</span>
<span class="sd">        target_movement : str</span>
<span class="sd">            Target movement being imagined</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        detection : dict</span>
<span class="sd">            Detection results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># In a real system, this would implement proper MI detection</span>
        <span class="c1"># Here we&#39;ll simulate detection with random success based on difficulty</span>
        
        <span class="c1"># Success probability decreases with difficulty</span>
        <span class="n">base_success_prob</span> <span class="o">=</span> <span class="mf">0.9</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">difficulty</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.05</span>
        
        <span class="c1"># Simulate detection</span>
        <span class="n">is_detected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">base_success_prob</span>
        <span class="n">confidence</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_detected</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        
        <span class="n">detection</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;movement_detected&#39;</span><span class="p">:</span> <span class="n">is_detected</span><span class="p">,</span>
            <span class="s1">&#39;target_movement&#39;</span><span class="p">:</span> <span class="n">target_movement</span><span class="p">,</span>
            <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="n">confidence</span><span class="p">,</span>
            <span class="s1">&#39;latency&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>  <span class="c1"># seconds</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">detection</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">deliver_neurofeedback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">detection_result</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deliver appropriate neurofeedback based on detection result</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        detection_result : dict</span>
<span class="sd">            Result from motor imagery detection</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        feedback : dict</span>
<span class="sd">            Feedback delivered to patient</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">feedback</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;modalities&#39;</span><span class="p">:</span> <span class="p">[]}</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span> <span class="o">==</span> <span class="s2">&quot;MI_FES&quot;</span> <span class="ow">and</span> <span class="n">detection_result</span><span class="p">[</span><span class="s1">&#39;movement_detected&#39;</span><span class="p">]:</span>
            <span class="c1"># Deliver electrical stimulation</span>
            <span class="n">feedback</span><span class="p">[</span><span class="s1">&#39;modalities&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;electrical_stimulation&#39;</span><span class="p">)</span>
            <span class="n">feedback</span><span class="p">[</span><span class="s1">&#39;stimulation_intensity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stimulation_intensity</span>
            <span class="n">feedback</span><span class="p">[</span><span class="s1">&#39;stimulation_duration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stimulation_duration</span>
            
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span> <span class="o">==</span> <span class="s2">&quot;EEG_Robot&quot;</span><span class="p">:</span>
            <span class="c1"># Control robotic assistance</span>
            <span class="n">assistance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assistance_level</span>
            <span class="k">if</span> <span class="n">detection_result</span><span class="p">[</span><span class="s1">&#39;movement_detected&#39;</span><span class="p">]:</span>
                <span class="c1"># Reduce assistance if movement detected successfully</span>
                <span class="n">assistance</span> <span class="o">*=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">detection_result</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">])</span>
            
            <span class="n">feedback</span><span class="p">[</span><span class="s1">&#39;modalities&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;robotic_assistance&#39;</span><span class="p">)</span>
            <span class="n">feedback</span><span class="p">[</span><span class="s1">&#39;assistance_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">assistance</span>
            <span class="n">feedback</span><span class="p">[</span><span class="s1">&#39;movement_velocity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">movement_velocity</span>
            
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span> <span class="o">==</span> <span class="s2">&quot;Closed_Loop&quot;</span><span class="p">:</span>
            <span class="c1"># Multimodal feedback</span>
            <span class="k">if</span> <span class="n">detection_result</span><span class="p">[</span><span class="s1">&#39;movement_detected&#39;</span><span class="p">]:</span>
                <span class="n">feedback</span><span class="p">[</span><span class="s1">&#39;modalities&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;visual&#39;</span><span class="p">)</span>
                <span class="n">feedback</span><span class="p">[</span><span class="s1">&#39;visual_feedback&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;success&quot;</span>
                
                <span class="k">if</span> <span class="n">detection_result</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">:</span>
                    <span class="n">feedback</span><span class="p">[</span><span class="s1">&#39;modalities&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;tactile&#39;</span><span class="p">)</span>
                    <span class="n">feedback</span><span class="p">[</span><span class="s1">&#39;tactile_feedback&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;vibration&quot;</span>
                    
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">difficulty</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                        <span class="n">feedback</span><span class="p">[</span><span class="s1">&#39;modalities&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;auditory&#39;</span><span class="p">)</span>
                        <span class="n">feedback</span><span class="p">[</span><span class="s1">&#39;auditory_feedback&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;success_tone&quot;</span>
        
        <span class="k">return</span> <span class="n">feedback</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">run_training_session</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run a complete rehabilitation training session</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        -----------</span>
<span class="sd">        n_trials : int</span>
<span class="sd">            Number of training trials in the session</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        session_results : dict</span>
<span class="sd">            Results and metrics from the session</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize session metrics</span>
        <span class="n">successful_trials</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">trial_results</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Determine target movements based on function</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_function</span> <span class="o">==</span> <span class="s2">&quot;upper_limb&quot;</span><span class="p">:</span>
            <span class="n">movements</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;hand_open&quot;</span><span class="p">,</span> <span class="s2">&quot;hand_close&quot;</span><span class="p">,</span> <span class="s2">&quot;wrist_extension&quot;</span><span class="p">,</span> <span class="s2">&quot;elbow_flexion&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_function</span> <span class="o">==</span> <span class="s2">&quot;lower_limb&quot;</span><span class="p">:</span>
            <span class="n">movements</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ankle_flexion&quot;</span><span class="p">,</span> <span class="s2">&quot;knee_extension&quot;</span><span class="p">,</span> <span class="s2">&quot;hip_flexion&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">movements</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;tongue_movement&quot;</span><span class="p">,</span> <span class="s2">&quot;lip_pursing&quot;</span><span class="p">]</span>
        
        <span class="c1"># Run trials</span>
        <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
            <span class="c1"># Select random target movement</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">movements</span><span class="p">)</span>
            
            <span class="c1"># Simulate EEG data</span>
            <span class="n">eeg_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>  <span class="c1"># 64 channels, 512 timepoints</span>
            
            <span class="c1"># Detect motor imagery</span>
            <span class="n">detection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_motor_imagery</span><span class="p">(</span><span class="n">eeg_data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
            
            <span class="c1"># Deliver feedback</span>
            <span class="n">feedback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deliver_neurofeedback</span><span class="p">(</span><span class="n">detection</span><span class="p">)</span>
            
            <span class="c1"># Track success</span>
            <span class="k">if</span> <span class="n">detection</span><span class="p">[</span><span class="s1">&#39;movement_detected&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">detection</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">mi_detection_threshold</span><span class="p">:</span>
                <span class="n">successful_trials</span> <span class="o">+=</span> <span class="mi">1</span>
            
            <span class="c1"># Store trial result</span>
            <span class="n">trial_results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;trial&#39;</span><span class="p">:</span> <span class="n">trial</span><span class="p">,</span>
                <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="n">target</span><span class="p">,</span>
                <span class="s1">&#39;detection&#39;</span><span class="p">:</span> <span class="n">detection</span><span class="p">,</span>
                <span class="s1">&#39;feedback&#39;</span><span class="p">:</span> <span class="n">feedback</span>
            <span class="p">})</span>
        
        <span class="c1"># Calculate success rate</span>
        <span class="n">success_rate</span> <span class="o">=</span> <span class="n">successful_trials</span> <span class="o">/</span> <span class="n">n_trials</span>
        
        <span class="c1"># Adjust difficulty for next session</span>
        <span class="k">if</span> <span class="n">success_rate</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">success_threshold</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">difficulty</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">difficulty</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">success_rate</span> <span class="o">&lt;</span> <span class="mf">0.3</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">difficulty</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">difficulty</span> <span class="o">-=</span> <span class="mi">1</span>
        
        <span class="c1"># Update session history</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_session</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">session_summary</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;session&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_session</span><span class="p">,</span>
            <span class="s1">&#39;trials&#39;</span><span class="p">:</span> <span class="n">n_trials</span><span class="p">,</span>
            <span class="s1">&#39;success_rate&#39;</span><span class="p">:</span> <span class="n">success_rate</span><span class="p">,</span>
            <span class="s1">&#39;successful_trials&#39;</span><span class="p">:</span> <span class="n">successful_trials</span><span class="p">,</span>
            <span class="s1">&#39;difficulty&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">difficulty</span><span class="p">,</span>
            <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="p">,</span>
            <span class="s1">&#39;trial_details&#39;</span><span class="p">:</span> <span class="n">trial_results</span>
        <span class="p">}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">session_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">session_summary</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">session_summary</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">predict_recovery_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict recovery trajectory based on session history</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        --------</span>
<span class="sd">        prediction : dict</span>
<span class="sd">            Predicted recovery outcomes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_history</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Insufficient session data for prediction&quot;</span><span class="p">}</span>
        
        <span class="c1"># Extract success rates from completed sessions</span>
        <span class="n">success_rates</span> <span class="o">=</span> <span class="p">[</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;success_rate&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">session</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">session_history</span><span class="p">]</span>
        
        <span class="c1"># Simple linear regression to predict future success rates</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
        
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">success_rates</span><span class="p">)))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">success_rates</span><span class="p">)</span>
        
        <span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        
        <span class="c1"># Predict future sessions</span>
        <span class="n">remaining_sessions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sessions_planned</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_session</span>
        <span class="n">future_sessions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_session</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sessions_planned</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">predicted_rates</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">future_sessions</span><span class="p">)</span>
        
        <span class="c1"># Estimate functional improvement</span>
        <span class="c1"># This is highly simplified - real prediction would be much more complex</span>
        <span class="n">current_improvement</span> <span class="o">=</span> <span class="n">success_rates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">success_rates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">success_rates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">1.0</span>
        <span class="n">rate_of_improvement</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">success_rates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">success_rates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        
        <span class="n">estimated_functional_gain</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">current_improvement</span> <span class="o">+</span> <span class="n">rate_of_improvement</span> <span class="o">*</span> <span class="n">remaining_sessions</span><span class="p">)</span>
        
        <span class="n">prediction</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;completed_sessions&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_session</span><span class="p">,</span>
            <span class="s1">&#39;remaining_sessions&#39;</span><span class="p">:</span> <span class="n">remaining_sessions</span><span class="p">,</span>
            <span class="s1">&#39;current_success_rate&#39;</span><span class="p">:</span> <span class="n">success_rates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;predicted_final_success_rate&#39;</span><span class="p">:</span> <span class="n">predicted_rates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">predicted_rates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">success_rates</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;estimated_functional_improvement&#39;</span><span class="p">:</span> <span class="n">estimated_functional_gain</span><span class="p">,</span>
            <span class="s1">&#39;success_rate_trajectory&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">predicted_rates</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">prediction</span>
</pre></div>
</div>
<p>Clinical impact of neurorehabilitation BCIs:</p>
<ol class="arabic simple">
<li><p><strong>Enhanced Neuroplasticity</strong>:
BCI-triggered functional electrical stimulation creates a tight temporal association between motor intent and sensory feedback, strengthening neural pathways through Hebbian plasticity mechanisms. Studies show 25-30% greater motor improvement with BCI rehabilitation compared to conventional therapy alone.</p></li>
<li><p><strong>Engaging Partially Damaged Pathways</strong>:
For patients with incomplete spinal cord injuries or stroke, BCIs can detect even weak motor signals and amplify them through assistive devices, actively engaging and strengthening partially damaged neural pathways that might otherwise remain dormant.</p></li>
<li><p><strong>Maintaining Neural Circuits</strong>:
In early post-stroke rehabilitation, BCIs help maintain motor circuit functionality during the period when direct movement is impossible, preventing the maladaptive plasticity and circuit deterioration that typically occurs during prolonged disuse.</p></li>
<li><p><strong>Customized Rehabilitation Protocols</strong>:
AI-enhanced BCIs can adapt difficulty levels, identify optimal training targets, and provide precisely calibrated assistance based on real-time neural signals, creating highly personalized rehabilitation protocols that maximize recovery potential.</p></li>
</ol>
</section>
<section id="treatment-resistant-depression-therapy">
<h4>17.6.1.4 Treatment-Resistant Depression Therapy<a class="headerlink" href="#treatment-resistant-depression-therapy" title="Link to this heading">#</a></h4>
<p>Emerging applications of BCIs include treatment of psychiatric conditions like depression:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">simulate_depression_neurofeedback</span><span class="p">(</span><span class="n">n_sessions</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">session_duration</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> 
                                     <span class="n">patient_profile</span><span class="o">=</span><span class="s2">&quot;treatment_resistant&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate a neurofeedback BCI protocol for depression treatment</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    n_sessions : int</span>
<span class="sd">        Number of treatment sessions</span>
<span class="sd">    session_duration : int</span>
<span class="sd">        Duration of each session in minutes</span>
<span class="sd">    patient_profile : str</span>
<span class="sd">        Patient characteristics (&#39;treatment_resistant&#39;, &#39;moderate&#39;, &#39;mild&#39;)</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    results : dict</span>
<span class="sd">        Simulated treatment results</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
    
    <span class="c1"># Set response parameters based on patient profile</span>
    <span class="k">if</span> <span class="n">patient_profile</span> <span class="o">==</span> <span class="s2">&quot;treatment_resistant&quot;</span><span class="p">:</span>
        <span class="n">baseline_severity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>  <span class="c1"># HDRS score</span>
        <span class="n">max_improvement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Maximum possible improvement</span>
        <span class="n">response_delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>  <span class="c1"># Sessions before response</span>
    <span class="k">elif</span> <span class="n">patient_profile</span> <span class="o">==</span> <span class="s2">&quot;moderate&quot;</span><span class="p">:</span>
        <span class="n">baseline_severity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">max_improvement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
        <span class="n">response_delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># mild</span>
        <span class="n">baseline_severity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">max_improvement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>
        <span class="n">response_delay</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    
    <span class="c1"># Generate response curve</span>
    <span class="n">sessions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_sessions</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">severity_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_sessions</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">severity_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">baseline_severity</span>
    
    <span class="c1"># Simulate neurofeedback learning curve</span>
    <span class="n">alpha_power_increase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_sessions</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_sessions</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># Simulate alpha power regulation (target for depression treatment)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">response_delay</span><span class="p">:</span>
            <span class="c1"># Minimal improvement during delay period</span>
            <span class="n">learning_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># More substantial improvement after delay</span>
            <span class="n">progress</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">response_delay</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_sessions</span> <span class="o">-</span> <span class="n">response_delay</span><span class="p">)</span>
            <span class="n">learning_factor</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">progress</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
        
        <span class="c1"># Add randomness to learning process</span>
        <span class="n">daily_variation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
        
        <span class="c1"># Calculate alpha power increase (normalized 0-1)</span>
        <span class="n">alpha_power_increase</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">alpha_power_increase</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> 
                                     <span class="n">learning_factor</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">+</span> <span class="n">daily_variation</span><span class="p">)</span>
        
        <span class="c1"># Calculate clinical improvement</span>
        <span class="n">clinical_improvement</span> <span class="o">=</span> <span class="n">alpha_power_increase</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">max_improvement</span>
        
        <span class="c1"># Update severity score</span>
        <span class="n">severity_scores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">baseline_severity</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">clinical_improvement</span><span class="p">)</span>
    
    <span class="c1"># Determine clinical outcome</span>
    <span class="n">final_score</span> <span class="o">=</span> <span class="n">severity_scores</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">final_score</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">:</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="s2">&quot;Remission&quot;</span>
    <span class="k">elif</span> <span class="n">final_score</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">baseline_severity</span><span class="p">:</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="s2">&quot;Response&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="s2">&quot;Partial Response&quot;</span>
    
    <span class="c1"># Calculate percent reduction</span>
    <span class="n">percent_reduction</span> <span class="o">=</span> <span class="p">(</span><span class="n">baseline_severity</span> <span class="o">-</span> <span class="n">final_score</span><span class="p">)</span> <span class="o">/</span> <span class="n">baseline_severity</span> <span class="o">*</span> <span class="mi">100</span>
    
    <span class="c1"># Plot results</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sessions</span><span class="p">,</span> <span class="n">severity_scores</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Remission Threshold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">baseline_severity</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> 
               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Response Threshold&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Depression Severity (HDRS)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Depression Treatment Outcome: </span><span class="si">{</span><span class="n">outcome</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">percent_reduction</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">% reduction)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sessions</span><span class="p">,</span> <span class="n">alpha_power_increase</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized Alpha Power Increase&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Session Number&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    
    <span class="c1"># Compile results</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;baseline_severity&#39;</span><span class="p">:</span> <span class="n">baseline_severity</span><span class="p">,</span>
        <span class="s1">&#39;final_severity&#39;</span><span class="p">:</span> <span class="n">final_score</span><span class="p">,</span>
        <span class="s1">&#39;percent_reduction&#39;</span><span class="p">:</span> <span class="n">percent_reduction</span><span class="p">,</span>
        <span class="s1">&#39;outcome&#39;</span><span class="p">:</span> <span class="n">outcome</span><span class="p">,</span>
        <span class="s1">&#39;severity_trajectory&#39;</span><span class="p">:</span> <span class="n">severity_scores</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
        <span class="s1">&#39;alpha_power_trajectory&#39;</span><span class="p">:</span> <span class="n">alpha_power_increase</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
        <span class="s1">&#39;patient_profile&#39;</span><span class="p">:</span> <span class="n">patient_profile</span><span class="p">,</span>
        <span class="s1">&#39;response_delay&#39;</span><span class="p">:</span> <span class="n">response_delay</span>
    <span class="p">}</span>
    
    <span class="k">return</span> <span class="n">results</span>
</pre></div>
</div>
<p>Clinical impact of mental health BCIs:</p>
<ol class="arabic simple">
<li><p><strong>Treatment-Resistant Depression</strong>:
Alpha/theta neurofeedback protocols targeting anterior cingulate cortex (ACC) and left prefrontal cortex show promising results for patients who haven’t responded to medication or conventional therapy. Early clinical trials show remission rates of 30-40% in previously treatment-resistant cases.</p></li>
<li><p><strong>Anxiety Disorder Treatment</strong>:
BCI systems targeting amygdala activity through real-time fMRI neurofeedback help patients gain control over emotional regulation circuits, providing significant anxiety reduction with effects persisting months after treatment completion.</p></li>
<li><p><strong>PTSD Symptom Management</strong>:
BCIs offer trauma-focused therapies where patients can moderate their autonomic responses while processing traumatic memories, reducing hyperarousal symptoms without the overwhelming distress often experienced in conventional exposure therapy.</p></li>
<li><p><strong>Chronic Pain Management</strong>:
Neurofeedback targeting pain processing regions provides an alternative to opioid medications, with clinical trials demonstrating 40-60% reductions in pain intensity and improvements in daily functioning for conditions like fibromyalgia and neuropathic pain.</p></li>
</ol>
</section>
</section>
<section id="non-medical-applications">
<h3>17.6.2 Non-medical Applications<a class="headerlink" href="#non-medical-applications" title="Link to this heading">#</a></h3>
<p>BCIs have expanding applications beyond medicine:</p>
<ul class="simple">
<li><p><strong>Neuroergonomics</strong>: Optimizing human-machine interfaces</p></li>
<li><p><strong>Neuromarketing</strong>: Understanding consumer preferences</p></li>
<li><p><strong>Education</strong>: Enhancing learning through neurofeedback</p></li>
<li><p><strong>Entertainment</strong>: BCI-controlled games and experiences</p></li>
<li><p><strong>Workplace augmentation</strong>: Cognitive monitoring and enhancement</p></li>
</ul>
</section>
<section id="emerging-use-cases">
<h3>17.6.3 Emerging Use Cases<a class="headerlink" href="#emerging-use-cases" title="Link to this heading">#</a></h3>
<p>Novel BCI applications continue to emerge:</p>
<ul class="simple">
<li><p><strong>Collective intelligence</strong>: BCIs that enable brain-to-brain communication</p></li>
<li><p><strong>Extended reality</strong>: Neural interfaces for VR/AR experiences</p></li>
<li><p><strong>Neural cryptography</strong>: Using neural signals for authentication</p></li>
<li><p><strong>Autonomous vehicle control</strong>: BCI-controlled transportation</p></li>
<li><p><strong>Creative applications</strong>: Neural interfaces for art and music</p></li>
</ul>
</section>
</section>
<section id="ethical-and-societal-considerations">
<h2>17.7 Ethical and Societal Considerations<a class="headerlink" href="#ethical-and-societal-considerations" title="Link to this heading">#</a></h2>
<section id="privacy-and-security">
<h3>17.7.1 Privacy and Security<a class="headerlink" href="#privacy-and-security" title="Link to this heading">#</a></h3>
<p>Neural interfaces raise unique privacy concerns:</p>
<ul class="simple">
<li><p><strong>Neural data protection</strong>: Securing brain-derived information</p></li>
<li><p><strong>Neurocognitive security</strong>: Preventing unauthorized neural access</p></li>
<li><p><strong>Mental privacy</strong>: Protecting thoughts and intentions</p></li>
<li><p><strong>Informed consent</strong>: Special considerations for neural data</p></li>
</ul>
</section>
<section id="agency-and-identity">
<h3>17.7.2 Agency and Identity<a class="headerlink" href="#agency-and-identity" title="Link to this heading">#</a></h3>
<p>BCIs challenge traditional notions of agency and identity:</p>
<ul class="simple">
<li><p><strong>Neural authorship</strong>: Who owns thoughts expressed through a BCI?</p></li>
<li><p><strong>Brain-machine boundaries</strong>: When does a BCI become part of identity?</p></li>
<li><p><strong>Cognitive liberty</strong>: Right to control one’s own neural processes</p></li>
<li><p><strong>Authenticity of BCI-mediated actions</strong>: Questions of attribution</p></li>
</ul>
</section>
<section id="access-and-equity">
<h3>17.7.3 Access and Equity<a class="headerlink" href="#access-and-equity" title="Link to this heading">#</a></h3>
<p>Ensuring equitable BCI development requires consideration of:</p>
<ul class="simple">
<li><p><strong>Accessibility</strong>: Making BCIs available to diverse populations</p></li>
<li><p><strong>Affordability</strong>: Economic barriers to neural technology</p></li>
<li><p><strong>Inclusivity in design</strong>: Creating interfaces for different abilities</p></li>
<li><p><strong>Global perspectives</strong>: Cultural differences in neural technology acceptance</p></li>
</ul>
</section>
</section>
<section id="future-directions-in-bci-and-human-ai-interaction">
<h2>17.8 Future Directions in BCI and Human-AI Interaction<a class="headerlink" href="#future-directions-in-bci-and-human-ai-interaction" title="Link to this heading">#</a></h2>
<section id="technological-horizons">
<h3>17.8.1 Technological Horizons<a class="headerlink" href="#technological-horizons" title="Link to this heading">#</a></h3>
<p>Several technological advances will shape future BCIs:</p>
<ul class="simple">
<li><p><strong>Minimally invasive interfaces</strong>: Technologies like neural dust and stentrodes</p></li>
<li><p><strong>Wireless and mobile BCIs</strong>: Untethered neural interfaces</p></li>
<li><p><strong>Bidirectional BCIs</strong>: Systems that both record and stimulate</p></li>
<li><p><strong>Multimodal integration</strong>: Combining BCIs with other interfaces</p></li>
</ul>
</section>
<section id="integration-with-emerging-ai">
<h3>17.8.2 Integration with Emerging AI<a class="headerlink" href="#integration-with-emerging-ai" title="Link to this heading">#</a></h3>
<p>BCIs will increasingly integrate with advanced AI:</p>
<ul class="simple">
<li><p><strong>Neural-symbolic integration</strong>: Combining neural signals with symbolic reasoning</p></li>
<li><p><strong>Brain-inspired AI architectures</strong>: AI systems designed to interface with brains</p></li>
<li><p><strong>Explainable neural interfaces</strong>: Transparent BCI-AI interaction</p></li>
<li><p><strong>Personalized adaptive interfaces</strong>: Systems tailored to individual brains</p></li>
</ul>
</section>
<section id="expanded-applications">
<h3>17.8.3 Expanded Applications<a class="headerlink" href="#expanded-applications" title="Link to this heading">#</a></h3>
<p>Future applications will extend BCIs to new domains:</p>
<ul class="simple">
<li><p><strong>Augmented cognition</strong>: Enhanced mental capabilities</p></li>
<li><p><strong>Shared experiences</strong>: Direct neural communication</p></li>
<li><p><strong>Brain-machine-brain loops</strong>: Closed-loop human-AI ecosystems</p></li>
<li><p><strong>Neural prosthetics</strong>: Replacement of cognitive functions</p></li>
</ul>
</section>
</section>
<section id="practical-exercise-building-a-simple-eeg-classifier">
<h2>17.9 Practical Exercise: Building a Simple EEG Classifier<a class="headerlink" href="#practical-exercise-building-a-simple-eeg-classifier" title="Link to this heading">#</a></h2>
<p>In this exercise, we’ll implement a simple EEG classifier using publicly available data. This example demonstrates how to process EEG signals and use machine learning to classify mental states.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.discriminant_analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearDiscriminantAnalysis</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>


<span class="k">def</span><span class="w"> </span><span class="nf">load_eeg_data</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load EEG data from file or generate simulated data</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    file_path : str or None</span>
<span class="sd">        Path to the EEG data file</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    X : numpy.ndarray</span>
<span class="sd">        EEG data of shape (n_trials, n_channels, n_samples)</span>
<span class="sd">    y : numpy.ndarray</span>
<span class="sd">        Labels for each trial</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">file_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Generate simulated data</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using simulated EEG data...&quot;</span><span class="p">)</span>
        <span class="n">n_trials</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="n">n_channels</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">n_samples</span> <span class="o">=</span> <span class="mi">500</span>
        
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_trials</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span>
        
        <span class="c1"># Class 0: lower alpha power</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
            <span class="c1"># Generate base signal (pink noise)</span>
            <span class="n">base_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
            
            <span class="c1"># Add alpha oscillations (8-13 Hz)</span>
            <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span> <span class="o">/</span> <span class="mi">250</span>  <span class="c1"># Assuming 250 Hz sampling rate</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">times</span><span class="p">)</span>  <span class="c1"># 10 Hz alpha</span>
            
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_channels</span><span class="p">):</span>
                <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_signal</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+</span> <span class="n">alpha</span>
            
            <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            
        <span class="c1"># Class 1: higher alpha power</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_trials</span><span class="p">):</span>
            <span class="c1"># Generate base signal (pink noise)</span>
            <span class="n">base_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
            
            <span class="c1"># Add stronger alpha oscillations (8-13 Hz)</span>
            <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span> <span class="o">/</span> <span class="mi">250</span>  <span class="c1"># Assuming 250 Hz sampling rate</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">times</span><span class="p">)</span>  <span class="c1"># 10 Hz alpha</span>
            
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_channels</span><span class="p">):</span>
                <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_signal</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+</span> <span class="n">alpha</span>
            
            <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Load real data</span>
        <span class="c1"># This would load data from a specific dataset format</span>
        <span class="c1"># For example, using MNE-Python for standard EEG datasets</span>
        <span class="k">pass</span>
    
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>


<span class="k">def</span><span class="w"> </span><span class="nf">extract_features</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract features from EEG data</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    X : numpy.ndarray</span>
<span class="sd">        EEG data of shape (n_trials, n_channels, n_samples)</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    features : numpy.ndarray</span>
<span class="sd">        Features of shape (n_trials, n_features)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_trials</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">n_bands</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># delta, theta, alpha, beta</span>
    
    <span class="c1"># Initialize feature matrix</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_trials</span><span class="p">,</span> <span class="n">n_channels</span> <span class="o">*</span> <span class="n">n_bands</span><span class="p">))</span>
    
    <span class="c1"># Frequency bands (in Hz)</span>
    <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>    <span class="c1"># delta</span>
        <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>    <span class="c1"># theta</span>
        <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>   <span class="c1"># alpha</span>
        <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>   <span class="c1"># beta</span>
    <span class="p">]</span>
    
    <span class="c1"># Extract band power features</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bands</span><span class="p">):</span>
            <span class="c1"># Apply bandpass filter and compute power for each channel</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_channels</span><span class="p">):</span>
                <span class="c1"># Here we&#39;re just using a simple proxy for band power</span>
                <span class="c1"># In a real application, you&#39;d use proper filtering</span>
                <span class="c1"># and power estimation methods</span>
                
                <span class="c1"># Simple FFT-based power estimation</span>
                <span class="n">fft_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">c</span><span class="p">]))</span>
                <span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">250</span><span class="p">)</span>  <span class="c1"># Assuming 250 Hz</span>
                
                <span class="c1"># Find indices corresponding to the frequency band</span>
                <span class="n">idx_band</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">freqs</span> <span class="o">&gt;=</span> <span class="n">low</span><span class="p">,</span> <span class="n">freqs</span> <span class="o">&lt;=</span> <span class="n">high</span><span class="p">)</span>
                
                <span class="c1"># Compute band power (mean of squared FFT coefficients)</span>
                <span class="n">power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">fft_vals</span><span class="p">[</span><span class="n">idx_band</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                
                <span class="c1"># Store in feature matrix</span>
                <span class="n">features</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">*</span> <span class="n">n_channels</span> <span class="o">+</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">power</span>
    
    <span class="k">return</span> <span class="n">features</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main function to demonstrate EEG classification</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 1. Load or generate EEG data</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_eeg_data</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data loaded: </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> trials with </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> channels and </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2"> samples each&quot;</span><span class="p">)</span>
    
    <span class="c1"># 2. Extract features</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">extract_features</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Features extracted: </span><span class="si">{</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1"># 3. Split data into training and testing sets</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
        <span class="n">features</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
    <span class="p">)</span>
    
    <span class="c1"># 4. Create and train classifier</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
        <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
        <span class="p">(</span><span class="s1">&#39;lda&#39;</span><span class="p">,</span> <span class="n">LinearDiscriminantAnalysis</span><span class="p">())</span>
    <span class="p">])</span>
    
    <span class="c1"># 5. Evaluate using cross-validation</span>
    <span class="n">cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cross-validation accuracy: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> ± </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1"># 6. Train on full training set and evaluate on test set</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    
    <span class="c1"># 7. Report results</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Classification report:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
    
    <span class="c1"># 8. Plot confusion matrix</span>
    <span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="n">tick_marks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Class 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Class 1&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Class 0&#39;</span><span class="p">,</span> <span class="s1">&#39;Class 1&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted Label&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Label&#39;</span><span class="p">)</span>
    
    <span class="c1"># Add text annotations to the confusion matrix</span>
    <span class="n">thresh</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">format</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="s1">&#39;d&#39;</span><span class="p">),</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span> <span class="k">if</span> <span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">thresh</span> <span class="k">else</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="chapter-take-aways">
<h2>17.10 Chapter Take-aways<a class="headerlink" href="#chapter-take-aways" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Brain-Computer Interfaces (BCIs) create direct communication pathways between neural activity and external devices</p></li>
<li><p>BCIs range from invasive electrode arrays to non-invasive techniques like EEG</p></li>
<li><p>AI enhances BCIs through improved neural decoding, adaptation, and user interaction</p></li>
<li><p>Neural interfaces enable novel forms of human-AI collaboration, from direct control to cognitive augmentation</p></li>
<li><p>BCIs have applications in clinical care, workplace augmentation, education, and entertainment</p></li>
<li><p>Ethical considerations include neural privacy, cognitive liberty, and equitable access</p></li>
<li><p>Future BCIs will feature minimally invasive technologies, bidirectional interfaces, and deeper AI integration</p></li>
</ul>
</section>
<section id="further-reading">
<h2>17.11 Further Reading<a class="headerlink" href="#further-reading" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Wolpaw, J. R., &amp; Wolpaw, E. W. (Eds.). (2012). <em>Brain-computer interfaces: Principles and practice</em>. Oxford University Press.</p></li>
<li><p>Lebedev, M. A., &amp; Nicolelis, M. A. (2017). Brain-machine interfaces: From basic science to neuroprostheses and neurorehabilitation. <em>Physiological Reviews, 97</em>(2), 767-837.</p></li>
<li><p>Saha, S., et al. (2021). Progress in brain computer interface: Challenges and opportunities. <em>Frontiers in Systems Neuroscience, 15</em>, 578875.</p></li>
<li><p>Musk, E., &amp; Neuralink. (2019). An integrated brain-machine interface platform with thousands of channels. <em>Journal of Medical Internet Research, 21</em>(10), e16194.</p></li>
<li><p>Schalk, G. (2020). Brain-computer symbiosis. <em>Journal of Neural Engineering, 17</em>(2), 021001.</p></li>
<li><p>Lazarou, I., et al. (2018). EEG-based brain-computer interfaces for communication and rehabilitation of people with motor impairment: A novel approach of the 21st century. <em>Frontiers in Human Neuroscience, 12</em>, 14.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "executablebooks/jupyter-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./part6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../part5/ch16_future_directions.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 16: Where Next for Neuro-AI?</p>
      </div>
    </a>
    <a class="right-next"
       href="ch18_neuromorphic_computing.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 18: Neuromorphic Computing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-goals">Chapter Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-connecting-brains-and-machines">17.1 Introduction: Connecting Brains and Machines</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#neurophysiological-bases-for-bcis">17.2 Neurophysiological Bases for BCIs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relevant-brain-systems-for-interface">17.2.1 Relevant Brain Systems for Interface</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-signal-types">17.2.2 Neural Signal Types</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bci-technologies-and-approaches">17.3 BCI Technologies and Approaches</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#invasive-bcis">17.3.1 Invasive BCIs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-invasive-bcis">17.3.2 Non-invasive BCIs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-decoding-approaches">17.3.3 Neural Decoding Approaches</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ai-enhanced-bcis">17.4 AI-Enhanced BCIs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#machine-learning-for-neural-decoding">17.4.1 Machine Learning for Neural Decoding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptive-and-learning-systems">17.4.2 Adaptive and Learning Systems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-feedback-and-closed-loop-systems">17.4.3 Neural Feedback and Closed-Loop Systems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#human-ai-interaction-via-neural-interfaces">17.5 Human-AI Interaction via Neural Interfaces</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bci-as-a-communication-channel">17.5.1 BCI as a Communication Channel</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-interfaces-for-ai-agents">17.5.2 Neural Interfaces for AI Agents</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-applications-and-case-studies">17.6 Practical Applications and Case Studies</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clinical-applications">17.6.1 Clinical Applications</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-paralysis-treatment-with-bcis">17.6.1.1 Advanced Paralysis Treatment with BCIs</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#communication-systems-for-locked-in-syndrome">17.6.1.2 Communication Systems for Locked-in Syndrome</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neurorehabilitation-for-stroke-recovery">17.6.1.3 Neurorehabilitation for Stroke Recovery</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#treatment-resistant-depression-therapy">17.6.1.4 Treatment-Resistant Depression Therapy</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#non-medical-applications">17.6.2 Non-medical Applications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#emerging-use-cases">17.6.3 Emerging Use Cases</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ethical-and-societal-considerations">17.7 Ethical and Societal Considerations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#privacy-and-security">17.7.1 Privacy and Security</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agency-and-identity">17.7.2 Agency and Identity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#access-and-equity">17.7.3 Access and Equity</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#future-directions-in-bci-and-human-ai-interaction">17.8 Future Directions in BCI and Human-AI Interaction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#technological-horizons">17.8.1 Technological Horizons</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-with-emerging-ai">17.8.2 Integration with Emerging AI</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#expanded-applications">17.8.3 Expanded Applications</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#practical-exercise-building-a-simple-eeg-classifier">17.9 Practical Exercise: Building a Simple EEG Classifier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-take-aways">17.10 Chapter Take-aways</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">17.11 Further Reading</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Richard Young
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>