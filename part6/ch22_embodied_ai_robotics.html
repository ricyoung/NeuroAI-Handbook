
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 22: Embodied AI and Robotics &#8212; The Neuroscience of AI</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'part6/ch22_embodied_ai_robotics';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://neuroai-handbook.github.io/part6/ch22_embodied_ai_robotics.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 24: Quantum Computing and NeuroAI" href="ch24_quantum_computing_neuroai.html" />
    <link rel="prev" title="Chapter 21: AI for Neuroscience Discovery" href="ch21_ai_for_neuro_discovery.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nai.png" class="logo__image only-light" alt="The Neuroscience of AI - Home"/>
    <script>document.write(`<img src="../_static/nai.png" class="logo__image only-dark" alt="The Neuroscience of AI - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    The Neuroscience of AI
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Cover</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cover.html">Cover</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Front Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../frontmatter/copyright.html">Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frontmatter/acknowledgments.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frontmatter/about.html">About This Book</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part I · Brains &amp; Inspiration</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part1/ch01_intro.html">Chapter 1: Introduction to Neuroscience ↔ AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part1/ch02_neuro_foundations.html">Chapter 2: Neuroscience Foundations for AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part1/ch03_spatial_navigation.html">Chapter 3: Spatial Navigation – Place &amp; Grid Cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part1/ch04_perception_pipeline.html">Chapter 4: Perception Pipeline – Visual Cortex → CNNs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part II · Brains Meet Math &amp; Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part2/ch05_brain_networks.html">Chapter 5: Default-Mode vs Executive Control Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/ch06_neurostimulation.html">Chapter 6: Neurostimulation &amp; Plasticity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/ch07_information_theory.html">Chapter 7: Information Theory Essentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/ch08_data_science_pipeline.html">Chapter 8: Data-Science Pipeline in Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part III · Learning Machines</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part3/ch09_ml_foundations.html">Chapter 9: Classical Machine-Learning Foundations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part3/ch10_deep_learning.html">Chapter 10: Deep Learning: Training &amp; Optimisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part3/ch11_sequence_models.html">Chapter 11: Sequence Models: RNN → Attention → Transformer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part IV · Frontier Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part4/ch12_large_language_models.html">Chapter 12: Large Language Models &amp; Fine-Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part4/ch13_multimodal_models.html">Chapter 13: Multimodal &amp; Diffusion Models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part V · Ethics &amp; Futures</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part5/ch15_ethical_ai.html">Chapter 15: Ethical AI - Considerations for NeuroAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part5/ch16_future_directions.html">Chapter 16: Where Next for Neuro-AI?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part VI · Advanced Applications</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ch17_bci_human_ai_interfaces.html">Brain-Computer Interfaces and Human-AI Interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch18_neuromorphic_computing.html">Chapter 18: Neuromorphic Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch19_cognitive_neuro_dl.html">Cognitive Neuroscience and Deep Learning</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="ch20_case_studies.html">Case Studies in NeuroAI</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="ch20_interactive.html">Interactive NeuroAI Case Studies</a></li>
<li class="toctree-l2"><a class="reference internal" href="jupyter_ai_demo.html">AI-Assisted Learning with Jupyter AI</a></li>
<li class="toctree-l2"><a class="reference internal" href="rise_slides_demo.html">Creating Presentations with RISE</a></li>


</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="ch21_ai_for_neuro_discovery.html">Chapter 21: AI for Neuroscience Discovery</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 22: Embodied AI and Robotics</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch24_quantum_computing_neuroai.html">Chapter 24: Quantum Computing and NeuroAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch23_lifelong_learning.html">Chapter 23: Lifelong Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendices/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/math_python_refresher.html">Appendix A: Math &amp; Python Mini-Refresher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/dataset_catalogue.html">Appendix B: Dataset Catalogue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/colab_setup.html">Appendix C: Google Colab Setup for NeuroAI</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/edit/master/docs/part6/ch22_embodied_ai_robotics.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fpart6/ch22_embodied_ai_robotics.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/part6/ch22_embodied_ai_robotics.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 22: Embodied AI and Robotics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-goals">22.0 Chapter Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#from-disembodied-algorithms-to-grounded-intelligence">22.1 From Disembodied Algorithms to Grounded Intelligence</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-embodiment-hypothesis">22.1.1 The Embodiment Hypothesis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#brain-inspired-control-architectures">22.1.2 Brain-Inspired Control Architectures</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#neuroscience-inspired-sensorimotor-control">22.2 Neuroscience-Inspired Sensorimotor Control</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#motor-primitives-and-synergies">22.2.1 Motor Primitives and Synergies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predictive-coding-and-forward-models">22.2.2 Predictive Coding and Forward Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cerebellar-inspired-adaptive-control">22.2.3 Cerebellar-Inspired Adaptive Control</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#affordances-and-action-centered-perception">22.3 Affordances and Action-Centered Perception</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#human-robot-collaboration-and-social-robotics">22.4 Human-Robot Collaboration and Social Robotics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shared-control-and-collaborative-tasks">22.4.1 Shared Control and Collaborative Tasks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-from-demonstration">22.4.2 Learning from Demonstration</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-lab-simple-neuro-inspired-robot-controller">22.5 Code Lab: Simple Neuro-Inspired Robot Controller</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#take-aways">22.6 Take-aways</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">22.7 Further Reading</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-22-embodied-ai-and-robotics">
<h1>Chapter 22: Embodied AI and Robotics<a class="headerlink" href="#chapter-22-embodied-ai-and-robotics" title="Link to this heading">#</a></h1>
<div style="page-break-before:always;"></div>
<section id="chapter-goals">
<h2>22.0 Chapter Goals<a class="headerlink" href="#chapter-goals" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Understand how neuroscience principles inform embodied AI and robotics</p></li>
<li><p>Explore brain-inspired approaches to sensorimotor learning and control</p></li>
<li><p>Learn about predictive coding and internal models for robot control</p></li>
<li><p>Implement a basic neuro-inspired robot controller</p></li>
</ul>
</section>
<section id="from-disembodied-algorithms-to-grounded-intelligence">
<h2>22.1 From Disembodied Algorithms to Grounded Intelligence<a class="headerlink" href="#from-disembodied-algorithms-to-grounded-intelligence" title="Link to this heading">#</a></h2>
<p>Most AI systems today exist as disembodied algorithms, processing data without direct interaction with the physical world. In contrast, human and animal intelligence developed through embodied interaction with the environment. Robotics and embodied AI aim to bridge this gap by developing systems that learn through physical interaction.</p>
<section id="the-embodiment-hypothesis">
<h3>22.1.1 The Embodiment Hypothesis<a class="headerlink" href="#the-embodiment-hypothesis" title="Link to this heading">#</a></h3>
<p>The embodiment hypothesis posits that intelligence requires a body - that cognition is shaped by the sensorimotor experiences that come from having a physical form interacting with the world:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">EmbodiedAgent</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensors</span><span class="p">,</span> <span class="n">actuators</span><span class="p">,</span> <span class="n">environment</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Basic embodied agent with sensors and actuators</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - sensors: Dictionary of sensor types and their properties</span>
<span class="sd">        - actuators: Dictionary of actuator types and their properties</span>
<span class="sd">        - environment: Environment the agent operates in</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensors</span> <span class="o">=</span> <span class="n">sensors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuators</span> <span class="o">=</span> <span class="n">actuators</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span> <span class="o">=</span> <span class="n">environment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">internal_state</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">sense</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gather sensory information from environment&quot;&quot;&quot;</span>
        <span class="n">current_sensory_data</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">for</span> <span class="n">sensor_name</span><span class="p">,</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensors</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Get raw sensory data from environment</span>
            <span class="n">raw_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">get_sensor_data</span><span class="p">(</span><span class="n">sensor</span><span class="p">)</span>
            
            <span class="c1"># Apply sensor-specific processing</span>
            <span class="n">processed_data</span> <span class="o">=</span> <span class="n">sensor</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>
            <span class="n">current_sensory_data</span><span class="p">[</span><span class="n">sensor_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">processed_data</span>
        
        <span class="c1"># Store in history</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensor_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_sensory_data</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">current_sensory_data</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">act</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action_commands</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute actions in the environment&quot;&quot;&quot;</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">for</span> <span class="n">actuator_name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">action_commands</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">actuator_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actuators</span><span class="p">:</span>
                <span class="c1"># Execute command with the specified actuator</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actuators</span><span class="p">[</span><span class="n">actuator_name</span><span class="p">]</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
                <span class="n">results</span><span class="p">[</span><span class="n">actuator_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="n">actuator_name</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Error: Actuator not found&quot;</span>
        
        <span class="c1"># Store in history</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action_commands</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">results</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">learn_from_interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Learn from sensorimotor interaction history&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor_history</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Not enough data for learning&quot;</span>
        
        <span class="c1"># Analyze how actions led to sensory changes</span>
        <span class="n">lessons</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action_history</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensor_history</span><span class="p">):</span>
                <span class="c1"># Observe what sensory changes resulted from action</span>
                <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_history</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">state_before</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_history</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">state_after</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensor_history</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                
                <span class="c1"># Learn relationships between actions and sensory changes</span>
                <span class="k">for</span> <span class="n">actuator_name</span><span class="p">,</span> <span class="n">command</span> <span class="ow">in</span> <span class="n">action</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">sensor_name</span> <span class="ow">in</span> <span class="n">state_before</span><span class="p">:</span>
                        <span class="c1"># Calculate sensory difference</span>
                        <span class="k">if</span> <span class="n">sensor_name</span> <span class="ow">in</span> <span class="n">state_after</span><span class="p">:</span>
                            <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_difference</span><span class="p">(</span>
                                <span class="n">state_before</span><span class="p">[</span><span class="n">sensor_name</span><span class="p">],</span>
                                <span class="n">state_after</span><span class="p">[</span><span class="n">sensor_name</span><span class="p">]</span>
                            <span class="p">)</span>
                            
                            <span class="n">lesson</span> <span class="o">=</span> <span class="p">{</span>
                                <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">actuator_name</span><span class="p">,</span> <span class="n">command</span><span class="p">),</span>
                                <span class="s1">&#39;sensor&#39;</span><span class="p">:</span> <span class="n">sensor_name</span><span class="p">,</span>
                                <span class="s1">&#39;effect&#39;</span><span class="p">:</span> <span class="n">diff</span>
                            <span class="p">}</span>
                            <span class="n">lessons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lesson</span><span class="p">)</span>
        
        <span class="c1"># Update internal models based on observed action-effect pairs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_internal_models</span><span class="p">(</span><span class="n">lessons</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">lessons</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">before</span><span class="p">,</span> <span class="n">after</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate difference between sensory states (simplified)&quot;&quot;&quot;</span>
        <span class="c1"># This would be specialized based on sensor type</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">before</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">after</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">after</span> <span class="o">-</span> <span class="n">before</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Complex sensor type, difference calculation omitted&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">update_internal_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lessons</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update internal models based on learning (placeholder)&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">lesson</span> <span class="ow">in</span> <span class="n">lessons</span><span class="p">:</span>
            <span class="n">action_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lesson</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">lesson</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">sensor_key</span> <span class="o">=</span> <span class="n">lesson</span><span class="p">[</span><span class="s1">&#39;sensor&#39;</span><span class="p">]</span>
            <span class="n">effect</span> <span class="o">=</span> <span class="n">lesson</span><span class="p">[</span><span class="s1">&#39;effect&#39;</span><span class="p">]</span>
            
            <span class="c1"># Simple aggregate model of effects</span>
            <span class="n">model_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">action_key</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">sensor_key</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">model_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">internal_state</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">internal_state</span><span class="p">[</span><span class="n">model_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">internal_state</span><span class="p">[</span><span class="n">model_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">effect</span><span class="p">)</span>
</pre></div>
</div>
<p>Key principles from the embodiment hypothesis include:</p>
<ol class="arabic simple">
<li><p><strong>Sensorimotor coupling</strong>: Intelligence emerges from the dynamic interaction between sensing and action</p></li>
<li><p><strong>Environmental scaffolding</strong>: The environment provides structure that simplifies learning</p></li>
<li><p><strong>Body schema</strong>: Internal models of the body’s capabilities shape cognitive development</p></li>
</ol>
</section>
<section id="brain-inspired-control-architectures">
<h3>22.1.2 Brain-Inspired Control Architectures<a class="headerlink" href="#brain-inspired-control-architectures" title="Link to this heading">#</a></h3>
<p>Traditional robot control uses hierarchical architectures with clear separations between perception, planning, and action. Brain-inspired approaches favor more integrated architectures:</p>
<ol class="arabic simple">
<li><p><strong>Reactive-Deliberative Hybrid</strong>: Combines fast reactive behaviors with slower deliberative planning</p></li>
<li><p><strong>Subsumption Architecture</strong>: Layered behaviors where higher levels subsume lower levels</p></li>
<li><p><strong>Distributed Control</strong>: Multiple specialized controllers coordinating without central executive</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SubsumptionController</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implementation of Brooks&#39; subsumption architecture</span>
<span class="sd">        with layered behaviors</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">behaviors</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Ordered from lowest to highest priority</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">add_behavior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">behavior</span><span class="p">,</span> <span class="n">priority</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a behavior at specified priority level&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">behaviors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">behavior</span><span class="p">,</span> <span class="n">priority</span><span class="p">))</span>
        <span class="c1"># Sort behaviors by priority (highest value = highest priority)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">behaviors</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensory_input</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate action by evaluating behaviors in priority order</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - sensory_input: Current sensory information</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - action: Selected action command</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Start with no action selected</span>
        <span class="n">selected_action</span> <span class="o">=</span> <span class="kc">None</span>
        
        <span class="c1"># Evaluate behaviors from lowest to highest priority</span>
        <span class="k">for</span> <span class="n">behavior</span><span class="p">,</span> <span class="n">priority</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">behaviors</span><span class="p">:</span>
            <span class="c1"># Check if behavior is applicable</span>
            <span class="k">if</span> <span class="n">behavior</span><span class="o">.</span><span class="n">is_applicable</span><span class="p">(</span><span class="n">sensory_input</span><span class="p">):</span>
                <span class="c1"># Get action from this behavior</span>
                <span class="n">action</span> <span class="o">=</span> <span class="n">behavior</span><span class="o">.</span><span class="n">compute_action</span><span class="p">(</span><span class="n">sensory_input</span><span class="p">)</span>
                
                <span class="c1"># Higher priority behaviors override (subsume) lower ones</span>
                <span class="k">if</span> <span class="n">action</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">selected_action</span> <span class="o">=</span> <span class="n">action</span>
        
        <span class="k">return</span> <span class="n">selected_action</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Behavior</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Base class for robot behaviors</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - name: Name of this behavior</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">is_applicable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensory_input</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if this behavior applies to current situation</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - sensory_input: Current sensory information</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - applicable: Whether behavior is applicable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Must be implemented by subclasses</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensory_input</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute action based on sensory input</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - sensory_input: Current sensory information</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - action: Action command</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Must be implemented by subclasses</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

<span class="c1"># Example behaviors</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ObstacleAvoidance</span><span class="p">(</span><span class="n">Behavior</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">safety_distance</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;Obstacle Avoidance&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safety_distance</span> <span class="o">=</span> <span class="n">safety_distance</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">is_applicable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensory_input</span><span class="p">):</span>
        <span class="c1"># Check if any obstacle is within safety distance</span>
        <span class="k">if</span> <span class="s1">&#39;proximity&#39;</span> <span class="ow">in</span> <span class="n">sensory_input</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">sensory_input</span><span class="p">[</span><span class="s1">&#39;proximity&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">safety_distance</span>
        <span class="k">return</span> <span class="kc">False</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensory_input</span><span class="p">):</span>
        <span class="c1"># Find direction with most clearance</span>
        <span class="n">proximity_sensors</span> <span class="o">=</span> <span class="n">sensory_input</span><span class="p">[</span><span class="s1">&#39;proximity&#39;</span><span class="p">]</span>
        <span class="n">safest_direction</span> <span class="o">=</span> <span class="n">proximity_sensors</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">proximity_sensors</span><span class="p">))</span>
        <span class="n">turn_amount</span> <span class="o">=</span> <span class="p">(</span><span class="n">safest_direction</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">proximity_sensors</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># -1 to 1</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;linear_velocity&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># Slow down near obstacles</span>
            <span class="s1">&#39;angular_velocity&#39;</span><span class="p">:</span> <span class="n">turn_amount</span>  <span class="c1"># Turn away from obstacle</span>
        <span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="nc">GoalSeeking</span><span class="p">(</span><span class="n">Behavior</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal_position</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;Goal Seeking&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">goal_position</span> <span class="o">=</span> <span class="n">goal_position</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">is_applicable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensory_input</span><span class="p">):</span>
        <span class="c1"># Always applicable if we have position data</span>
        <span class="k">return</span> <span class="s1">&#39;position&#39;</span> <span class="ow">in</span> <span class="n">sensory_input</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensory_input</span><span class="p">):</span>
        <span class="c1"># Calculate vector to goal</span>
        <span class="n">current_pos</span> <span class="o">=</span> <span class="n">sensory_input</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span>
        <span class="n">goal_vector</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">goal_position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">current_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">goal_position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">current_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">]</span>
        
        <span class="c1"># Calculate heading to goal</span>
        <span class="n">current_heading</span> <span class="o">=</span> <span class="n">sensory_input</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;heading&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">goal_heading</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">goal_vector</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">goal_vector</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">heading_error</span> <span class="o">=</span> <span class="n">goal_heading</span> <span class="o">-</span> <span class="n">current_heading</span>
        
        <span class="c1"># Normalize to -pi to pi</span>
        <span class="n">heading_error</span> <span class="o">=</span> <span class="p">((</span><span class="n">heading_error</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;linear_velocity&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Move forward</span>
            <span class="s1">&#39;angular_velocity&#39;</span><span class="p">:</span> <span class="n">heading_error</span> <span class="o">*</span> <span class="mf">0.5</span>  <span class="c1"># Turn toward goal</span>
        <span class="p">}</span>
</pre></div>
</div>
<div style="page-break-before:always;"></div>
</section>
</section>
<section id="neuroscience-inspired-sensorimotor-control">
<h2>22.2 Neuroscience-Inspired Sensorimotor Control<a class="headerlink" href="#neuroscience-inspired-sensorimotor-control" title="Link to this heading">#</a></h2>
<p>The brain’s motor control systems offer valuable inspiration for robotic control.</p>
<section id="motor-primitives-and-synergies">
<h3>22.2.1 Motor Primitives and Synergies<a class="headerlink" href="#motor-primitives-and-synergies" title="Link to this heading">#</a></h3>
<p>Rather than controlling individual motor units separately, the brain organizes movement around motor primitives - coordinated patterns of muscle activation that can be combined to produce complex behaviors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MotorPrimitiveController</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_primitives</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_actuators</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Controller based on motor primitives/synergies</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - n_primitives: Number of motor primitives</span>
<span class="sd">        - n_actuators: Number of actuators/motors to control</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize random primitive patterns</span>
        <span class="c1"># In real applications, these would be learned or designed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">primitives</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">n_primitives</span><span class="p">,</span> <span class="n">n_actuators</span><span class="p">))</span>
        
        <span class="c1"># Normalize primitives</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_primitives</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">n_primitives</span> <span class="o">=</span> <span class="n">n_primitives</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_actuators</span> <span class="o">=</span> <span class="n">n_actuators</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_movement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">primitive_weights</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate actuator commands by combining primitives</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - primitive_weights: Weights for each primitive</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - actuator_commands: Commands for each actuator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">primitive_weights</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_primitives</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_primitives</span><span class="si">}</span><span class="s2"> weights, got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">primitive_weights</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="c1"># Combine primitives using weights</span>
        <span class="n">actuator_commands</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_actuators</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">weight</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">primitive_weights</span><span class="p">):</span>
            <span class="n">actuator_commands</span> <span class="o">+=</span> <span class="n">weight</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">actuator_commands</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">learn_new_primitive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample_movements</span><span class="p">,</span> <span class="n">n_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Learn a new motor primitive from example movements</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - sample_movements: Array of sample actuator commands</span>
<span class="sd">        - n_iterations: Number of learning iterations</span>
<span class="sd">        - learning_rate: Learning rate for updates</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - new_primitive: The newly learned primitive</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize new primitive randomly</span>
        <span class="n">new_primitive</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_actuators</span><span class="p">)</span>
        <span class="n">new_primitive</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">new_primitive</span><span class="p">)</span>
        
        <span class="c1"># Learn through dimensionality reduction (simplified)</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">movement</span> <span class="ow">in</span> <span class="n">sample_movements</span><span class="p">:</span>
                <span class="c1"># Project movement onto current primitive</span>
                <span class="n">projection</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">movement</span><span class="p">,</span> <span class="n">new_primitive</span><span class="p">)</span>
                
                <span class="c1"># Reconstruction error</span>
                <span class="n">error</span> <span class="o">=</span> <span class="n">movement</span> <span class="o">-</span> <span class="n">projection</span> <span class="o">*</span> <span class="n">new_primitive</span>
                
                <span class="c1"># Update primitive to reduce error</span>
                <span class="n">gradient</span> <span class="o">=</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">movement</span><span class="p">)</span>
                <span class="n">new_primitive</span> <span class="o">+=</span> <span class="n">gradient</span>
                
                <span class="c1"># Normalize</span>
                <span class="n">new_primitive</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">new_primitive</span><span class="p">)</span>
        
        <span class="c1"># Add to primitive set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">primitives</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">primitives</span><span class="p">,</span> <span class="n">new_primitive</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_primitives</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="k">return</span> <span class="n">new_primitive</span>
</pre></div>
</div>
<p>This approach offers several advantages:</p>
<ol class="arabic simple">
<li><p><strong>Dimensionality reduction</strong>: Control complexity is reduced from many actuators to fewer primitives</p></li>
<li><p><strong>Generalization</strong>: New movements can be generated by recombining existing primitives</p></li>
<li><p><strong>Robustness</strong>: Primitive-based control is less sensitive to individual actuator failures</p></li>
</ol>
</section>
<section id="predictive-coding-and-forward-models">
<h3>22.2.2 Predictive Coding and Forward Models<a class="headerlink" href="#predictive-coding-and-forward-models" title="Link to this heading">#</a></h3>
<p>The brain uses predictive coding to anticipate the sensory consequences of actions. Similar predictive mechanisms can vastly improve robot control:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">PredictiveController</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_inputs</span><span class="p">,</span> <span class="n">n_outputs</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Controller implementing predictive coding principles</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - n_inputs: Dimension of input (sensory) space</span>
<span class="sd">        - n_outputs: Dimension of output (motor) space</span>
<span class="sd">        - learning_rate: Learning rate for model updates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize forward model (predicts sensory consequences of actions)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">W_forward</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="n">n_inputs</span><span class="p">,</span> <span class="n">n_outputs</span><span class="p">))</span>
        
        <span class="c1"># Initialize inverse model (maps desired sensory states to actions)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">W_inverse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="n">n_outputs</span><span class="p">,</span> <span class="n">n_inputs</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">learning_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prediction_errors</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">predict_sensory_outcome</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict sensory outcome of an action</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - action: Motor command</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - predicted_sensation: Predicted sensory feedback</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">W_forward</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_sensation</span><span class="p">,</span> <span class="n">target_sensation</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate action to achieve target sensory state</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - current_sensation: Current sensory state</span>
<span class="sd">        - target_sensation: Desired sensory state</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - action: Motor command</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate sensory prediction error</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">target_sensation</span> <span class="o">-</span> <span class="n">current_sensation</span>
        
        <span class="c1"># Use inverse model to generate action</span>
        <span class="n">action</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">W_inverse</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">action</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">update_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">predicted_sensation</span><span class="p">,</span> <span class="n">actual_sensation</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update forward and inverse models based on prediction error</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - action: Motor command that was executed</span>
<span class="sd">        - predicted_sensation: Sensation that was predicted</span>
<span class="sd">        - actual_sensation: Sensation that was actually experienced</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - prediction_error: Magnitude of prediction error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate prediction error</span>
        <span class="n">prediction_error</span> <span class="o">=</span> <span class="n">actual_sensation</span> <span class="o">-</span> <span class="n">predicted_sensation</span>
        <span class="n">error_magnitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">prediction_error</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prediction_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_magnitude</span><span class="p">)</span>
        
        <span class="c1"># Update forward model</span>
        <span class="n">update</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">prediction_error</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">W_forward</span> <span class="o">+=</span> <span class="n">update</span>
        
        <span class="c1"># Update inverse model</span>
        <span class="n">update</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">prediction_error</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">W_inverse</span> <span class="o">+=</span> <span class="n">update</span>
        
        <span class="k">return</span> <span class="n">error_magnitude</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">learning_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot learning curve of prediction errors&quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prediction_errors</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Learning Step&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Prediction Error&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Predictive Model Learning Curve&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">plt</span>
</pre></div>
</div>
<p>Forward models enable critical capabilities:</p>
<ol class="arabic simple">
<li><p><strong>Sensory cancellation</strong>: Distinguishing external stimuli from self-generated sensations</p></li>
<li><p><strong>Closed-loop control</strong>: Compensating for discrepancies between predicted and actual outcomes</p></li>
<li><p><strong>Mental simulation</strong>: Planning actions by simulating their outcomes before execution</p></li>
</ol>
</section>
<section id="cerebellar-inspired-adaptive-control">
<h3>22.2.3 Cerebellar-Inspired Adaptive Control<a class="headerlink" href="#cerebellar-inspired-adaptive-control" title="Link to this heading">#</a></h3>
<p>The cerebellum is critical for motor learning and coordination. Cerebellar-inspired control models can enable robots to adapt to changing dynamics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CerebellarAdaptiveController</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_inputs</span><span class="p">,</span> <span class="n">n_outputs</span><span class="p">,</span> <span class="n">n_granule_cells</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cerebellar-inspired adaptive controller</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - n_inputs: Number of mossy fiber inputs (sensory state variables)</span>
<span class="sd">        - n_outputs: Number of outputs (motor commands)</span>
<span class="sd">        - n_granule_cells: Number of granule cells for sparse expansion</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_inputs</span> <span class="o">=</span> <span class="n">n_inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_outputs</span> <span class="o">=</span> <span class="n">n_outputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_granule_cells</span> <span class="o">=</span> <span class="n">n_granule_cells</span>
        
        <span class="c1"># Connectivity from mossy fibers to granule cells (random projection)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">W_mossy_granule</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">n_granule_cells</span><span class="p">,</span> <span class="n">n_inputs</span><span class="p">))</span>
        
        <span class="c1"># Weights from granule cells to Purkinje cells (learnable)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">W_granule_purkinje</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="n">n_outputs</span><span class="p">,</span> <span class="n">n_granule_cells</span><span class="p">))</span>
        
        <span class="c1"># Learning rate for parallel fiber-Purkinje cell synapses</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.01</span>
        
        <span class="c1"># History of corrections</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">correction_history</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">granule_cell_activity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mossy_input</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate granule cell activity from mossy fiber input</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - mossy_input: Input from mossy fibers (sensory state)</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - granule_activity: Activity of granule cells</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Perform sparse expansion</span>
        <span class="n">raw_activity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">W_mossy_granule</span><span class="p">,</span> <span class="n">mossy_input</span><span class="p">)</span>
        
        <span class="c1"># ReLU activation</span>
        <span class="n">activity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">raw_activity</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="c1"># Normalization and sparsification (approximate k-winners-take-all)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_granule_cells</span> <span class="o">*</span> <span class="mf">0.05</span><span class="p">)</span>  <span class="c1"># 5% activity</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">activity</span><span class="p">)[</span><span class="o">-</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="n">activity</span><span class="p">[</span><span class="n">activity</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">return</span> <span class="n">activity</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_correction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute corrective signal for feedforward control</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - state: Current sensory state</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - correction: Corrective motor command</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Expand input through granule cells</span>
        <span class="n">granule_activity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">granule_cell_activity</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        
        <span class="c1"># Compute cerebellar correction</span>
        <span class="n">correction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">W_granule_purkinje</span><span class="p">,</span> <span class="n">granule_activity</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">correction_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">correction</span><span class="p">))</span>
        
        <span class="k">return</span> <span class="n">correction</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">learn_from_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Learn from motor error (climbing fiber input)</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - state: Sensory state during error</span>
<span class="sd">        - error: Motor error/climbing fiber signal</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get granule cell activity for this state</span>
        <span class="n">granule_activity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">granule_cell_activity</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        
        <span class="c1"># Update weights according to correlation of granule activity with error</span>
        <span class="c1"># This follows the cerebellum&#39;s supervised learning rule</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_outputs</span><span class="p">):</span>
            <span class="n">delta_w</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">error</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">granule_activity</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">W_granule_purkinje</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">delta_w</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_learning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot correction magnitude over time&quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_history</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Trial&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Correction Magnitude&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cerebellar Adaptation&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">plt</span>
</pre></div>
</div>
<p>The cerebellum’s architecture enables specific computational features:</p>
<ol class="arabic simple">
<li><p><strong>Sparse coding</strong>: Granule cells expand the input space while maintaining sparse activity</p></li>
<li><p><strong>Supervised learning</strong>: Climbing fiber error signals guide synaptic weight updates</p></li>
<li><p><strong>Timing mechanisms</strong>: Precise timing of movements through internal timing circuitry</p></li>
</ol>
</section>
</section>
<section id="affordances-and-action-centered-perception">
<h2>22.3 Affordances and Action-Centered Perception<a class="headerlink" href="#affordances-and-action-centered-perception" title="Link to this heading">#</a></h2>
<p>The concept of affordances, introduced by psychologist J.J. Gibson, refers to the action possibilities that objects or environments offer. This ecological approach to perception has influenced embodied AI:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">AffordanceDetector</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        System to detect action affordances in visual scenes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">affordance_types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;graspable&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;min_size&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;max_size&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;convexity&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">},</span>
            <span class="s1">&#39;pushable&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;min_size&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;max_size&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;flat_side&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
            <span class="s1">&#39;liftable&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;min_size&#39;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;max_size&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;weight_est&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span>
            <span class="s1">&#39;sittable&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;min_size&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;max_size&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;horizontal_surface&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
        <span class="p">}</span>
        
        <span class="c1"># Tracks learned affordance-action associations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_success_history</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">detect_affordances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objects</span><span class="p">,</span> <span class="n">robot_capabilities</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detect affordances of objects based on their properties</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - objects: List of objects with properties</span>
<span class="sd">        - robot_capabilities: Dict of robot capabilities and limitations</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - affordances: Dict mapping objects to their affordances</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">affordances</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
            <span class="n">obj_affordances</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="k">for</span> <span class="n">affordance_name</span><span class="p">,</span> <span class="n">requirements</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">affordance_types</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># Check if object meets requirements for this affordance</span>
                <span class="n">qualifies</span> <span class="o">=</span> <span class="kc">True</span>
                
                <span class="k">for</span> <span class="n">req_name</span><span class="p">,</span> <span class="n">req_value</span> <span class="ow">in</span> <span class="n">requirements</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">req_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                        <span class="n">qualifies</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">break</span>
                    
                    <span class="k">if</span> <span class="n">req_name</span> <span class="o">==</span> <span class="s1">&#39;min_size&#39;</span> <span class="ow">and</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">req_value</span><span class="p">:</span>
                        <span class="n">qualifies</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">break</span>
                    <span class="k">elif</span> <span class="n">req_name</span> <span class="o">==</span> <span class="s1">&#39;max_size&#39;</span> <span class="ow">and</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">req_value</span><span class="p">:</span>
                        <span class="n">qualifies</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">break</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">req_value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="p">[</span><span class="n">req_name</span><span class="p">]</span> <span class="o">!=</span> <span class="n">req_value</span><span class="p">:</span>
                        <span class="n">qualifies</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">break</span>
                
                <span class="c1"># Check if robot can execute the affordance</span>
                <span class="k">if</span> <span class="n">qualifies</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">affordance_name</span> <span class="o">==</span> <span class="s1">&#39;liftable&#39;</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;weight_est&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">robot_capabilities</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;max_lift&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">qualifies</span> <span class="o">=</span> <span class="kc">False</span>
                    
                    <span class="k">if</span> <span class="n">affordance_name</span> <span class="o">==</span> <span class="s1">&#39;graspable&#39;</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">robot_capabilities</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;max_grasp&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">qualifies</span> <span class="o">=</span> <span class="kc">False</span>
                
                <span class="k">if</span> <span class="n">qualifies</span><span class="p">:</span>
                    <span class="n">obj_affordances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">affordance_name</span><span class="p">)</span>
            
            <span class="n">affordances</span><span class="p">[</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">obj_affordances</span>
        
        <span class="k">return</span> <span class="n">affordances</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">affordance_to_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">affordance</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert an affordance to specific action parameters</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - obj: Object with the affordance</span>
<span class="sd">        - affordance: Affordance type</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - action: Action parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">affordance</span> <span class="o">==</span> <span class="s1">&#39;graspable&#39;</span><span class="p">:</span>
            <span class="c1"># Determine grasp parameters based on object properties</span>
            <span class="n">width</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;width&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="mf">0.08</span><span class="p">)</span>  <span class="c1"># Max gripper width</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># Grasp in the middle</span>
            
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;action_type&#39;</span><span class="p">:</span> <span class="s1">&#39;grasp&#39;</span><span class="p">,</span>
                <span class="s1">&#39;position&#39;</span><span class="p">:</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">],</span>
                <span class="s1">&#39;approach_vector&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># Approach from above</span>
                <span class="s1">&#39;gripper_width&#39;</span><span class="p">:</span> <span class="n">width</span><span class="p">,</span>
                <span class="s1">&#39;grasp_height&#39;</span><span class="p">:</span> <span class="n">height</span>
            <span class="p">}</span>
        
        <span class="k">elif</span> <span class="n">affordance</span> <span class="o">==</span> <span class="s1">&#39;pushable&#39;</span><span class="p">:</span>
            <span class="c1"># Determine pushing parameters</span>
            <span class="n">push_dir</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Default push direction</span>
            <span class="k">if</span> <span class="s1">&#39;preferred_push_dir&#39;</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                <span class="n">push_dir</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;preferred_push_dir&#39;</span><span class="p">]</span>
                
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;action_type&#39;</span><span class="p">:</span> <span class="s1">&#39;push&#39;</span><span class="p">,</span>
                <span class="s1">&#39;position&#39;</span><span class="p">:</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">],</span>
                <span class="s1">&#39;push_direction&#39;</span><span class="p">:</span> <span class="n">push_dir</span><span class="p">,</span>
                <span class="s1">&#39;push_distance&#39;</span><span class="p">:</span> <span class="mf">0.1</span>
            <span class="p">}</span>
        
        <span class="c1"># Other affordances would have their own action mappings</span>
        
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;action_type&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">update_from_experience</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">affordance</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">success</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update affordance models from action experience</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - obj: Object that was acted upon</span>
<span class="sd">        - affordance: Affordance that was utilized</span>
<span class="sd">        - action: Action that was performed</span>
<span class="sd">        - success: Whether the action was successful</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj_id</span> <span class="o">=</span> <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
        
        <span class="c1"># Initialize history for this object if needed</span>
        <span class="k">if</span> <span class="n">obj_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_success_history</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">action_success_history</span><span class="p">[</span><span class="n">obj_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="c1"># Initialize history for this affordance if needed</span>
        <span class="k">if</span> <span class="n">affordance</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_success_history</span><span class="p">[</span><span class="n">obj_id</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">action_success_history</span><span class="p">[</span><span class="n">obj_id</span><span class="p">][</span><span class="n">affordance</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Record success/failure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_success_history</span><span class="p">[</span><span class="n">obj_id</span><span class="p">][</span><span class="n">affordance</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="n">action</span><span class="p">,</span>
            <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="n">success</span><span class="p">,</span>
            <span class="s1">&#39;object_state&#39;</span><span class="p">:</span> <span class="n">obj</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="p">})</span>
        
        <span class="c1"># Update affordance requirements based on experience</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action_success_history</span><span class="p">[</span><span class="n">obj_id</span><span class="p">][</span><span class="n">affordance</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_refine_affordance_model</span><span class="p">(</span><span class="n">affordance</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_refine_affordance_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">affordance</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Refine affordance model based on action history (placeholder)&quot;&quot;&quot;</span>
        <span class="c1"># This would analyze success/failure patterns to refine affordance detection</span>
        <span class="c1"># For example, adjusting size thresholds, weight limits, etc.</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>Affordance-based approaches offer several benefits:</p>
<ol class="arabic simple">
<li><p><strong>Bridging perception and action</strong>: Direct mapping from perceptual features to action possibilities</p></li>
<li><p><strong>Efficiency</strong>: Focus on action-relevant properties rather than full scene understanding</p></li>
<li><p><strong>Transfer learning</strong>: Affordances can generalize across objects with similar action-relevant properties</p></li>
</ol>
</section>
<section id="human-robot-collaboration-and-social-robotics">
<h2>22.4 Human-Robot Collaboration and Social Robotics<a class="headerlink" href="#human-robot-collaboration-and-social-robotics" title="Link to this heading">#</a></h2>
<p>Robots increasingly need to collaborate with humans, requiring social capabilities inspired by neuroscience research on social cognition.</p>
<section id="shared-control-and-collaborative-tasks">
<h3>22.4.1 Shared Control and Collaborative Tasks<a class="headerlink" href="#shared-control-and-collaborative-tasks" title="Link to this heading">#</a></h3>
<p>Effective human-robot collaboration requires shared understanding of tasks and goals:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CollaborativeRobot</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Robot system designed for human collaboration</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Task models - structured representations of collaborative tasks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_models</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="c1"># Joint attention system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attention_system</span> <span class="o">=</span> <span class="n">JointAttentionSystem</span><span class="p">()</span>
        
        <span class="c1"># Intent prediction model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intent_predictor</span> <span class="o">=</span> <span class="n">IntentPredictor</span><span class="p">()</span>
        
        <span class="c1"># Adaptive action system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_planner</span> <span class="o">=</span> <span class="n">AdaptiveActionPlanner</span><span class="p">()</span>
        
        <span class="c1"># Communication module</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">communicator</span> <span class="o">=</span> <span class="n">FeedbackCommunicator</span><span class="p">()</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">observe_human</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">human_state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Process observations of human collaborator</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - human_state: Dict with human pose, gaze, actions, etc.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - processed_state: Processed human state information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Track human attention</span>
        <span class="n">attended_location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attention_system</span><span class="o">.</span><span class="n">infer_attention</span><span class="p">(</span>
            <span class="n">human_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;head_pose&#39;</span><span class="p">),</span>
            <span class="n">human_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;gaze_direction&#39;</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Predict human intent</span>
        <span class="n">intent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">intent_predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
            <span class="n">human_state</span><span class="p">,</span>
            <span class="n">history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">intent_predictor</span><span class="o">.</span><span class="n">history</span>
        <span class="p">)</span>
        
        <span class="c1"># Update internal state</span>
        <span class="n">processed_state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;attention&#39;</span><span class="p">:</span> <span class="n">attended_location</span><span class="p">,</span>
            <span class="s1">&#39;intent&#39;</span><span class="p">:</span> <span class="n">intent</span><span class="p">,</span>
            <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="n">human_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;action&#39;</span><span class="p">),</span>
            <span class="s1">&#39;pose&#39;</span><span class="p">:</span> <span class="n">human_state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pose&#39;</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">processed_state</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_complementary_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">human_state</span><span class="p">,</span> <span class="n">task_context</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate action that complements human&#39;s activity</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - human_state: Processed human state</span>
<span class="sd">        - task_context: Current task context</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - action: Action parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Select active task model</span>
        <span class="n">task_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_models</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">task_context</span><span class="p">[</span><span class="s1">&#39;task_id&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">task_model</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;action_type&#39;</span><span class="p">:</span> <span class="s1">&#39;idle&#39;</span><span class="p">}</span>
        
        <span class="c1"># Determine role allocation</span>
        <span class="n">human_subtask</span> <span class="o">=</span> <span class="n">human_state</span><span class="p">[</span><span class="s1">&#39;intent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subtask&#39;</span><span class="p">)</span>
        
        <span class="c1"># Find complementary subtask</span>
        <span class="n">robot_subtask</span> <span class="o">=</span> <span class="n">task_model</span><span class="o">.</span><span class="n">get_complementary_subtask</span><span class="p">(</span><span class="n">human_subtask</span><span class="p">)</span>
        
        <span class="c1"># Plan action for this subtask</span>
        <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_planner</span><span class="o">.</span><span class="n">plan</span><span class="p">(</span>
            <span class="n">robot_subtask</span><span class="p">,</span>
            <span class="n">human_state</span><span class="p">,</span>
            <span class="n">task_context</span>
        <span class="p">)</span>
        
        <span class="c1"># Generate appropriate feedback</span>
        <span class="n">feedback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">communicator</span><span class="o">.</span><span class="n">generate_feedback</span><span class="p">(</span>
            <span class="n">action</span><span class="p">,</span>
            <span class="n">human_state</span><span class="p">,</span>
            <span class="n">task_context</span>
        <span class="p">)</span>
        
        <span class="c1"># Combine action and feedback</span>
        <span class="n">action</span><span class="p">[</span><span class="s1">&#39;feedback&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">feedback</span>
        
        <span class="k">return</span> <span class="n">action</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">learn_from_demonstration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">demonstration_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Learn new task model from human demonstration</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - demonstration_data: Recorded human demonstration</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - task_id: ID of the learned task</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Extract task structure</span>
        <span class="n">task_id</span> <span class="o">=</span> <span class="n">demonstration_data</span><span class="p">[</span><span class="s1">&#39;task_id&#39;</span><span class="p">]</span>
        <span class="n">task_steps</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">demonstration_data</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">]:</span>
            <span class="c1"># Analyze step components</span>
            <span class="n">step_model</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;objects&#39;</span><span class="p">:</span> <span class="n">step</span><span class="p">[</span><span class="s1">&#39;objects&#39;</span><span class="p">],</span>
                <span class="s1">&#39;actions&#39;</span><span class="p">:</span> <span class="n">step</span><span class="p">[</span><span class="s1">&#39;actions&#39;</span><span class="p">],</span>
                <span class="s1">&#39;preconditions&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infer_preconditions</span><span class="p">(</span><span class="n">step</span><span class="p">),</span>
                <span class="s1">&#39;effects&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infer_effects</span><span class="p">(</span><span class="n">step</span><span class="p">),</span>
                <span class="s1">&#39;constraints&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infer_constraints</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="n">task_steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step_model</span><span class="p">)</span>
        
        <span class="c1"># Create new task model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_models</span><span class="p">[</span><span class="n">task_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">TaskModel</span><span class="p">(</span>
            <span class="n">task_id</span><span class="o">=</span><span class="n">task_id</span><span class="p">,</span>
            <span class="n">steps</span><span class="o">=</span><span class="n">task_steps</span><span class="p">,</span>
            <span class="n">objects</span><span class="o">=</span><span class="n">demonstration_data</span><span class="p">[</span><span class="s1">&#39;objects&#39;</span><span class="p">],</span>
            <span class="n">goal</span><span class="o">=</span><span class="n">demonstration_data</span><span class="p">[</span><span class="s1">&#39;goal&#39;</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="k">return</span> <span class="n">task_id</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_infer_preconditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Infer preconditions from step data (placeholder)&quot;&quot;&quot;</span>
        <span class="c1"># This would analyze state before the step</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;placeholder&#39;</span><span class="p">:</span> <span class="s1">&#39;preconditions&#39;</span><span class="p">}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_infer_effects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Infer effects from step data (placeholder)&quot;&quot;&quot;</span>
        <span class="c1"># This would analyze state changes after the step</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;placeholder&#39;</span><span class="p">:</span> <span class="s1">&#39;effects&#39;</span><span class="p">}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_infer_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Infer constraints from step data (placeholder)&quot;&quot;&quot;</span>
        <span class="c1"># This would identify constraints on execution</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;placeholder&#39;</span><span class="p">:</span> <span class="s1">&#39;constraints&#39;</span><span class="p">}</span>

<span class="c1"># Placeholder supporting classes</span>
<span class="k">class</span><span class="w"> </span><span class="nc">JointAttentionSystem</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">infer_attention</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head_pose</span><span class="p">,</span> <span class="n">gaze_direction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Infer where human is attending based on head pose and gaze&quot;&quot;&quot;</span>
        <span class="c1"># Placeholder implementation</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">gaze_direction</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        
        <span class="c1"># Simple projection of gaze ray</span>
        <span class="n">attention_point</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">head_pose</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">gaze_direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">head_pose</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">gaze_direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">head_pose</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">gaze_direction</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attention_point</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">attention_point</span>

<span class="k">class</span><span class="w"> </span><span class="nc">IntentPredictor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">human_state</span><span class="p">,</span> <span class="n">history</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict human intent from state and history&quot;&quot;&quot;</span>
        <span class="c1"># Placeholder implementation</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;subtask&#39;</span><span class="p">:</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span> <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AdaptiveActionPlanner</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subtask</span><span class="p">,</span> <span class="n">human_state</span><span class="p">,</span> <span class="n">task_context</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plan action for a subtask considering human state&quot;&quot;&quot;</span>
        <span class="c1"># Placeholder implementation</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;action_type&#39;</span><span class="p">:</span> <span class="n">subtask</span><span class="p">,</span> <span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="p">{}}</span>

<span class="k">class</span><span class="w"> </span><span class="nc">FeedbackCommunicator</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_feedback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">human_state</span><span class="p">,</span> <span class="n">task_context</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate appropriate feedback for current action&quot;&quot;&quot;</span>
        <span class="c1"># Placeholder implementation</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;visual_cue&#39;</span><span class="p">,</span> <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Robot is helping&#39;</span><span class="p">}</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TaskModel</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_id</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">objects</span><span class="p">,</span> <span class="n">goal</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_id</span> <span class="o">=</span> <span class="n">task_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps</span> <span class="o">=</span> <span class="n">steps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="n">objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">goal</span> <span class="o">=</span> <span class="n">goal</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">get_complementary_subtask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">human_subtask</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find complementary subtask to what human is doing&quot;&quot;&quot;</span>
        <span class="c1"># Placeholder implementation</span>
        <span class="k">return</span> <span class="s2">&quot;support_human&quot;</span>
</pre></div>
</div>
<p>Social cues and signals play a critical role in collaboration:</p>
<ol class="arabic simple">
<li><p><strong>Joint attention</strong>: The ability to share attention on the same object or location</p></li>
<li><p><strong>Action prediction</strong>: Anticipating the partner’s next move to coordinate effectively</p></li>
<li><p><strong>Adaptive behavior</strong>: Adjusting plans and actions based on the partner’s state</p></li>
</ol>
</section>
<section id="learning-from-demonstration">
<h3>22.4.2 Learning from Demonstration<a class="headerlink" href="#learning-from-demonstration" title="Link to this heading">#</a></h3>
<p>Robots can learn by observing human demonstrations, leveraging neural mechanisms for imitation learning:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.mixture</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianMixture</span>

<span class="k">class</span><span class="w"> </span><span class="nc">LearningFromDemonstration</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        System for learning actions from human demonstrations</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_models</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context_classifier</span> <span class="o">=</span> <span class="kc">None</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">process_demonstrations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">demonstrations</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Process multiple demonstrations of the same task</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - demonstrations: List of demonstration trajectories</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - model_id: ID of the learned action model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Extract context features for all demonstrations</span>
        <span class="n">contexts</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_extract_context</span><span class="p">(</span><span class="n">demo</span><span class="p">)</span> <span class="k">for</span> <span class="n">demo</span> <span class="ow">in</span> <span class="n">demonstrations</span><span class="p">]</span>
        
        <span class="c1"># Extract trajectories for all demonstrations</span>
        <span class="n">trajectories</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_extract_trajectory</span><span class="p">(</span><span class="n">demo</span><span class="p">)</span> <span class="k">for</span> <span class="n">demo</span> <span class="ow">in</span> <span class="n">demonstrations</span><span class="p">]</span>
        
        <span class="c1"># Train context classifier</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_train_context_classifier</span><span class="p">(</span><span class="n">contexts</span><span class="p">)</span>
        
        <span class="c1"># Learn action model from trajectories</span>
        <span class="n">model_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;action_model_</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">action_models</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        
        <span class="c1"># Use probabilistic model to represent demonstrated actions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_models</span><span class="p">[</span><span class="n">model_id</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_train_action_model</span><span class="p">(</span><span class="n">trajectories</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">model_id</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">start_state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate action trajectory for given context</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - context: Current context features</span>
<span class="sd">        - start_state: Starting state for action generation</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - trajectory: Generated action trajectory</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Classify context to find most relevant action model</span>
        <span class="n">model_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_classify_context</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">model_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_models</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        
        <span class="c1"># Use action model to generate trajectory</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action_models</span><span class="p">[</span><span class="n">model_id</span><span class="p">]</span>
        <span class="n">trajectory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_from_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">start_state</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">trajectory</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">demonstration</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract context features from demonstration (placeholder)&quot;&quot;&quot;</span>
        <span class="c1"># This would extract relevant context features</span>
        <span class="c1"># such as object positions, relationships, etc.</span>
        <span class="k">if</span> <span class="s1">&#39;context&#39;</span> <span class="ow">in</span> <span class="n">demonstration</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">demonstration</span><span class="p">[</span><span class="s1">&#39;context&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">{}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">demonstration</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extract normalized trajectory from demonstration&quot;&quot;&quot;</span>
        <span class="c1"># Get raw trajectory points</span>
        <span class="k">if</span> <span class="s1">&#39;trajectory&#39;</span> <span class="ow">in</span> <span class="n">demonstration</span><span class="p">:</span>
            <span class="n">traj</span> <span class="o">=</span> <span class="n">demonstration</span><span class="p">[</span><span class="s1">&#39;trajectory&#39;</span><span class="p">]</span>
            
            <span class="c1"># Normalize time</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">point</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">traj</span><span class="p">)])</span>
            <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
            
            <span class="c1"># Extract state variables</span>
            <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">point</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;position&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">])</span>
            <span class="n">velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">point</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;velocity&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">traj</span><span class="p">])</span>
            
            <span class="c1"># Combine into state-time pairs</span>
            <span class="n">trajectory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">t</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">velocities</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">trajectory</span>
        
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_train_context_classifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contexts</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Train classifier to map contexts to action models (placeholder)&quot;&quot;&quot;</span>
        <span class="c1"># This would train a classifier to map context features</span>
        <span class="c1"># to appropriate action models</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context_classifier</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;placeholder&quot;</span><span class="p">:</span> <span class="s2">&quot;classifier&quot;</span><span class="p">}</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_train_action_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trajectories</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Train probabilistic model from demonstrated trajectories&quot;&quot;&quot;</span>
        <span class="c1"># Combine all trajectories</span>
        <span class="n">all_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">trajectories</span><span class="p">)</span>
        
        <span class="c1"># Fit GMM to capture distribution of states over time</span>
        <span class="n">n_components</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_points</span><span class="p">)</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># Heuristic</span>
        <span class="n">gmm</span> <span class="o">=</span> <span class="n">GaussianMixture</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span>
        <span class="n">gmm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">all_points</span><span class="p">)</span>
        
        <span class="c1"># Create dynamic model (placeholder)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;gmm&#39;</span><span class="p">:</span> <span class="n">gmm</span><span class="p">,</span>
            <span class="s1">&#39;trajectories&#39;</span><span class="p">:</span> <span class="n">trajectories</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">model</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_classify_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Classify context to select action model (placeholder)&quot;&quot;&quot;</span>
        <span class="c1"># This would use the context classifier to select</span>
        <span class="c1"># the most appropriate action model</span>
        <span class="k">return</span> <span class="s2">&quot;action_model_0&quot;</span>  <span class="c1"># Default</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_from_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">start_state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate trajectory from probabilistic model (placeholder)&quot;&quot;&quot;</span>
        <span class="c1"># This would generate a new trajectory from the model</span>
        <span class="c1"># conditioned on the start state</span>
        <span class="n">gmm</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="s1">&#39;gmm&#39;</span><span class="p">]</span>
        
        <span class="c1"># Sample trajectory (highly simplified)</span>
        <span class="n">n_points</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="n">trajectory</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Simple generation heuristic</span>
        <span class="n">current_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">start_state</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">time_point</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>
            <span class="c1"># Predict next state</span>
            <span class="n">state_with_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="n">time_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">current_state</span><span class="p">))</span>
            
            <span class="c1"># Sample from GMM (simplified)</span>
            <span class="n">means</span> <span class="o">=</span> <span class="n">gmm</span><span class="o">.</span><span class="n">means_</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">gmm</span><span class="o">.</span><span class="n">weights_</span>
            
            <span class="c1"># Find closest component in time</span>
            <span class="n">time_diffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">means</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">time_point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">closest_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">time_diffs</span><span class="p">)</span>
            
            <span class="c1"># Use mean of closest component</span>
            <span class="n">next_state</span> <span class="o">=</span> <span class="n">means</span><span class="p">[</span><span class="n">closest_idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>
            
            <span class="c1"># Add to trajectory</span>
            <span class="n">trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">time_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                <span class="s1">&#39;position&#39;</span><span class="p">:</span> <span class="n">next_state</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                <span class="s1">&#39;velocity&#39;</span><span class="p">:</span> <span class="n">next_state</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="p">})</span>
            
            <span class="n">current_state</span> <span class="o">=</span> <span class="n">next_state</span>
        
        <span class="k">return</span> <span class="n">trajectory</span>
</pre></div>
</div>
<p>Learning from demonstration taps into mechanisms similar to those humans use for social learning:</p>
<ol class="arabic simple">
<li><p><strong>Goal inference</strong>: Understanding the demonstrator’s objective</p></li>
<li><p><strong>Context sensitivity</strong>: Learning when and how to apply the demonstrated skills</p></li>
<li><p><strong>Generalization</strong>: Adapting learned skills to new situations</p></li>
</ol>
</section>
</section>
<section id="code-lab-simple-neuro-inspired-robot-controller">
<h2>22.5 Code Lab: Simple Neuro-Inspired Robot Controller<a class="headerlink" href="#code-lab-simple-neuro-inspired-robot-controller" title="Link to this heading">#</a></h2>
<p>Let’s implement a simplified robot controller that integrates several brain-inspired principles:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="kn">import</span> <span class="n">FuncAnimation</span>

<span class="k">class</span><span class="w"> </span><span class="nc">NeuroBotController</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Neuro-inspired robot controller integrating multiple brain-like mechanisms</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Motor primitive system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_primitives</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_motors</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Left and right wheel motors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">primitives</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_primitives</span><span class="p">()</span>
        
        <span class="c1"># Predictive forward model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">W_forward</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># Predicts [dx, dy, dθ] from [left, right]</span>
        
        <span class="c1"># Cerebellar adaptive component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">W_cerebellum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>  <span class="c1"># Corrective signal for motor commands</span>
        
        <span class="c1"># Sensory system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># 5 directional distance sensors</span>
        
        <span class="c1"># Place cell system for navigation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">place_cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_place_cells</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>  <span class="c1"># 20 place cells</span>
        
        <span class="c1"># Learning rates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_lr</span> <span class="o">=</span> <span class="mf">0.01</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cerebellum_lr</span> <span class="o">=</span> <span class="mf">0.005</span>
        
        <span class="c1"># Experience buffer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experience_buffer</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># Performance metrics</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prediction_errors</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_create_primitives</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create set of motor primitives&quot;&quot;&quot;</span>
        <span class="n">primitives</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_primitives</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_motors</span><span class="p">))</span>
        
        <span class="c1"># Forward motion</span>
        <span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
        
        <span class="c1"># Turn left</span>
        <span class="n">primitives</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
        
        <span class="c1"># Turn right</span>
        <span class="n">primitives</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>
        
        <span class="c1"># Backward motion</span>
        <span class="n">primitives</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]</span>
        
        <span class="c1"># Normalize</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_primitives</span><span class="p">):</span>
            <span class="n">primitives</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">primitives</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        
        <span class="k">return</span> <span class="n">primitives</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">_create_place_cells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_cells</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create place cell centers in 2D environment&quot;&quot;&quot;</span>
        <span class="c1"># Randomly distribute place cells in 10×10 environment</span>
        <span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">n_cells</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        
        <span class="c1"># Each place cell has a preferred heading direction</span>
        <span class="n">preferred_dirs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_cells</span><span class="p">)</span>
        
        <span class="c1"># Combine into place cell definitions</span>
        <span class="n">place_cells</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">centers</span><span class="p">,</span> <span class="n">preferred_dirs</span><span class="p">))</span>
        
        <span class="k">return</span> <span class="n">place_cells</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">sense_environment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">heading</span><span class="p">,</span> <span class="n">obstacles</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get sensory input from environment</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - position: [x, y] position</span>
<span class="sd">        - heading: Heading direction in radians</span>
<span class="sd">        - obstacles: List of obstacle positions</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - sensor_readings: Distance readings from sensors</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sensor_readings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span><span class="p">)</span> <span class="o">*</span> <span class="mf">10.0</span>  <span class="c1"># Max range = 10 units</span>
        
        <span class="c1"># Sensor angles relative to heading</span>
        <span class="n">sensor_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span><span class="p">)</span>
        
        <span class="c1"># Check distance to each obstacle along each sensor direction</span>
        <span class="k">for</span> <span class="n">obstacle</span> <span class="ow">in</span> <span class="n">obstacles</span><span class="p">:</span>
            <span class="n">obs_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">obstacle</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
            <span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">obs_vec</span><span class="p">)</span>
            
            <span class="c1"># Direction to obstacle in global frame</span>
            <span class="n">obs_dir</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">obs_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">obs_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            
            <span class="c1"># Convert to robot frame</span>
            <span class="n">rel_angle</span> <span class="o">=</span> <span class="p">(</span><span class="n">obs_dir</span> <span class="o">-</span> <span class="n">heading</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
            
            <span class="c1"># Find closest sensor</span>
            <span class="n">sensor_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sensor_angles</span> <span class="o">-</span> <span class="n">rel_angle</span><span class="p">))</span>
            
            <span class="c1"># Update sensor if obstacle is within its field of view and closer than previous readings</span>
            <span class="n">angle_diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sensor_angles</span><span class="p">[</span><span class="n">sensor_idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">rel_angle</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">angle_diff</span> <span class="o">&lt;</span> <span class="mf">0.2</span> <span class="ow">and</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="n">sensor_readings</span><span class="p">[</span><span class="n">sensor_idx</span><span class="p">]:</span>
                <span class="n">sensor_readings</span><span class="p">[</span><span class="n">sensor_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span>
        
        <span class="k">return</span> <span class="n">sensor_readings</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">activate_place_cells</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">heading</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate activation of place cells for current position</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - position: [x, y] position</span>
<span class="sd">        - heading: Heading direction in radians</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - activations: Activation level of each place cell</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Calculate distance to each place cell center</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">place_cells</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">position</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        
        <span class="c1"># Place cell activation falls off with distance (Gaussian)</span>
        <span class="n">spatial_activation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">distances</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">)</span>
        
        <span class="c1"># Heading direction modulation</span>
        <span class="n">heading_diffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">place_cells</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">heading</span><span class="p">)</span>
        <span class="n">heading_diffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">heading_diffs</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">heading_diffs</span><span class="p">)</span>
        <span class="n">heading_activation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">heading_diffs</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.0</span><span class="p">)</span>
        
        <span class="c1"># Combine spatial and heading modulation</span>
        <span class="n">activations</span> <span class="o">=</span> <span class="n">spatial_activation</span> <span class="o">*</span> <span class="n">heading_activation</span>
        
        <span class="k">return</span> <span class="n">activations</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_motor_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sensor_readings</span><span class="p">,</span> <span class="n">place_cell_activations</span><span class="p">,</span> <span class="n">goal_position</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate motor command using multiple neural systems</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - sensor_readings: Current sensor readings</span>
<span class="sd">        - place_cell_activations: Current place cell activations</span>
<span class="sd">        - goal_position: [x, y] goal position</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - motor_command: Commands for left and right motors</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 1. Reactive obstacle avoidance</span>
        <span class="n">danger_level</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">sensor_readings</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>
        <span class="n">left_danger</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">danger_level</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">right_danger</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">danger_level</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span><span class="o">//</span><span class="mi">2</span><span class="p">:])</span>
        
        <span class="c1"># Turn away from obstacles</span>
        <span class="n">obstacle_response</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_motors</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">left_danger</span> <span class="o">&gt;</span> <span class="n">right_danger</span><span class="p">:</span>
            <span class="n">obstacle_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># Turn right</span>
        <span class="k">elif</span> <span class="n">right_danger</span> <span class="o">&gt;</span> <span class="n">left_danger</span><span class="p">:</span>
            <span class="n">obstacle_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Turn left</span>
        
        <span class="c1"># 2. Goal-seeking behavior</span>
        <span class="c1"># Compute goal direction and activation</span>
        <span class="n">goal_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">goal_position</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">place_cell_activations</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">place_cell_activations</span><span class="o">.</span><span class="n">sum</span><span class="p">()])</span>
        <span class="n">goal_distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">goal_vec</span><span class="p">)</span>
        
        <span class="n">goal_seeking</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_motors</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">goal_distance</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="c1"># Forward motion with bias toward goal</span>
            <span class="n">goal_seeking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Forward</span>
            
            <span class="c1"># Add turning bias</span>
            <span class="k">if</span> <span class="n">goal_vec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">goal_seeking</span> <span class="o">+=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># Right bias</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">goal_seeking</span> <span class="o">+=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">primitives</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Left bias</span>
        
        <span class="c1"># 3. Cerebellar correction</span>
        <span class="c1"># Expand sensory input using random projection (cerebellum-like)</span>
        <span class="n">expanded_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span><span class="p">))</span> <span class="o">@</span> <span class="n">sensor_readings</span><span class="p">)</span>
        <span class="n">cerebellar_correction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_cerebellum</span> <span class="o">@</span> <span class="n">expanded_input</span>
        
        <span class="c1"># Integrate all components</span>
        <span class="c1"># Obstacle avoidance has highest priority</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1"># Weight for obstacle avoidance vs. goal seeking</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.2</span>   <span class="c1"># Weight for cerebellar correction</span>
        
        <span class="n">motor_command</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">alpha</span> <span class="o">*</span> <span class="n">obstacle_response</span> <span class="o">+</span>
            <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">goal_seeking</span> <span class="o">+</span>
            <span class="n">beta</span> <span class="o">*</span> <span class="n">cerebellar_correction</span>
        <span class="p">)</span>
        
        <span class="c1"># Normalize command to valid range [-1, 1]</span>
        <span class="n">motor_command</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">motor_command</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">motor_command</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">predict_next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_state</span><span class="p">,</span> <span class="n">motor_command</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict next state using forward model</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - current_state: [x, y, θ] current position and heading</span>
<span class="sd">        - motor_command: [left, right] motor commands</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - predicted_next_state: Predicted next state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Predict state change</span>
        <span class="n">predicted_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_forward</span> <span class="o">@</span> <span class="n">motor_command</span>
        
        <span class="c1"># Calculate next state</span>
        <span class="n">predicted_next_state</span> <span class="o">=</span> <span class="n">current_state</span> <span class="o">+</span> <span class="n">predicted_change</span>
        
        <span class="k">return</span> <span class="n">predicted_next_state</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">update_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_state</span><span class="p">,</span> <span class="n">motor_command</span><span class="p">,</span> <span class="n">next_state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update internal models based on experience</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - current_state: [x, y, θ] state before action</span>
<span class="sd">        - motor_command: [left, right] executed motor command</span>
<span class="sd">        - next_state: [x, y, θ] state after action</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - prediction_error: Magnitude of prediction error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Observed state change</span>
        <span class="n">actual_change</span> <span class="o">=</span> <span class="n">next_state</span> <span class="o">-</span> <span class="n">current_state</span>
        
        <span class="c1"># Predicted state change</span>
        <span class="n">predicted_change</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_forward</span> <span class="o">@</span> <span class="n">motor_command</span>
        
        <span class="c1"># Prediction error</span>
        <span class="n">prediction_error</span> <span class="o">=</span> <span class="n">actual_change</span> <span class="o">-</span> <span class="n">predicted_change</span>
        <span class="n">error_magnitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">prediction_error</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prediction_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_magnitude</span><span class="p">)</span>
        
        <span class="c1"># Update forward model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">W_forward</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward_lr</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">prediction_error</span><span class="p">,</span> <span class="n">motor_command</span><span class="p">)</span> 
        
        <span class="c1"># Store experience for later learning</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experience_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;state&#39;</span><span class="p">:</span> <span class="n">current_state</span><span class="p">,</span>
            <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="n">motor_command</span><span class="p">,</span>
            <span class="s1">&#39;next_state&#39;</span><span class="p">:</span> <span class="n">next_state</span><span class="p">,</span>
            <span class="s1">&#39;prediction_error&#39;</span><span class="p">:</span> <span class="n">prediction_error</span>
        <span class="p">})</span>
        
        <span class="c1"># Limit buffer size</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experience_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experience_buffer</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="c1"># Update cerebellar model from random experiences (replay)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experience_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="c1"># Sample random experience</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experience_buffer</span><span class="p">))</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experience_buffer</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            
            <span class="c1"># Expand sensory representation</span>
            <span class="n">expanded_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span><span class="p">))</span> 
                                     <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_sensors</span><span class="p">))</span>  <span class="c1"># Simplified</span>
            
            <span class="c1"># Update cerebellar weights to reduce prediction error</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">W_cerebellum</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cerebellum_lr</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">exp</span><span class="p">[</span><span class="s1">&#39;prediction_error&#39;</span><span class="p">][:</span><span class="mi">2</span><span class="p">],</span> <span class="n">expanded_input</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">error_magnitude</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">visualize_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">,</span> <span class="n">obstacles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">goal</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Visualize robot trajectory</span>
<span class="sd">        </span>
<span class="sd">        Parameters:</span>
<span class="sd">        - trajectory: List of [x, y, θ] states</span>
<span class="sd">        - obstacles: Optional list of obstacle positions</span>
<span class="sd">        - goal: Optional goal position</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">        - fig: Matplotlib figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        
        <span class="c1"># Plot obstacles</span>
        <span class="k">if</span> <span class="n">obstacles</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">obstacles</span><span class="p">:</span>
                <span class="n">circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>
        
        <span class="c1"># Plot goal</span>
        <span class="k">if</span> <span class="n">goal</span><span class="p">:</span>
            <span class="n">circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="n">goal</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>
        
        <span class="c1"># Plot trajectory</span>
        <span class="n">trajectory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">trajectory</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">trajectory</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">trajectory</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
        
        <span class="c1"># Robot representation</span>
        <span class="n">robot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">robot</span><span class="p">)</span>
        
        <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">trajectory</span><span class="p">):</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">θ</span> <span class="o">=</span> <span class="n">trajectory</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="c1"># Update robot position and orientation</span>
                <span class="n">robot</span><span class="o">.</span><span class="n">set_xy</span><span class="p">([</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">y</span> <span class="o">-</span> <span class="mf">0.15</span><span class="p">])</span>
                <span class="n">trans</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">rotate_around</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">θ</span><span class="p">)</span>
                <span class="n">robot</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">trans</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">robot</span><span class="p">,</span>
        
        <span class="c1"># Create animation</span>
        <span class="n">anim</span> <span class="o">=</span> <span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">trajectory</span><span class="p">),</span> 
                             <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="c1"># Set plot limits and labels</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Robot Trajectory&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">anim</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_learning_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot learning curve of prediction errors&quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prediction_errors</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Learning Step&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Prediction Error&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Forward Model Learning Curve&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">fig</span>

<span class="c1"># Example usage</span>
<span class="k">def</span><span class="w"> </span><span class="nf">run_robot_simulation</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run robot simulation with the neuro-inspired controller</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    - controller: NeuroBotController instance</span>
<span class="sd">    - n_steps: Number of simulation steps</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    - trajectory: Recorded robot trajectory</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Environment setup</span>
    <span class="n">obstacles</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="n">goal</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
    
    <span class="c1"># Initial state</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># [x, y, θ]</span>
    <span class="n">trajectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">state</span><span class="o">.</span><span class="n">copy</span><span class="p">()]</span>
    
    <span class="c1"># Simulation loop</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
        <span class="c1"># Sense environment</span>
        <span class="n">sensor_readings</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">sense_environment</span><span class="p">(</span>
            <span class="n">state</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">obstacles</span>
        <span class="p">)</span>
        
        <span class="c1"># Activate place cells</span>
        <span class="n">place_cell_activations</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">activate_place_cells</span><span class="p">(</span>
            <span class="n">state</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="c1"># Generate motor command</span>
        <span class="n">motor_command</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">generate_motor_command</span><span class="p">(</span>
            <span class="n">sensor_readings</span><span class="p">,</span> <span class="n">place_cell_activations</span><span class="p">,</span> <span class="n">goal</span>
        <span class="p">)</span>
        
        <span class="c1"># Predict next state</span>
        <span class="n">predicted_next_state</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">predict_next_state</span><span class="p">(</span>
            <span class="n">state</span><span class="p">,</span> <span class="n">motor_command</span>
        <span class="p">)</span>
        
        <span class="c1"># Simulate robot movement (simplified physics)</span>
        <span class="c1"># In real robot, this would be the actual physical movement</span>
        <span class="n">next_state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        
        <span class="c1"># Convert motor commands to motion</span>
        <span class="n">speed</span> <span class="o">=</span> <span class="p">(</span><span class="n">motor_command</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">motor_command</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span>
        <span class="n">turn_rate</span> <span class="o">=</span> <span class="p">(</span><span class="n">motor_command</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">motor_command</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mf">0.5</span>
        
        <span class="c1"># Update position and orientation</span>
        <span class="n">next_state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">turn_rate</span> <span class="o">*</span> <span class="mf">0.1</span>  <span class="c1"># Update heading</span>
        <span class="n">next_state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">speed</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">next_state</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span>  <span class="c1"># Update x</span>
        <span class="n">next_state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">speed</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">next_state</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.1</span>  <span class="c1"># Update y</span>
        
        <span class="c1"># Boundary checks (keep within environment)</span>
        <span class="n">next_state</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">next_state</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        
        <span class="c1"># Update models</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">update_models</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">motor_command</span><span class="p">,</span> <span class="n">next_state</span><span class="p">)</span>
        
        <span class="c1"># Update state</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">next_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">trajectory</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
        <span class="c1"># Check if goal reached</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">state</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">goal</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="k">break</span>
    
    <span class="k">return</span> <span class="n">trajectory</span>

<span class="c1"># Create controller and run simulation</span>
<span class="c1"># controller = NeuroBotController()</span>
<span class="c1"># trajectory = run_robot_simulation(controller, 200)</span>
<span class="c1"># fig, anim = controller.visualize_trajectory(trajectory, </span>
<span class="c1">#                                           obstacles=[[3, 3], [5, 7], [7, 4]], </span>
<span class="c1">#                                           goal=[8, 8])</span>
<span class="c1"># learning_fig = controller.plot_learning_curve()</span>
</pre></div>
</div>
<p>This example integrates several neuro-inspired mechanisms:</p>
<ol class="arabic simple">
<li><p><strong>Motor primitives</strong>: Basic movement patterns similar to the brain’s movement synergies</p></li>
<li><p><strong>Forward models</strong>: Predictive coding for anticipating the results of actions</p></li>
<li><p><strong>Cerebellar-like correction</strong>: Adaptive fine-tuning of movements based on experience</p></li>
<li><p><strong>Place cells</strong>: Hippocampus-inspired spatial representation for navigation</p></li>
</ol>
</section>
<section id="take-aways">
<h2>22.6 Take-aways<a class="headerlink" href="#take-aways" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Embodiment is essential for intelligence</strong>: Physical interaction with the environment shapes learning and cognition</p></li>
<li><p><strong>Brain-inspired control architectures</strong> offer alternatives to traditional planning-sensing-acting loops</p></li>
<li><p><strong>Predictive coding</strong> principles can improve control by anticipating the sensory consequences of actions</p></li>
<li><p><strong>Motor primitives</strong> provide an efficient framework for complex movement generation</p></li>
<li><p><strong>Social robotics</strong> requires specialized mechanisms for interaction, similar to the brain’s social cognition areas</p></li>
<li><p><strong>Affordance-based perception</strong> links perception directly to action possibilities, bridging the gap between seeing and doing</p></li>
</ul>
</section>
<section id="further-reading">
<h2>22.7 Further Reading<a class="headerlink" href="#further-reading" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Pfeifer, R., &amp; Bongard, J. (2006). <a class="reference external" href="https://mitpress.mit.edu/books/how-body-shapes-way-we-think">How the Body Shapes the Way We Think: A New View of Intelligence</a>. MIT Press. Explores the fundamental role of embodiment in intelligence.</p></li>
<li><p>Wolpert, D. M., &amp; Ghahramani, Z. (2000). <a class="reference external" href="https://www.nature.com/articles/nn0900_1212">Computational principles of movement neuroscience</a>. Nature Neuroscience, 3(11), 1212-1217. Discusses predictive forward models in motor control.</p></li>
<li><p>Brooks, R. A. (1991). <a class="reference external" href="https://people.csail.mit.edu/brooks/papers/representation.pdf">Intelligence without representation</a>. Artificial Intelligence, 47(1-3), 139-159. Classic paper on reactive, behavior-based robotics.</p></li>
<li><p>Abbeel, P., &amp; Ng, A. Y. (2004). <a class="reference external" href="https://dl.acm.org/doi/10.1145/1015330.1015430">Apprenticeship learning via inverse reinforcement learning</a>. Proceedings of the Twenty-first International Conference on Machine Learning (ICML). Explores learning from human demonstrations.</p></li>
<li><p>Gibson, J. J. (1979). <a class="reference external" href="https://www.taylorfrancis.com/books/mono/10.4324/9781315740218/ecological-approach-visual-perception-james-gibson">The Ecological Approach to Visual Perception</a>. Psychology Press. Foundational work on affordances.</p></li>
<li><p>Kawato, M. (1999). <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0959438899000288">Internal models for motor control and trajectory planning</a>. Current Opinion in Neurobiology, 9(6), 718-727. Reviews cerebellar models and their applications in robotics.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "executablebooks/jupyter-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./part6"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ch21_ai_for_neuro_discovery.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 21: AI for Neuroscience Discovery</p>
      </div>
    </a>
    <a class="right-next"
       href="ch24_quantum_computing_neuroai.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 24: Quantum Computing and NeuroAI</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-goals">22.0 Chapter Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#from-disembodied-algorithms-to-grounded-intelligence">22.1 From Disembodied Algorithms to Grounded Intelligence</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-embodiment-hypothesis">22.1.1 The Embodiment Hypothesis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#brain-inspired-control-architectures">22.1.2 Brain-Inspired Control Architectures</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#neuroscience-inspired-sensorimotor-control">22.2 Neuroscience-Inspired Sensorimotor Control</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#motor-primitives-and-synergies">22.2.1 Motor Primitives and Synergies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predictive-coding-and-forward-models">22.2.2 Predictive Coding and Forward Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cerebellar-inspired-adaptive-control">22.2.3 Cerebellar-Inspired Adaptive Control</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#affordances-and-action-centered-perception">22.3 Affordances and Action-Centered Perception</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#human-robot-collaboration-and-social-robotics">22.4 Human-Robot Collaboration and Social Robotics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shared-control-and-collaborative-tasks">22.4.1 Shared Control and Collaborative Tasks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-from-demonstration">22.4.2 Learning from Demonstration</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-lab-simple-neuro-inspired-robot-controller">22.5 Code Lab: Simple Neuro-Inspired Robot Controller</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#take-aways">22.6 Take-aways</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading">22.7 Further Reading</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Richard Young
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>