
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 5: Default-Mode vs Executive Control Networks &#8212; The Neuroscience of AI</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'part2/ch05_brain_networks';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="canonical" href="https://neuroai-handbook.github.io/part2/ch05_brain_networks.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Chapter 6: Neurostimulation &amp; Plasticity" href="ch06_neurostimulation.html" />
    <link rel="prev" title="Chapter 4: Perception Pipeline – Visual Cortex → CNNs" href="../part1/ch04_perception_pipeline.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nai.png" class="logo__image only-light" alt="The Neuroscience of AI - Home"/>
    <script>document.write(`<img src="../_static/nai.png" class="logo__image only-dark" alt="The Neuroscience of AI - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    The Neuroscience of AI
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Part I · Brains &amp; Inspiration</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part1/ch01_intro.html">Chapter 1: Introduction to Neuroscience ↔ AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part1/ch02_neuro_foundations.html">Chapter 2: Neuroscience Foundations for AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part1/ch03_spatial_navigation.html">Chapter 3: Spatial Navigation – Place &amp; Grid Cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part1/ch04_perception_pipeline.html">Chapter 4: Perception Pipeline – Visual Cortex → CNNs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part II · Brains Meet Math &amp; Data</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 5: Default-Mode vs Executive Control Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch06_neurostimulation.html">Chapter 6: Neurostimulation &amp; Plasticity</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch07_information_theory.html">Chapter 7: Information Theory Essentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch08_data_science_pipeline.html">Chapter 8: Data-Science Pipeline in Python</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part III · Learning Machines</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part3/ch09_ml_foundations.html">Chapter 9: Classical Machine-Learning Foundations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part3/ch10_deep_learning.html">Chapter 10: Deep Learning: Training &amp; Optimisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part3/ch11_sequence_models.html">Chapter 11: Sequence Models: RNN → Attention → Transformer</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part IV · Frontier Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part4/ch12_large_language_models.html">Chapter 12: Large Language Models &amp; Fine-Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part4/ch13_multimodal_models.html">Chapter 13: Multimodal &amp; Diffusion Models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part V · Ethics &amp; Futures</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part5/ch15_ethical_ai.html">Chapter 15: Ethical AI - Considerations for NeuroAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part5/ch16_future_directions.html">Chapter 16: Where Next for Neuro-AI?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part VI · Advanced Applications</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part6/ch17_bci_human_ai_interfaces.html">Brain-Computer Interfaces and Human-AI Interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part6/ch18_neuromorphic_computing.html">Chapter 18: Neuromorphic Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part6/ch19_cognitive_neuro_dl.html">Cognitive Neuroscience and Deep Learning</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../part6/ch20_case_studies.html">Case Studies in NeuroAI</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../part6/ch20_interactive.html">Interactive NeuroAI Case Studies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part6/jupyter_ai_demo.html">AI-Assisted Learning with Jupyter AI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part6/rise_slides_demo.html">Creating Presentations with RISE</a></li>


</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../part6/ch21_ai_for_neuro_discovery.html">Chapter 21: AI for Neuroscience Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part6/ch22_embodied_ai_robotics.html">Chapter 22: Embodied AI and Robotics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part6/ch24_quantum_computing_neuroai.html">Chapter 24: Quantum Computing and NeuroAI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part6/ch23_lifelong_learning.html">Chapter 23: Lifelong Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendices/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/math_python_refresher.html">Appendix A: Math &amp; Python Mini-Refresher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/dataset_catalogue.html">Appendix B: Dataset Catalogue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendices/colab_setup.html">Appendix C: Google Colab Setup for NeuroAI</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/edit/master/docs/part2/ch05_brain_networks.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fpart2/ch05_brain_networks.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/part2/ch05_brain_networks.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 5: Default-Mode vs Executive Control Networks</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-goals">5.0 Chapter Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#network-neuroscience-fundamentals">5.1 Network Neuroscience Fundamentals</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#from-local-circuits-to-distributed-networks">From Local Circuits to Distributed Networks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#methods-for-studying-brain-networks">Methods for Studying Brain Networks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functional-vs-structural-connectivity">Functional vs Structural Connectivity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#network-metrics-and-their-interpretation">Network Metrics and Their Interpretation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-default-mode-network-dmn">5.2 The Default Mode Network (DMN)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discovery-and-components">Discovery and Components</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#self-referential-processing">Self-Referential Processing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mind-wandering-and-creativity">Mind-Wandering and Creativity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relation-to-memory-and-imagination">Relation to Memory and Imagination</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#executive-control-networks">5.3 Executive Control Networks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frontoparietal-control-network">Frontoparietal Control Network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#salience-network">Salience Network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cognitive-control-functions">Cognitive Control Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#working-memory-and-attention">Working Memory and Attention</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#network-interactions">5.4 Network Interactions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#anti-correlation-and-competitive-dynamics">Anti-Correlation and Competitive Dynamics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-positive-vs-task-negative-networks">Task-Positive vs Task-Negative Networks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamic-network-reconfiguration">Dynamic Network Reconfiguration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#balance-and-dysregulation-in-disorders">Balance and Dysregulation in Disorders</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-approaches">5.5 Computational Approaches</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graph-theoretical-models">Graph Theoretical Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamic-causal-modeling">Dynamic Causal Modeling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-mass-models">Neural Mass Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#links-to-reservoir-computing">Links to Reservoir Computing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-lab">5.6 Code Lab</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#network-analysis-of-brain-connectivity-data">Network Analysis of Brain Connectivity Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-coupled-oscillator-networks">Simulating Coupled Oscillator Networks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-network-dynamics">Visualizing Network Dynamics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#take-aways">5.7 Take-aways</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#brain-function-emerges-from-network-interactions">Brain Function Emerges from Network Interactions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#balance-between-networks-supports-adaptive-cognition">Balance Between Networks Supports Adaptive Cognition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#network-properties-constrain-and-enable-computation">Network Properties Constrain and Enable Computation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading-media">5.8 Further Reading &amp; Media</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-papers">Key Papers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#books">Books</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#online-resources">Online Resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#videos-and-lectures">Videos and Lectures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tutorials-and-code">Tutorials and Code</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-5-default-mode-vs-executive-control-networks">
<h1>Chapter 5: Default-Mode vs Executive Control Networks<a class="headerlink" href="#chapter-5-default-mode-vs-executive-control-networks" title="Link to this heading">#</a></h1>
<section id="chapter-goals">
<h2>5.0 Chapter Goals<a class="headerlink" href="#chapter-goals" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Understand large-scale brain networks and their functional significance</p></li>
<li><p>Contrast default-mode and executive control networks</p></li>
<li><p>Connect network dynamics to cognitive functions</p></li>
<li><p>Explore computational models of brain network interactions</p></li>
<li><p>Apply network analysis approaches to neural data</p></li>
<li><p>Draw parallels between brain network dynamics and artificial intelligence</p></li>
</ul>
</section>
<section id="network-neuroscience-fundamentals">
<h2>5.1 Network Neuroscience Fundamentals<a class="headerlink" href="#network-neuroscience-fundamentals" title="Link to this heading">#</a></h2>
<section id="from-local-circuits-to-distributed-networks">
<h3>From Local Circuits to Distributed Networks<a class="headerlink" href="#from-local-circuits-to-distributed-networks" title="Link to this heading">#</a></h3>
<p>The brain is not a collection of isolated regions but a highly integrated system of networks spanning different spatial scales. While individual neurons form local circuits through synaptic connections, these circuits in turn connect to form large-scale networks that coordinate activity across brain regions.</p>
<p>Network neuroscience has emerged as a framework to understand how these interconnected systems give rise to cognitive functions and behavior. Rather than focusing on the activity of individual regions, network approaches emphasize the patterns of communication between regions and how these interactions enable complex information processing.</p>
</section>
<section id="methods-for-studying-brain-networks">
<h3>Methods for Studying Brain Networks<a class="headerlink" href="#methods-for-studying-brain-networks" title="Link to this heading">#</a></h3>
<p>Several complementary techniques allow us to observe brain networks in action:</p>
<p><strong>Functional MRI (fMRI)</strong> measures blood-oxygen-level-dependent (BOLD) signals across the brain, providing an indirect measure of neural activity. While its temporal resolution is limited (typically 1-2 seconds), its spatial resolution allows researchers to map functional connections across the entire brain.</p>
<p><strong>Electroencephalography (EEG)</strong> and <strong>Magnetoencephalography (MEG)</strong> detect electrical signals and magnetic fields generated by neuronal activity, respectively. They offer millisecond-level temporal precision but more limited spatial resolution compared to fMRI.</p>
<p><strong>Diffusion MRI</strong> measures the diffusion of water molecules to map structural connections (white matter tracts) between brain regions, providing the physical substrate for network communication.</p>
</section>
<section id="functional-vs-structural-connectivity">
<h3>Functional vs Structural Connectivity<a class="headerlink" href="#functional-vs-structural-connectivity" title="Link to this heading">#</a></h3>
<p>Brain networks can be characterized in two fundamental ways:</p>
<p><strong>Structural connectivity</strong> refers to the physical connections (axonal pathways) linking different brain regions. These anatomical connections, especially long-range white matter tracts, form the physical infrastructure for information transfer.</p>
<p><strong>Functional connectivity</strong> refers to the statistical dependencies between the activity patterns of different brain regions. Two regions with highly correlated activity are considered functionally connected, regardless of whether they share direct structural connections.</p>
<p>While structural connections constrain possible functional interactions, functional connectivity is dynamic and context-dependent, changing with cognitive demands and states of consciousness.</p>
</section>
<section id="network-metrics-and-their-interpretation">
<h3>Network Metrics and Their Interpretation<a class="headerlink" href="#network-metrics-and-their-interpretation" title="Link to this heading">#</a></h3>
<p>Graph theory provides mathematical tools to analyze brain networks, where brain regions are represented as nodes and their connections as edges:</p>
<ul class="simple">
<li><p><strong>Degree</strong>: The number of connections a region has, indicating its connectivity importance</p></li>
<li><p><strong>Clustering coefficient</strong>: The extent to which a region’s neighbors are connected to each other, reflecting local integration</p></li>
<li><p><strong>Path length</strong>: The minimum number of steps needed to travel between two regions, indicating network efficiency</p></li>
<li><p><strong>Modularity</strong>: The degree to which a network can be divided into distinct communities or modules</p></li>
<li><p><strong>Centrality measures</strong>: Metrics that identify hub regions crucial for network communication</p></li>
</ul>
<p>These metrics help characterize network organization and reveal principles of brain function, such as small-world architecture (high clustering with short path lengths) and rich-club organization (highly connected hubs that preferentially connect to each other).</p>
</section>
</section>
<section id="the-default-mode-network-dmn">
<h2>5.2 The Default Mode Network (DMN)<a class="headerlink" href="#the-default-mode-network-dmn" title="Link to this heading">#</a></h2>
<section id="discovery-and-components">
<h3>Discovery and Components<a class="headerlink" href="#discovery-and-components" title="Link to this heading">#</a></h3>
<p>The default mode network (DMN) was discovered serendipitously in the late 1990s. Researchers noticed that certain brain regions consistently showed decreased activity during demanding tasks compared to rest, suggesting a “default mode” of brain function that is active when we are not engaged in explicit tasks.</p>
<p>The core regions of the DMN include:</p>
<ul class="simple">
<li><p><strong>Medial prefrontal cortex (mPFC)</strong>: Involved in self-referential processing and social cognition</p></li>
<li><p><strong>Posterior cingulate cortex (PCC)/precuneus</strong>: Associated with autobiographical memory and self-awareness</p></li>
<li><p><strong>Angular gyri</strong>: Integrative hubs involved in semantic processing and memory</p></li>
<li><p><strong>Hippocampal formation</strong>: Critical for memory encoding and retrieval</p></li>
<li><p><strong>Lateral temporal cortex</strong>: Involved in conceptual processing and semantic memory</p></li>
</ul>
<p><img alt="Default Mode vs Executive Control Networks" src="../_images/brain_networks.svg" /></p>
<p>The DMN is often referred to as a “task-negative” network because its activity typically decreases during externally-directed tasks, though this terminology has been debated as our understanding of its functions has evolved.</p>
</section>
<section id="self-referential-processing">
<h3>Self-Referential Processing<a class="headerlink" href="#self-referential-processing" title="Link to this heading">#</a></h3>
<p>One key function of the DMN is self-referential thinking - reflecting on our own thoughts, feelings, and experiences. The medial prefrontal cortex is particularly active when we think about ourselves, our traits, or our emotional states.</p>
<p>This introspective capacity may underlie metacognition, the ability to monitor and evaluate our own cognitive processes. Self-referential processing also supports social cognition, as we often understand others by referencing our own experiences and mental states.</p>
</section>
<section id="mind-wandering-and-creativity">
<h3>Mind-Wandering and Creativity<a class="headerlink" href="#mind-wandering-and-creativity" title="Link to this heading">#</a></h3>
<p>The DMN is highly active during mind-wandering, when our thoughts drift away from the immediate environment to internally generated content. This “stimulus-independent thought” occurs frequently in daily life - studies suggest people spend 30-50% of their waking hours mind-wandering.</p>
<p>Rather than being purely wasteful, mind-wandering serves important functions:</p>
<ul class="simple">
<li><p>Autobiographical planning</p></li>
<li><p>Creative problem-solving</p></li>
<li><p>Maintaining a sense of personal identity</p></li>
<li><p>Simulating social interactions</p></li>
</ul>
<p>DMN activity has been linked to creative cognition, particularly during the “incubation” phase when we step away from a problem. The network may facilitate the formation of novel associations between previously unconnected ideas, supporting moments of insight.</p>
</section>
<section id="relation-to-memory-and-imagination">
<h3>Relation to Memory and Imagination<a class="headerlink" href="#relation-to-memory-and-imagination" title="Link to this heading">#</a></h3>
<p>The DMN plays a crucial role in both remembering the past and imagining the future. This “mental time travel” relies on the construction of scenes and episodes from stored knowledge, engaging similar neural machinery for both retrospection and prospection.</p>
<p>The hippocampus, which connects with core DMN regions, contributes to this process by retrieving and recombining memory elements into coherent representations. This explains why patients with hippocampal damage show deficits not only in recalling past events but also in imagining novel future scenarios.</p>
<p>The DMN’s role in imagination extends beyond temporal simulations to counterfactual thinking (considering “what might have been”) and creating fictional scenarios, highlighting its broader involvement in generative mental processes.</p>
</section>
</section>
<section id="executive-control-networks">
<h2>5.3 Executive Control Networks<a class="headerlink" href="#executive-control-networks" title="Link to this heading">#</a></h2>
<section id="frontoparietal-control-network">
<h3>Frontoparietal Control Network<a class="headerlink" href="#frontoparietal-control-network" title="Link to this heading">#</a></h3>
<p>The frontoparietal control network (FPCN) is a set of regions primarily including:</p>
<ul class="simple">
<li><p><strong>Dorsolateral prefrontal cortex (dlPFC)</strong>: Critical for working memory and cognitive control</p></li>
<li><p><strong>Anterior cingulate cortex (ACC)</strong>: Involved in performance monitoring and conflict detection</p></li>
<li><p><strong>Posterior parietal cortex</strong>: Supporting attentional selection and goal-directed behavior</p></li>
<li><p><strong>Anterior insula</strong>: Contributing to salience detection and network switching</p></li>
</ul>
<p>This network activates during tasks requiring cognitive control, such as response inhibition, task switching, and working memory maintenance. It is sometimes called a “task-positive” network because its activity typically increases during externally-directed, goal-oriented tasks.</p>
<p>The FPCN is particularly engaged when tasks involve:</p>
<ul class="simple">
<li><p>Maintaining and manipulating information in working memory</p></li>
<li><p>Implementing rule-based behaviors</p></li>
<li><p>Inhibiting prepotent responses</p></li>
<li><p>Flexibly shifting between task demands</p></li>
</ul>
</section>
<section id="salience-network">
<h3>Salience Network<a class="headerlink" href="#salience-network" title="Link to this heading">#</a></h3>
<p>The salience network, anchored by the anterior insula and dorsal anterior cingulate cortex, plays a crucial role in detecting behaviorally relevant stimuli and coordinating network dynamics.</p>
<p>This network acts as a switch between the DMN and the frontoparietal control network, engaging appropriate resources based on current demands. When salient events are detected, the salience network helps transition from introspective processing to goal-directed executive control.</p>
<p>The anterior insula, in particular, is involved in interoception - awareness of internal bodily states - suggesting that physiological signals influence network dynamics and cognitive processing.</p>
</section>
<section id="cognitive-control-functions">
<h3>Cognitive Control Functions<a class="headerlink" href="#cognitive-control-functions" title="Link to this heading">#</a></h3>
<p>Executive control networks support a range of cognitive control functions:</p>
<p><strong>Inhibitory control</strong> allows us to suppress inappropriate responses and resist interference from distractors, critical for maintaining goal-directed behavior in the face of competing stimuli.</p>
<p><strong>Conflict monitoring</strong>, primarily associated with the anterior cingulate cortex, detects when our automatic responses conflict with task goals, signaling the need for increased control.</p>
<p><strong>Task-set maintenance</strong> keeps relevant rules and goals active to guide behavior, while <strong>task-switching</strong> enables flexible shifts between different cognitive operations based on changing demands.</p>
<p>These functions collectively enable adaptive behavior in complex environments, where goals must be maintained despite distractions, and strategies must be adjusted in response to changing circumstances.</p>
</section>
<section id="working-memory-and-attention">
<h3>Working Memory and Attention<a class="headerlink" href="#working-memory-and-attention" title="Link to this heading">#</a></h3>
<p>Working memory—the ability to temporarily maintain and manipulate information—is a core function supported by executive networks, particularly the dorsolateral prefrontal cortex.</p>
<p>Models of working memory have evolved from static “storage buffers” to dynamic processes involving the selective maintenance of relevant information through sustained attention. The frontoparietal network implements this process by:</p>
<ol class="arabic simple">
<li><p>Selecting relevant information for processing</p></li>
<li><p>Maintaining representations through persistent neural activity</p></li>
<li><p>Protecting these representations from interference</p></li>
<li><p>Manipulating information according to task demands</p></li>
</ol>
<p>Attention, closely linked to working memory, involves selecting certain stimuli for enhanced processing while filtering out irrelevant information. Executive networks implement both top-down attentional control (based on goals and expectations) and bottom-up capture (based on stimulus salience).</p>
</section>
</section>
<section id="network-interactions">
<h2>5.4 Network Interactions<a class="headerlink" href="#network-interactions" title="Link to this heading">#</a></h2>
<section id="anti-correlation-and-competitive-dynamics">
<h3>Anti-Correlation and Competitive Dynamics<a class="headerlink" href="#anti-correlation-and-competitive-dynamics" title="Link to this heading">#</a></h3>
<p>One of the most striking findings in network neuroscience is the anti-correlated relationship between the default mode network and executive control networks. When one network increases in activity, the other typically decreases.</p>
<p><img alt="Network Dynamics" src="../_images/network_dynamics.svg" /></p>
<p>This pattern, first observed in resting-state fMRI studies, suggests a competitive relationship between internal, self-generated cognition and external, task-focused attention. The anti-correlation is strongest during demanding cognitive tasks but persists even during rest.</p>
<p>The degree of segregation between these networks has functional significance—reduced anti-correlation has been observed in conditions including aging, ADHD, and schizophrenia, suggesting that appropriate network segregation supports optimal cognitive functioning.</p>
</section>
<section id="task-positive-vs-task-negative-networks">
<h3>Task-Positive vs Task-Negative Networks<a class="headerlink" href="#task-positive-vs-task-negative-networks" title="Link to this heading">#</a></h3>
<p>The terms “task-positive” and “task-negative” emerged from early observations that executive networks increase activity during tasks while the DMN decreases. However, this dichotomy has been challenged by more nuanced findings:</p>
<ol class="arabic simple">
<li><p>The DMN activates during certain types of tasks, particularly those involving social cognition, autobiographical memory, or semantic processing</p></li>
<li><p>Different portions of the DMN show distinct activation patterns during different cognitive states</p></li>
<li><p>The relationship between networks depends on task demands and individual differences</p></li>
</ol>
<p>Rather than strict opposition, these networks may represent complementary modes of cognition that are differentially engaged based on current demands and priorities.</p>
</section>
<section id="dynamic-network-reconfiguration">
<h3>Dynamic Network Reconfiguration<a class="headerlink" href="#dynamic-network-reconfiguration" title="Link to this heading">#</a></h3>
<p>Brain networks are not static but undergo continuous reconfiguration in response to changing cognitive demands. This dynamic reorganization occurs across multiple timescales:</p>
<ul class="simple">
<li><p>Rapid (millisecond to second) reconfiguration in response to immediate demands</p></li>
<li><p>Medium-term (minutes to hours) adjustments reflecting learning or fatigue</p></li>
<li><p>Long-term (days to years) changes corresponding to development or skill acquisition</p></li>
</ul>
<p>Network reconfiguration involves changes in both the strength of connections and the patterns of interaction between networks. Periods of transition between cognitive states show unique network configurations, suggesting that the brain passes through specific “network states” as it shifts between different cognitive operations.</p>
<p>Modern approaches to studying these dynamics include sliding-window analyses, dynamic functional connectivity, and state-space models that capture moment-to-moment fluctuations in network organization.</p>
</section>
<section id="balance-and-dysregulation-in-disorders">
<h3>Balance and Dysregulation in Disorders<a class="headerlink" href="#balance-and-dysregulation-in-disorders" title="Link to this heading">#</a></h3>
<p>The appropriate balance between networks supports adaptive cognition, while dysregulation contributes to various neuropsychiatric conditions:</p>
<ul class="simple">
<li><p><strong>Depression</strong> often involves hyperactivity of the DMN, particularly in regions involved in rumination</p></li>
<li><p><strong>ADHD</strong> is associated with reduced anti-correlation between DMN and executive networks, perhaps contributing to attentional lapses</p></li>
<li><p><strong>Schizophrenia</strong> shows altered connectivity within and between networks, potentially underlying disrupted thought processes</p></li>
<li><p><strong>Autism</strong> features atypical connectivity patterns, particularly in networks supporting social cognition</p></li>
</ul>
<p>These observations have led to reconceptualizing many disorders as “network pathologies” rather than dysfunction of isolated regions. This perspective helps explain why diverse symptoms often co-occur within disorders and why interventions that modulate network dynamics may have broad therapeutic effects.</p>
</section>
</section>
<section id="computational-approaches">
<h2>5.5 Computational Approaches<a class="headerlink" href="#computational-approaches" title="Link to this heading">#</a></h2>
<section id="graph-theoretical-models">
<h3>Graph Theoretical Models<a class="headerlink" href="#graph-theoretical-models" title="Link to this heading">#</a></h3>
<p>Graph theory provides a powerful framework for modeling and analyzing brain networks. In this approach, brain regions are represented as nodes, and their functional or structural connections as edges.</p>
<p>Key graph-theoretical measures applied to brain networks include:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Create a simple brain network graph</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_brain_network</span><span class="p">(</span><span class="n">num_regions</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">connection_density</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a simple brain network using random connections with community structure.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        num_regions: Number of brain regions (nodes)</span>
<span class="sd">        connection_density: Probability of connection between regions</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        G: NetworkX graph representing brain network</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create random adjacency matrix with some structure</span>
    <span class="c1"># (DMN community and Executive community)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># For reproducibility</span>
    <span class="n">adj_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_regions</span><span class="p">,</span> <span class="n">num_regions</span><span class="p">))</span>
    
    <span class="c1"># DMN community (first half of nodes)</span>
    <span class="n">dmn_size</span> <span class="o">=</span> <span class="n">num_regions</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dmn_size</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dmn_size</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">connection_density</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">:</span>  <span class="c1"># Higher within-community density</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span>  <span class="c1"># Stronger weights (0.5-1.0)</span>
                <span class="n">adj_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span>
                <span class="n">adj_matrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span>  <span class="c1"># Symmetric</span>
    
    <span class="c1"># Executive community (second half of nodes)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dmn_size</span><span class="p">,</span> <span class="n">num_regions</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_regions</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">connection_density</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">:</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span>
                <span class="n">adj_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span>
                <span class="n">adj_matrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span>
    
    <span class="c1"># Between-community connections (sparser)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dmn_size</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dmn_size</span><span class="p">,</span> <span class="n">num_regions</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">connection_density</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">:</span>  <span class="c1"># Lower between-community density</span>
                <span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.3</span> <span class="o">+</span> <span class="mf">0.1</span>  <span class="c1"># Weaker weights (0.1-0.4)</span>
                <span class="n">adj_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span>
                <span class="n">adj_matrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">weight</span>
    
    <span class="c1"># Create graph from adjacency matrix</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">adj_matrix</span><span class="p">)</span>
    
    <span class="c1"># Add attributes to nodes</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_regions</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">dmn_size</span><span class="p">:</span>
            <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;network&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;DMN&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;network&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Executive&#39;</span>
    
    <span class="k">return</span> <span class="n">G</span><span class="p">,</span> <span class="n">adj_matrix</span>

<span class="c1"># Calculate common graph theory metrics</span>
<span class="k">def</span><span class="w"> </span><span class="nf">calculate_network_metrics</span><span class="p">(</span><span class="n">G</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate common graph theoretical metrics for the brain network.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        G: NetworkX graph representing brain network</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        metrics: Dictionary of network metrics</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">metrics</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="c1"># Node-level metrics</span>
    <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;degree&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
    <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;clustering&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">clustering</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;betweenness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">betweenness_centrality</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    
    <span class="c1"># Network-level metrics</span>
    <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;avg_path_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">average_shortest_path_length</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>
    <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;global_efficiency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">global_efficiency</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;modularity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">community</span><span class="o">.</span><span class="n">modularity</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> 
                                                  <span class="p">[{</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
                                                    <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;network&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DMN&#39;</span><span class="p">},</span>
                                                   <span class="p">{</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
                                                    <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;network&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Executive&#39;</span><span class="p">}])</span>
    
    <span class="c1"># Small-worldness (approximation)</span>
    <span class="c1"># Compare clustering and path length to random graph</span>
    <span class="n">G_rand</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">random_reference</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">niter</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">C_rand</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">average_clustering</span><span class="p">(</span><span class="n">G_rand</span><span class="p">)</span>
    <span class="n">L_rand</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">average_shortest_path_length</span><span class="p">(</span><span class="n">G_rand</span><span class="p">)</span>
    
    <span class="n">C</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">average_clustering</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">average_shortest_path_length</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    
    <span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;small_worldness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">C</span><span class="o">/</span><span class="n">C_rand</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">L_rand</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">metrics</span>

<span class="c1"># Example usage:</span>
<span class="c1"># G, adj_matrix = create_brain_network(num_regions=20)</span>
<span class="c1"># metrics = calculate_network_metrics(G)</span>
</pre></div>
</div>
<p>These metrics capture important organizational principles:</p>
<ol class="arabic simple">
<li><p><strong>Small-world architecture</strong>: Brain networks show high clustering (efficient local processing) combined with short path lengths (efficient global communication)</p></li>
<li><p><strong>Modularity</strong>: Networks organize into communities with dense within-module connections and sparser between-module connections</p></li>
<li><p><strong>Hub organization</strong>: Certain regions act as highly connected hubs that facilitate communication between modules</p></li>
</ol>
<p>These properties support the efficient integration of information while maintaining specialized processing, balancing segregation and integration.</p>
</section>
<section id="dynamic-causal-modeling">
<h3>Dynamic Causal Modeling<a class="headerlink" href="#dynamic-causal-modeling" title="Link to this heading">#</a></h3>
<p>Dynamic Causal Modeling (DCM) provides a framework for inferring causal interactions between brain regions based on their observed activity. Unlike functional connectivity, which only captures statistical dependencies, DCM attempts to model the directional influence of one region on another.</p>
<p>DCM combines a neural model (describing how neural populations interact) with a hemodynamic model (describing how neural activity translates to measured signals like BOLD responses). This allows researchers to test hypotheses about the directionality and strength of connections.</p>
<p>For example, DCM can help determine whether activity in the salience network causally influences the switching between default mode and executive networks, or whether these dynamics emerge from other processes.</p>
<p>The approach involves:</p>
<ol class="arabic simple">
<li><p>Defining a set of candidate models with different connection architectures</p></li>
<li><p>Estimating parameters for each model based on observed data</p></li>
<li><p>Comparing models to determine which best explains the observed dynamics</p></li>
</ol>
</section>
<section id="neural-mass-models">
<h3>Neural Mass Models<a class="headerlink" href="#neural-mass-models" title="Link to this heading">#</a></h3>
<p>Neural mass models aim to capture the collective behavior of large neural populations, bridging the gap between single-neuron dynamics and whole-brain networks.</p>
<p>These models typically represent each brain region as a dynamical system characterized by a few state variables (such as mean membrane potential and firing rate). Regions are coupled through excitatory and inhibitory connections to form networks.</p>
<p>A simple neural mass model for coupled brain regions might be described by equations like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">neural_mass_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A simplified neural mass model for two coupled brain regions </span>
<span class="sd">    (DMN and Executive Network)</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        t: Time point</span>
<span class="sd">        state: Current state variables [E1, I1, E2, I2]</span>
<span class="sd">               E1, I1: Excitatory and inhibitory populations in region 1 (DMN)</span>
<span class="sd">               E2, I2: Excitatory and inhibitory populations in region 2 (Executive)</span>
<span class="sd">        params: Dictionary of parameters</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        derivatives: Rate of change for each state variable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">E1</span><span class="p">,</span> <span class="n">I1</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">I2</span> <span class="o">=</span> <span class="n">state</span>
    
    <span class="c1"># Extract parameters</span>
    <span class="n">tau_e</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;tau_e&#39;</span><span class="p">]</span>  <span class="c1"># Time constant for excitatory populations</span>
    <span class="n">tau_i</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;tau_i&#39;</span><span class="p">]</span>  <span class="c1"># Time constant for inhibitory populations</span>
    <span class="n">w_ee</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;w_ee&#39;</span><span class="p">]</span>    <span class="c1"># Excitatory to excitatory weight (within-region)</span>
    <span class="n">w_ei</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;w_ei&#39;</span><span class="p">]</span>    <span class="c1"># Excitatory to inhibitory weight (within-region)</span>
    <span class="n">w_ie</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;w_ie&#39;</span><span class="p">]</span>    <span class="c1"># Inhibitory to excitatory weight (within-region)</span>
    <span class="n">w_ii</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;w_ii&#39;</span><span class="p">]</span>    <span class="c1"># Inhibitory to inhibitory weight (within-region)</span>
    <span class="n">w_12</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;w_12&#39;</span><span class="p">]</span>    <span class="c1"># Connection weight from region 1 to 2 (negative for anti-correlation)</span>
    <span class="n">w_21</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;w_21&#39;</span><span class="p">]</span>    <span class="c1"># Connection weight from region 2 to 1 (negative for anti-correlation)</span>
    <span class="n">I_ext1</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;I_ext1&#39;</span><span class="p">]</span>  <span class="c1"># External input to region 1</span>
    <span class="n">I_ext2</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;I_ext2&#39;</span><span class="p">]</span>  <span class="c1"># External input to region 2</span>
    
    <span class="c1"># Sigmoid activation function</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
    
    <span class="c1"># Compute derivatives</span>
    <span class="n">dE1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tau_e</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">E1</span> <span class="o">+</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">w_ee</span><span class="o">*</span><span class="n">E1</span> <span class="o">-</span> <span class="n">w_ie</span><span class="o">*</span><span class="n">I1</span> <span class="o">+</span> <span class="n">w_21</span><span class="o">*</span><span class="n">E2</span> <span class="o">+</span> <span class="n">I_ext1</span><span class="p">))</span>
    <span class="n">dI1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tau_i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">I1</span> <span class="o">+</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">w_ei</span><span class="o">*</span><span class="n">E1</span> <span class="o">-</span> <span class="n">w_ii</span><span class="o">*</span><span class="n">I1</span><span class="p">))</span>
    <span class="n">dE2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tau_e</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">E2</span> <span class="o">+</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">w_ee</span><span class="o">*</span><span class="n">E2</span> <span class="o">-</span> <span class="n">w_ie</span><span class="o">*</span><span class="n">I2</span> <span class="o">+</span> <span class="n">w_12</span><span class="o">*</span><span class="n">E1</span> <span class="o">+</span> <span class="n">I_ext2</span><span class="p">))</span>
    <span class="n">dI2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">tau_i</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">I2</span> <span class="o">+</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">w_ei</span><span class="o">*</span><span class="n">E2</span> <span class="o">-</span> <span class="n">w_ii</span><span class="o">*</span><span class="n">I2</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="p">[</span><span class="n">dE1</span><span class="p">,</span> <span class="n">dI1</span><span class="p">,</span> <span class="n">dE2</span><span class="p">,</span> <span class="n">dI2</span><span class="p">]</span>
</pre></div>
</div>
<p>These models can reproduce key features of brain dynamics, including:</p>
<ul class="simple">
<li><p>Oscillatory behavior at different frequencies</p></li>
<li><p>Phase synchronization between regions</p></li>
<li><p>State transitions in response to parameter changes</p></li>
<li><p>Complex spatiotemporal patterns of activity</p></li>
</ul>
<p>By adjusting connection strengths and other parameters, researchers can explore how network architecture influences dynamics and test hypotheses about mechanisms underlying observed phenomena.</p>
</section>
<section id="links-to-reservoir-computing">
<h3>Links to Reservoir Computing<a class="headerlink" href="#links-to-reservoir-computing" title="Link to this heading">#</a></h3>
<p>The brain’s recurrent network architecture has inspired artificial neural network approaches like reservoir computing. Reservoir computing systems consist of:</p>
<ol class="arabic simple">
<li><p>A large, randomly connected recurrent neural network (the “reservoir”)</p></li>
<li><p>Input connections that feed signals into the reservoir</p></li>
<li><p>Output connections that read out from the reservoir’s activity</p></li>
</ol>
<p>The key insight is that complex, dynamic reservoirs can transform inputs into high-dimensional representations that make classification or prediction tasks easier to solve. The reservoir itself remains fixed (untrained), while only the output connections are adjusted through learning.</p>
<p>This approach bears interesting parallels to brain network dynamics:</p>
<ul class="simple">
<li><p>The intrinsic activity of brain networks provides a complex, high-dimensional state space</p></li>
<li><p>Different cognitive tasks may utilize different readouts from this ongoing activity</p></li>
<li><p>The anti-correlation between default mode and executive networks might represent different operating regimes within this dynamical system</p></li>
</ul>
<p>Echo State Networks and Liquid State Machines are two common implementations of reservoir computing that have been used to model aspects of brain function, including working memory, sequence learning, and temporal integration.</p>
</section>
</section>
<section id="code-lab">
<h2>5.6 Code Lab<a class="headerlink" href="#code-lab" title="Link to this heading">#</a></h2>
<section id="network-analysis-of-brain-connectivity-data">
<h3>Network Analysis of Brain Connectivity Data<a class="headerlink" href="#network-analysis-of-brain-connectivity-data" title="Link to this heading">#</a></h3>
<p>Let’s explore how to analyze brain connectivity data using Python. We’ll simulate a dataset representing functional connectivity between brain regions and apply network analysis techniques:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>

<span class="c1"># Create simulated connectivity matrix for 10 brain regions</span>
<span class="c1"># (5 DMN regions, 5 Executive regions)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">generate_connectivity_matrix</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a simulated functional connectivity matrix between brain regions</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        conn_matrix: Connectivity matrix (correlation values)</span>
<span class="sd">        region_names: List of region names</span>
<span class="sd">        network_labels: Network assignment for each region</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    
    <span class="c1"># Define regions</span>
    <span class="n">dmn_regions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mPFC&#39;</span><span class="p">,</span> <span class="s1">&#39;PCC&#39;</span><span class="p">,</span> <span class="s1">&#39;Precuneus&#39;</span><span class="p">,</span> <span class="s1">&#39;AngularL&#39;</span><span class="p">,</span> <span class="s1">&#39;AngularR&#39;</span><span class="p">]</span>
    <span class="n">exec_regions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dlPFC_L&#39;</span><span class="p">,</span> <span class="s1">&#39;dlPFC_R&#39;</span><span class="p">,</span> <span class="s1">&#39;IPS_L&#39;</span><span class="p">,</span> <span class="s1">&#39;IPS_R&#39;</span><span class="p">,</span> <span class="s1">&#39;ACC&#39;</span><span class="p">]</span>
    <span class="n">region_names</span> <span class="o">=</span> <span class="n">dmn_regions</span> <span class="o">+</span> <span class="n">exec_regions</span>
    <span class="n">network_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DMN&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Executive&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">5</span>
    
    <span class="n">n_regions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">region_names</span><span class="p">)</span>
    
    <span class="c1"># Start with random correlation matrix</span>
    <span class="n">random_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_regions</span><span class="p">,</span> <span class="n">n_regions</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.3</span>
    <span class="n">conn_matrix</span> <span class="o">=</span> <span class="n">random_matrix</span> <span class="o">+</span> <span class="n">random_matrix</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># Make it symmetric</span>
    <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">conn_matrix</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>  <span class="c1"># Diagonal is 1 (self-correlation)</span>
    
    <span class="c1"># Set high within-network connectivity</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                <span class="c1"># High DMN internal connectivity</span>
                <span class="n">conn_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.3</span>
                
                <span class="c1"># High Executive internal connectivity</span>
                <span class="n">conn_matrix</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.3</span>
    
    <span class="c1"># Set negative between-network connectivity (anti-correlation)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">conn_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.4</span>
            <span class="n">conn_matrix</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">conn_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span>  <span class="c1"># Ensure symmetry</span>
    
    <span class="c1"># Ensure values are in [-1, 1] range</span>
    <span class="n">conn_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">conn_matrix</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">conn_matrix</span><span class="p">,</span> <span class="n">region_names</span><span class="p">,</span> <span class="n">network_labels</span>

<span class="c1"># Plot connectivity matrix as a heatmap</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_connectivity_heatmap</span><span class="p">(</span><span class="n">conn_matrix</span><span class="p">,</span> <span class="n">region_names</span><span class="p">,</span> <span class="n">network_labels</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualize connectivity matrix as a heatmap with network boundaries</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    
    <span class="c1"># Create a mask for the upper triangle (redundant in symmetric matrix)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">conn_matrix</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">))</span>
    
    <span class="c1"># Set up custom colormap with white center</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">diverging_palette</span><span class="p">(</span><span class="mi">230</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Plot heatmap</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">conn_matrix</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> 
                <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> 
                <span class="n">xticklabels</span><span class="o">=</span><span class="n">region_names</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="n">region_names</span><span class="p">,</span>
                <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">.5</span><span class="p">})</span>
    
    <span class="c1"># Add network boundary lines</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># Add network labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;DMN&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Executive&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s1">&#39;DMN&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="s1">&#39;Executive&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Functional Connectivity Matrix&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Calculate and visualize network metrics</span>
<span class="k">def</span><span class="w"> </span><span class="nf">analyze_brain_network</span><span class="p">(</span><span class="n">conn_matrix</span><span class="p">,</span> <span class="n">region_names</span><span class="p">,</span> <span class="n">network_labels</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert connectivity matrix to a graph and analyze network properties</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        conn_matrix: Connectivity matrix</span>
<span class="sd">        region_names: Names of brain regions</span>
<span class="sd">        network_labels: Network assignment for each region</span>
<span class="sd">        threshold: Threshold for including connections</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create weighted graph from absolute connectivity values</span>
    <span class="c1"># (direction of correlation doesn&#39;t affect network measures)</span>
    <span class="n">adj_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">conn_matrix</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">conn_matrix</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">)</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">adj_matrix</span><span class="p">)</span>
    
    <span class="c1"># Add node attributes</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">network</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">region_names</span><span class="p">,</span> <span class="n">network_labels</span><span class="p">)):</span>
        <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;network&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">network</span>
    
    <span class="c1"># Calculate network metrics</span>
    <span class="n">degree</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
    <span class="n">clustering</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">clustering</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>
    <span class="n">betweenness</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">betweenness_centrality</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Compile results</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="n">region_names</span><span class="p">,</span>
        <span class="s1">&#39;Network&#39;</span><span class="p">:</span> <span class="n">network_labels</span><span class="p">,</span>
        <span class="s1">&#39;Degree&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">degree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">region_names</span><span class="p">))],</span>
        <span class="s1">&#39;Clustering&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">clustering</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">region_names</span><span class="p">))],</span>
        <span class="s1">&#39;Betweenness&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">betweenness</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">region_names</span><span class="p">))]</span>
    <span class="p">})</span>
    
    <span class="c1"># Calculate community structure</span>
    <span class="n">communities</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">community</span><span class="o">.</span><span class="n">greedy_modularity_communities</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Detected communities:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">comm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">communities</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Community </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="p">[</span><span class="n">region_names</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">comm</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="c1"># Visualize the network</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    
    <span class="c1"># Define positions (circular layout with DMN and Executive separated)</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">dmn_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">network_labels</span><span class="p">)</span> <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;DMN&#39;</span><span class="p">]</span>
    <span class="n">exec_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">network_labels</span><span class="p">)</span> <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;Executive&#39;</span><span class="p">]</span>
    
    <span class="c1"># DMN nodes on the left</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dmn_indices</span><span class="p">),</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dmn_indices</span><span class="p">):</span>
        <span class="n">pos</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">radius</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">6</span><span class="p">,</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angles</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
    
    <span class="c1"># Executive nodes on the right</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">exec_indices</span><span class="p">),</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">exec_indices</span><span class="p">):</span>
        <span class="n">pos</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">radius</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angles</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angles</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
    
    <span class="c1"># Node colors by network</span>
    <span class="n">node_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;skyblue&#39;</span> <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;DMN&#39;</span> <span class="k">else</span> <span class="s1">&#39;salmon&#39;</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">network_labels</span><span class="p">]</span>
    
    <span class="c1"># Node sizes by betweenness centrality</span>
    <span class="n">node_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">betweenness</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3000</span> <span class="o">+</span> <span class="mi">500</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">region_names</span><span class="p">))]</span>
    
    <span class="c1"># Edge weights for width</span>
    <span class="n">edge_weights</span> <span class="o">=</span> <span class="p">[</span><span class="n">G</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">()]</span>
    
    <span class="c1"># Draw the graph</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> 
                    <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span> 
                    <span class="n">node_size</span><span class="o">=</span><span class="n">node_sizes</span><span class="p">,</span>
                    <span class="n">width</span><span class="o">=</span><span class="n">edge_weights</span><span class="p">,</span>
                    <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()},</span>
                    <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                    <span class="n">font_weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Brain Network Graph&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1"># Plot metrics by network</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    
    <span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Degree&#39;</span><span class="p">,</span> <span class="s1">&#39;Clustering&#39;</span><span class="p">,</span> <span class="s1">&#39;Betweenness&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">metric</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">metrics</span><span class="p">):</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Network&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">metric</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1"> by Network&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">df</span><span class="p">,</span> <span class="n">G</span>

<span class="c1"># Example usage:</span>
<span class="c1"># conn_matrix, region_names, network_labels = generate_connectivity_matrix()</span>
<span class="c1"># plot_connectivity_heatmap(conn_matrix, region_names, network_labels)</span>
<span class="c1"># metrics_df, G = analyze_brain_network(conn_matrix, region_names, network_labels)</span>
</pre></div>
</div>
</section>
<section id="simulating-coupled-oscillator-networks">
<h3>Simulating Coupled Oscillator Networks<a class="headerlink" href="#simulating-coupled-oscillator-networks" title="Link to this heading">#</a></h3>
<p>Brain networks can be modeled as systems of coupled oscillators, where each oscillator represents a brain region with its own intrinsic frequency. The following code simulates this type of system to explore how coupling affects network dynamics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">animation</span>

<span class="c1"># Kuramoto model of coupled oscillators</span>
<span class="k">def</span><span class="w"> </span><span class="nf">kuramoto_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">phases</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kuramoto model of coupled oscillators</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        t: Time point</span>
<span class="sd">        phases: Current phase of each oscillator (in radians)</span>
<span class="sd">        omega: Natural frequencies of oscillators</span>
<span class="sd">        K: Coupling strength</span>
<span class="sd">        A: Adjacency matrix defining connections</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        dphases: Rate of change of phases</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">phases</span><span class="p">)</span>
    <span class="n">dphases</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">dphases</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Natural frequency</span>
        
        <span class="c1"># Add coupling terms</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">dphases</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">K</span> <span class="o">*</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phases</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">phases</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            
    <span class="k">return</span> <span class="n">dphases</span>

<span class="c1"># Simulating network dynamics with Kuramoto model</span>
<span class="k">def</span><span class="w"> </span><span class="nf">simulate_brain_oscillators</span><span class="p">(</span><span class="n">conn_matrix</span><span class="p">,</span> <span class="n">region_names</span><span class="p">,</span> <span class="n">network_labels</span><span class="p">,</span> 
                               <span class="n">duration</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="mf">0.8</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate brain regions as coupled oscillators using the Kuramoto model</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        conn_matrix: Connectivity matrix</span>
<span class="sd">        region_names: Names of brain regions</span>
<span class="sd">        network_labels: Network assignment for each region</span>
<span class="sd">        duration: Simulation duration (seconds)</span>
<span class="sd">        dt: Time step</span>
<span class="sd">        K: Coupling strength</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        t: Time points</span>
<span class="sd">        phases: Phases of oscillators over time</span>
<span class="sd">        order_param: Order parameter (synchronization measure) over time</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_regions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">region_names</span><span class="p">)</span>
    
    <span class="c1"># Set natural frequencies - different frequency bands for DMN and Executive</span>
    <span class="c1"># DMN regions: slower oscillations (alpha/theta range)</span>
    <span class="c1"># Executive regions: faster oscillations (beta range)</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_regions</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_regions</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">network_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DMN&#39;</span><span class="p">:</span>
            <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="mi">4</span>  <span class="c1"># 8-12 Hz (alpha)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="mi">10</span>  <span class="c1"># 15-25 Hz (beta)</span>
    
    <span class="c1"># Normalize by 2π for phase calculations</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="n">omega</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    
    <span class="c1"># Use absolute connectivity values for coupling (negative correlations still couple)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">conn_matrix</span><span class="p">)</span>
    
    <span class="c1"># Initial phases (random)</span>
    <span class="n">phases_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_regions</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    
    <span class="c1"># Time points</span>
    <span class="n">t_span</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
    <span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
    
    <span class="c1"># Solve the differential equations</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">kuramoto_model</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">A</span><span class="p">),</span>
        <span class="n">t_span</span><span class="p">,</span>
        <span class="n">phases_0</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s1">&#39;RK45&#39;</span><span class="p">,</span>
        <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span>
    <span class="p">)</span>
    
    <span class="c1"># Calculate order parameter (measure of synchronization)</span>
    <span class="c1"># r = 1 means perfect synchronization, r = 0 means no synchronization</span>
    <span class="n">phases</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span>
    <span class="n">order_param</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_eval</span><span class="p">))</span>
    <span class="n">dmn_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_eval</span><span class="p">))</span>
    <span class="n">exec_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_eval</span><span class="p">))</span>
    
    <span class="n">dmn_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">network_labels</span><span class="p">)</span> <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;DMN&#39;</span><span class="p">]</span>
    <span class="n">exec_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">network_labels</span><span class="p">)</span> <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;Executive&#39;</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_eval</span><span class="p">)):</span>
        <span class="c1"># Global synchronization</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phases</span><span class="p">[:,</span> <span class="n">t</span><span class="p">]))</span> <span class="o">/</span> <span class="n">n_regions</span><span class="p">)</span>
        <span class="n">order_param</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span>
        
        <span class="c1"># DMN synchronization</span>
        <span class="n">r_dmn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phases</span><span class="p">[</span><span class="n">dmn_indices</span><span class="p">,</span> <span class="n">t</span><span class="p">]))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">dmn_indices</span><span class="p">))</span>
        <span class="n">dmn_order</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_dmn</span>
        
        <span class="c1"># Executive synchronization</span>
        <span class="n">r_exec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phases</span><span class="p">[</span><span class="n">exec_indices</span><span class="p">,</span> <span class="n">t</span><span class="p">]))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">exec_indices</span><span class="p">))</span>
        <span class="n">exec_order</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_exec</span>
    
    <span class="c1"># Plot results</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    
    <span class="c1"># Plot individual phases</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_regions</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">network_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;DMN&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">phases</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;_nolegend_&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">phases</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;_nolegend_&#39;</span><span class="p">)</span>
    
    <span class="c1"># Add legend entries (only once)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;DMN&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([],</span> <span class="p">[],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Executive&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Phase / 2π&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Oscillator Phases&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="c1"># Plot order parameters</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">order_param</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Global&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">dmn_order</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;DMN&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">exec_order</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Executive&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Order Parameter&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Synchronization&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">phases</span><span class="p">,</span> <span class="n">order_param</span><span class="p">,</span> <span class="n">dmn_order</span><span class="p">,</span> <span class="n">exec_order</span>

<span class="c1"># Example usage:</span>
<span class="c1"># conn_matrix, region_names, network_labels = generate_connectivity_matrix()</span>
<span class="c1"># t, phases, order_param, dmn_order, exec_order = simulate_brain_oscillators(conn_matrix, region_names, network_labels)</span>
</pre></div>
</div>
</section>
<section id="visualizing-network-dynamics">
<h3>Visualizing Network Dynamics<a class="headerlink" href="#visualizing-network-dynamics" title="Link to this heading">#</a></h3>
<p>Let’s simulate how external tasks or stimulation might affect the balance between DMN and executive networks:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>

<span class="c1"># Simulate a simple brain network model with DMN and Executive Network dynamics</span>
<span class="k">def</span><span class="w"> </span><span class="nf">simulate_brain_networks</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">noise_level</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">task_timing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate time series data from DMN and Executive Network with anti-correlation</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    duration: simulation length in seconds</span>
<span class="sd">    sampling_rate: Hz</span>
<span class="sd">    noise_level: amount of random fluctuation</span>
<span class="sd">    task_timing: list of tuples (start_time, end_time) for task periods</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">    time: time points</span>
<span class="sd">    dmn_activity: simulated DMN time series</span>
<span class="sd">    exec_activity: simulated executive network time series</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create time axis</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="n">sampling_rate</span><span class="p">)</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
    
    <span class="c1"># Base oscillations (slow intrinsic fluctuations ~0.1 Hz)</span>
    <span class="n">freq_dmn</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># DMN fluctuation frequency</span>
    <span class="n">freq_exec</span> <span class="o">=</span> <span class="mf">0.03</span>  <span class="c1"># Exec network fluctuation frequency</span>
    
    <span class="c1"># Generate intrinsic oscillations</span>
    <span class="n">dmn_activity</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq_dmn</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>
    <span class="n">exec_activity</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq_exec</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>
    
    <span class="c1"># Add random noise</span>
    <span class="n">dmn_activity</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">noise_level</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="n">exec_activity</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">noise_level</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
    
    <span class="c1"># Add anti-correlation factor (when one goes up, the other tends to go down)</span>
    <span class="n">anticorr_factor</span> <span class="o">=</span> <span class="mf">0.4</span>
    <span class="n">dmn_activity</span> <span class="o">-=</span> <span class="n">anticorr_factor</span> <span class="o">*</span> <span class="n">exec_activity</span>
    <span class="n">exec_activity</span> <span class="o">-=</span> <span class="n">anticorr_factor</span> <span class="o">*</span> <span class="n">dmn_activity</span>
    
    <span class="c1"># Simulate task engagement (executive network up, DMN down)</span>
    <span class="k">if</span> <span class="n">task_timing</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">task_timing</span><span class="p">:</span>
            <span class="n">start_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span> <span class="o">*</span> <span class="n">sampling_rate</span><span class="p">)</span>
            <span class="n">end_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">end</span> <span class="o">*</span> <span class="n">sampling_rate</span><span class="p">)</span>
            
            <span class="c1"># During task: boost executive network and suppress DMN</span>
            <span class="n">task_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
            <span class="n">task_mask</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            
            <span class="n">exec_activity</span> <span class="o">+=</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">task_mask</span>
            <span class="n">dmn_activity</span> <span class="o">-=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">task_mask</span>
    
    <span class="c1"># Normalize</span>
    <span class="n">dmn_activity</span> <span class="o">=</span> <span class="p">(</span><span class="n">dmn_activity</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dmn_activity</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dmn_activity</span><span class="p">)</span>
    <span class="n">exec_activity</span> <span class="o">=</span> <span class="p">(</span><span class="n">exec_activity</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">exec_activity</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">exec_activity</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">time</span><span class="p">,</span> <span class="n">dmn_activity</span><span class="p">,</span> <span class="n">exec_activity</span>

<span class="c1"># Visualize network dynamics</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_network_timeseries</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">dmn_activity</span><span class="p">,</span> <span class="n">exec_activity</span><span class="p">,</span> <span class="n">task_timing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">dmn_activity</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Default Mode Network&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">exec_activity</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Executive Control Network&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="c1"># Highlight task periods</span>
    <span class="k">if</span> <span class="n">task_timing</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">task_timing</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">start</span> <span class="o">+</span> <span class="n">end</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="s1">&#39;Task&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (seconds)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Network Activity (z-score)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Simulated DMN vs Executive Network Dynamics&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    
    <span class="c1"># Add correlation coefficient</span>
    <span class="n">corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">dmn_activity</span><span class="p">,</span> <span class="n">exec_activity</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Correlation: </span><span class="si">{</span><span class="n">corr</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1"># Plot a sliding window correlation analysis</span>
    <span class="n">window_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">//</span> <span class="mi">10</span>
    <span class="n">step_size</span> <span class="o">=</span> <span class="n">window_size</span> <span class="o">//</span> <span class="mi">2</span>
    
    <span class="n">sliding_corr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">window_centers</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">):</span>
        <span class="n">window_dmn</span> <span class="o">=</span> <span class="n">dmn_activity</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">window_size</span><span class="p">]</span>
        <span class="n">window_exec</span> <span class="o">=</span> <span class="n">exec_activity</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">window_size</span><span class="p">]</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">window_dmn</span><span class="p">,</span> <span class="n">window_exec</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">sliding_corr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
        <span class="n">window_centers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_size</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">window_centers</span><span class="p">,</span> <span class="n">sliding_corr</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (seconds)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;DMN-Executive Correlation&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sliding Window Correlation Analysis&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    
    <span class="c1"># Highlight task periods</span>
    <span class="k">if</span> <span class="n">task_timing</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="ow">in</span> <span class="n">task_timing</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Simulate tDCS effects on network balance</span>
<span class="k">def</span><span class="w"> </span><span class="nf">simulate_tdcs_effect</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">stim_period</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">target_network</span><span class="o">=</span><span class="s1">&#39;DMN&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate how tDCS might affect the balance between DMN and Executive Network</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    duration: total simulation time in seconds</span>
<span class="sd">    stim_period: tuple of (start, end) time for stimulation in seconds</span>
<span class="sd">    target_network: which network to stimulate (&#39;DMN&#39; or &#39;Executive&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Standard simulation without stimulation</span>
    <span class="n">time</span><span class="p">,</span> <span class="n">dmn</span><span class="p">,</span> <span class="n">exec_net</span> <span class="o">=</span> <span class="n">simulate_brain_networks</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span>
    
    <span class="c1"># Create a stimulation time series (effect of tDCS)</span>
    <span class="n">stim_effect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">stim_start_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">stim_period</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">stim_end_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">time</span> <span class="o">&gt;=</span> <span class="n">stim_period</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># Ramp up effect</span>
    <span class="n">ramp_duration</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># seconds for effect to reach maximum</span>
    <span class="n">ramp_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ramp_duration</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">/</span> <span class="n">duration</span><span class="p">))</span>
    
    <span class="c1"># Ramp up</span>
    <span class="n">ramp_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">stim_start_idx</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">stim_start_idx</span> <span class="o">+</span> <span class="n">ramp_samples</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>
    <span class="n">stim_effect</span><span class="p">[</span><span class="n">ramp_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ramp_indices</span><span class="p">))</span>
    
    <span class="c1"># Plateau</span>
    <span class="n">plateau_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">stim_start_idx</span> <span class="o">+</span> <span class="n">ramp_samples</span><span class="p">,</span> <span class="n">stim_end_idx</span><span class="p">)</span>
    <span class="n">stim_effect</span><span class="p">[</span><span class="n">plateau_indices</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    
    <span class="c1"># Ramp down</span>
    <span class="n">ramp_down_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">stim_end_idx</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">stim_end_idx</span> <span class="o">+</span> <span class="n">ramp_samples</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>
    <span class="n">stim_effect</span><span class="p">[</span><span class="n">ramp_down_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ramp_down_indices</span><span class="p">))</span>
    
    <span class="c1"># Apply effect to target network</span>
    <span class="n">dmn_stim</span> <span class="o">=</span> <span class="n">dmn</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">exec_stim</span> <span class="o">=</span> <span class="n">exec_net</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="n">stim_magnitude</span> <span class="o">=</span> <span class="mf">0.8</span>
    
    <span class="k">if</span> <span class="n">target_network</span> <span class="o">==</span> <span class="s1">&#39;DMN&#39;</span><span class="p">:</span>
        <span class="c1"># Stimulating DMN increases DMN and decreases Executive</span>
        <span class="n">dmn_stim</span> <span class="o">+=</span> <span class="n">stim_effect</span> <span class="o">*</span> <span class="n">stim_magnitude</span>
        <span class="n">exec_stim</span> <span class="o">-=</span> <span class="n">stim_effect</span> <span class="o">*</span> <span class="p">(</span><span class="n">stim_magnitude</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">)</span>  <span class="c1"># Secondary effect on other network</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Stimulating Executive increases Executive and decreases DMN</span>
        <span class="n">exec_stim</span> <span class="o">+=</span> <span class="n">stim_effect</span> <span class="o">*</span> <span class="n">stim_magnitude</span>
        <span class="n">dmn_stim</span> <span class="o">-=</span> <span class="n">stim_effect</span> <span class="o">*</span> <span class="p">(</span><span class="n">stim_magnitude</span> <span class="o">*</span> <span class="mf">0.6</span><span class="p">)</span>  <span class="c1"># Secondary effect on other network</span>
    
    <span class="c1"># Re-normalize</span>
    <span class="n">dmn_stim</span> <span class="o">=</span> <span class="p">(</span><span class="n">dmn_stim</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dmn_stim</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dmn_stim</span><span class="p">)</span>
    <span class="n">exec_stim</span> <span class="o">=</span> <span class="p">(</span><span class="n">exec_stim</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">exec_stim</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">exec_stim</span><span class="p">)</span>
    
    <span class="c1"># Plot results</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">dmn</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;DMN (baseline)&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">exec_net</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Executive (baseline)&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">stim_period</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stim_period</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">stim_period</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">stim_period</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;tDCS: </span><span class="si">{</span><span class="n">target_network</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> 
             <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Baseline Network Dynamics&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">dmn_stim</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;DMN (with tDCS)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">exec_stim</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Executive (with tDCS)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">stim_period</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stim_period</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Effect of tDCS on </span><span class="si">{</span><span class="n">target_network</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (seconds)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1"># Calculate correlation changes due to stimulation</span>
    <span class="n">baseline_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">dmn</span><span class="p">,</span> <span class="n">exec_net</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">stim_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">dmn_stim</span><span class="p">,</span> <span class="n">exec_stim</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Baseline DMN-Executive correlation: </span><span class="si">{</span><span class="n">baseline_corr</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;With tDCS to </span><span class="si">{</span><span class="n">target_network</span><span class="si">}</span><span class="s2">, correlation: </span><span class="si">{</span><span class="n">stim_corr</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Change in anti-correlation: </span><span class="si">{</span><span class="n">stim_corr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">baseline_corr</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Example calls:</span>
<span class="c1"># time_series, dmn, exec_net = simulate_brain_networks(task_timing=[(100, 150), (300, 350)])</span>
<span class="c1"># plot_network_timeseries(time_series, dmn, exec_net, task_timing=[(100, 150), (300, 350)])</span>
<span class="c1"># simulate_tdcs_effect(target_network=&#39;Executive&#39;)</span>
</pre></div>
</div>
</section>
</section>
<section id="take-aways">
<h2>5.7 Take-aways<a class="headerlink" href="#take-aways" title="Link to this heading">#</a></h2>
<section id="brain-function-emerges-from-network-interactions">
<h3>Brain Function Emerges from Network Interactions<a class="headerlink" href="#brain-function-emerges-from-network-interactions" title="Link to this heading">#</a></h3>
<p>The brain’s complex functions emerge not from isolated regions but from the dynamic interactions between distributed networks. The default mode and executive control networks represent complementary systems that support different modes of cognition, with the former specialized for internal, self-referential processing and the latter for external, goal-directed behavior.</p>
<p>The anti-correlated relationship between these networks highlights the brain’s ability to shift resources based on current demands. This dynamic reconfiguration allows for rapid transitions between different cognitive states—from focused attention to mind-wandering, from perception to introspection.</p>
<p>Network neuroscience provides a framework for understanding how these interactions give rise to cognitive functions, moving beyond traditional region-based approaches toward a more integrative understanding of brain dynamics.</p>
</section>
<section id="balance-between-networks-supports-adaptive-cognition">
<h3>Balance Between Networks Supports Adaptive Cognition<a class="headerlink" href="#balance-between-networks-supports-adaptive-cognition" title="Link to this heading">#</a></h3>
<p>The appropriate balance between networks is critical for adaptive cognition. Excessive dominance of either network may lead to maladaptive function:</p>
<ul class="simple">
<li><p>Overactivation of executive networks without adequate DMN activity might impair creativity, self-reflection, and long-term planning</p></li>
<li><p>Overactivation of the DMN without sufficient executive control might lead to rumination, difficulty with focused attention, and reduced task performance</p></li>
</ul>
<p>This balance shifts appropriately in healthy individuals, allowing for focused attention when needed and constructive mind-wandering when appropriate. Disruption of this balance contributes to various disorders, including ADHD, depression, and schizophrenia.</p>
<p>The dynamic coupling between networks also supports transitions between exploration (broadly sampling possibilities) and exploitation (focusing on optimal solutions), a tension relevant to both biological and artificial intelligence.</p>
</section>
<section id="network-properties-constrain-and-enable-computation">
<h3>Network Properties Constrain and Enable Computation<a class="headerlink" href="#network-properties-constrain-and-enable-computation" title="Link to this heading">#</a></h3>
<p>The structural and functional organization of brain networks both constrains and enables cognitive computation. Properties such as small-world architecture, modularity, and rich-club organization support efficient information processing by balancing integration and segregation.</p>
<p>These principles may inform artificial intelligence design:</p>
<ol class="arabic simple">
<li><p><strong>Modular, semi-specialized networks</strong> may outperform monolithic architectures for certain tasks, mirroring the brain’s specialized yet integrated networks</p></li>
<li><p><strong>Dynamic resource allocation</strong> between different processing modes might enhance adaptive learning and problem-solving</p></li>
<li><p><strong>Graph-theoretic properties</strong> like small-world organization could inspire more efficient neural network architectures</p></li>
<li><p><strong>Anti-correlated systems</strong> may provide useful tension between complementary processing modes</p></li>
</ol>
<p>The brain’s network architecture represents an evolutionary solution to complex information processing under biological constraints. Understanding these organizing principles may inspire new approaches to artificial intelligence that incorporate lessons from network neuroscience.</p>
</section>
</section>
<section id="further-reading-media">
<h2>5.8 Further Reading &amp; Media<a class="headerlink" href="#further-reading-media" title="Link to this heading">#</a></h2>
<section id="key-papers">
<h3>Key Papers<a class="headerlink" href="#key-papers" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Raichle, M. E., MacLeod, A. M., Snyder, A. Z., Powers, W. J., Gusnard, D. A., &amp; Shulman, G. L. (2001). A default mode of brain function. <em>Proceedings of the National Academy of Sciences</em>, 98(2), 676-682.</p>
<ul>
<li><p>The foundational paper that first identified the default mode network and its unique properties</p></li>
</ul>
</li>
<li><p>Fox, M. D., Snyder, A. Z., Vincent, J. L., Corbetta, M., Van Essen, D. C., &amp; Raichle, M. E. (2005). The human brain is intrinsically organized into dynamic, anticorrelated functional networks. <em>Proceedings of the National Academy of Sciences</em>, 102(27), 9673-9678.</p>
<ul>
<li><p>Classic paper demonstrating the anti-correlation between default mode and task-positive networks</p></li>
</ul>
</li>
<li><p>Cole, M. W., Reynolds, J. R., Power, J. D., Repovs, G., Anticevic, A., &amp; Braver, T. S. (2013). Multi-task connectivity reveals flexible hubs for adaptive task control. <em>Nature Neuroscience</em>, 16(9), 1348-1355.</p>
<ul>
<li><p>Explores how executive control networks flexibly reconfigure based on task demands</p></li>
</ul>
</li>
<li><p>Bassett, D. S., &amp; Sporns, O. (2017). Network neuroscience. <em>Nature Neuroscience</em>, 20(3), 353-364.</p>
<ul>
<li><p>Comprehensive review of network approaches to understanding brain organization</p></li>
</ul>
</li>
<li><p>Buckner, R. L., Andrews-Hanna, J. R., &amp; Schacter, D. L. (2008). The brain’s default network: Anatomy, function, and relevance to disease. <em>Annals of the New York Academy of Sciences</em>, 1124(1), 1-38.</p>
<ul>
<li><p>Detailed exploration of DMN functions and their relevance to clinical conditions</p></li>
</ul>
</li>
</ul>
</section>
<section id="books">
<h3>Books<a class="headerlink" href="#books" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Sporns, O. (2010). <em>Networks of the Brain</em>. MIT Press.</p>
<ul>
<li><p>Comprehensive introduction to network neuroscience principles and applications</p></li>
</ul>
</li>
<li><p>Northoff, G. (2013). <em>Unlocking the Brain: Volume 2: Consciousness</em>. Oxford University Press.</p>
<ul>
<li><p>Explores connections between brain networks and consciousness, with emphasis on DMN</p></li>
</ul>
</li>
<li><p>Petersen, S. E., &amp; Sporns, O. (2015). <em>Brain Networks and Cognitive Architectures</em>. Oxford University Press.</p>
<ul>
<li><p>Connects brain network organization to cognitive functions</p></li>
</ul>
</li>
</ul>
</section>
<section id="online-resources">
<h3>Online Resources<a class="headerlink" href="#online-resources" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.humanconnectome.org/">Human Connectome Project</a></p>
<ul>
<li><p>Large-scale project mapping brain connectivity with extensive data resources</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://www.coursera.org/learn/network-neuroscience">Brain Networks Course</a></p>
<ul>
<li><p>Online course covering foundations of network neuroscience</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/brain-networks/brainnetworks">Network Neuroscience Tools</a></p>
<ul>
<li><p>GitHub repository with tools for brain network analysis</p></li>
</ul>
</li>
</ul>
</section>
<section id="videos-and-lectures">
<h3>Videos and Lectures<a class="headerlink" href="#videos-and-lectures" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=n1CeFv1wJAA">“Default Mode Network” by Marcus Raichle</a></p>
<ul>
<li><p>Lecture by the scientist who first identified the DMN</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=ApmRl9urTbM">“Functional Brain Networks” by Olaf Sporns</a></p>
<ul>
<li><p>Overview of network approaches to studying brain function</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=n82PFe3bogM">“Resting State fMRI” by Stephen Smith</a></p>
<ul>
<li><p>Explanation of resting-state functional connectivity methods</p></li>
</ul>
</li>
</ul>
</section>
<section id="tutorials-and-code">
<h3>Tutorials and Code<a class="headerlink" href="#tutorials-and-code" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://sites.google.com/site/bctnet/">Brain Connectivity Toolbox</a></p>
<ul>
<li><p>MATLAB toolbox for network analysis of connectivity data</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://nilearn.github.io/stable/index.html">Nilearn</a></p>
<ul>
<li><p>Python library for statistical analysis of neuroimaging data, including network analysis</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://networkx.org/">NetworkX</a></p>
<ul>
<li><p>Python library for complex network analysis applicable to brain networks</p></li>
</ul>
</li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "executablebooks/jupyter-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./part2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../part1/ch04_perception_pipeline.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 4: Perception Pipeline – Visual Cortex → CNNs</p>
      </div>
    </a>
    <a class="right-next"
       href="ch06_neurostimulation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 6: Neurostimulation &amp; Plasticity</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chapter-goals">5.0 Chapter Goals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#network-neuroscience-fundamentals">5.1 Network Neuroscience Fundamentals</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#from-local-circuits-to-distributed-networks">From Local Circuits to Distributed Networks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#methods-for-studying-brain-networks">Methods for Studying Brain Networks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functional-vs-structural-connectivity">Functional vs Structural Connectivity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#network-metrics-and-their-interpretation">Network Metrics and Their Interpretation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-default-mode-network-dmn">5.2 The Default Mode Network (DMN)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discovery-and-components">Discovery and Components</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#self-referential-processing">Self-Referential Processing</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mind-wandering-and-creativity">Mind-Wandering and Creativity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relation-to-memory-and-imagination">Relation to Memory and Imagination</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#executive-control-networks">5.3 Executive Control Networks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frontoparietal-control-network">Frontoparietal Control Network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#salience-network">Salience Network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cognitive-control-functions">Cognitive Control Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#working-memory-and-attention">Working Memory and Attention</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#network-interactions">5.4 Network Interactions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#anti-correlation-and-competitive-dynamics">Anti-Correlation and Competitive Dynamics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-positive-vs-task-negative-networks">Task-Positive vs Task-Negative Networks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamic-network-reconfiguration">Dynamic Network Reconfiguration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#balance-and-dysregulation-in-disorders">Balance and Dysregulation in Disorders</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-approaches">5.5 Computational Approaches</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graph-theoretical-models">Graph Theoretical Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamic-causal-modeling">Dynamic Causal Modeling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-mass-models">Neural Mass Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#links-to-reservoir-computing">Links to Reservoir Computing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-lab">5.6 Code Lab</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#network-analysis-of-brain-connectivity-data">Network Analysis of Brain Connectivity Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-coupled-oscillator-networks">Simulating Coupled Oscillator Networks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-network-dynamics">Visualizing Network Dynamics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#take-aways">5.7 Take-aways</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#brain-function-emerges-from-network-interactions">Brain Function Emerges from Network Interactions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#balance-between-networks-supports-adaptive-cognition">Balance Between Networks Supports Adaptive Cognition</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#network-properties-constrain-and-enable-computation">Network Properties Constrain and Enable Computation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-reading-media">5.8 Further Reading &amp; Media</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-papers">Key Papers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#books">Books</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#online-resources">Online Resources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#videos-and-lectures">Videos and Lectures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tutorials-and-code">Tutorials and Code</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Richard Young
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>